!function(e){function t(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function i(e){e=e.replace(/#/g,"");var t=document.getElementById(e);if(t){var n=document.getElementsByClassName("pane visible");[].forEach.call(n,function(e){e.classList.remove("visible")}),t.classList.add("visible")}}var r=n(1),s=o(r),a=n(2),l=o(a),u=n(3);window.onload=function(){var e=document.getElementById("get-started"),t=document.getElementById("back"),n=document.getElementById("generate"),o=(0,u.createTable)(document.getElementById("table"));e.onclick=function(){window.location.hash="#data-entry"},t.onclick=function(){window.location.hash="#description"},n.onclick=function(e){e.preventDefault();var t=document.getElementById("group-name").value;t=t||"Group Contact";var n=(0,u.getRows)(o).map(function(e){return o.getDataAtRow(e)}).filter(function(e){return e[0]&&e[1]});if(n.length<=0)return void alert("Please add a contact first.");(0,l.default)((0,s.default)(t,n),t+".vcf")},i(window.location.hash)},window.onhashchange=function(){i(window.location.hash)}},function(e,t,n){"use strict";function o(e){return Array.isArray(e)?e:Array.from(e)}function i(e,t){var n=e.split(" "),i=o(n),r=i[0];return"begin:vcard\nversion:3.0\nn:"+i.slice(1).join(" ")+";"+r+";;;\nfn:"+e+"\n"+t.map(function(e,t){return"item"+t+".tel:"+e[1]+"\nitem"+t+".X-ABLabel:"+e[0]+"\n"}).join("")+"end:vcard"}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i},function(e,t,n){"use strict";function o(e,t){var n=document.createElement("a");n.download=t,n.href="data:text/vcard;charset=utf-8;base64,"+btoa(e),document.body.appendChild(n),n.click(),document.body.removeChild(n),delete this.link}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o},function(e,t,n){"use strict";(function(e){function n(t){return new e(t,{data:Array(10).fill().map(function(){return["",""]}),height:260,minSpareRows:1,colHeaders:["Name","Phone Number"],colWidths:[410,410],columns:[{data:"name",type:"text"},{data:"number",type:"text"}]})}function o(e){for(var t=[],n=0;n<e.countRows();n++)t.push(n);return t}Object.defineProperty(t,"__esModule",{value:!0}),t.createTable=n,t.getRows=o}).call(t,n(4))},function(e,t,n){"use strict";(function(e,n){var o,i,r,s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};/*!
 * (The MIT License)
 * 
 * Copyright (c) 2012-2014 Marcin Warpechowski
 * Copyright (c) 2015 Handsoncode sp. z o.o. <hello@handsoncode.net>
 * 
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * 'Software'), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 * 
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
 * IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
 * CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
 * TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
 * SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * 
 * Version: 0.33.0
 * Date: Sat Jul 29 2017 09:30:59 GMT+0200 (CEST)
 */
!function(e,a){"object"===s(t)&&"object"===s(n)?n.exports=a():(i=[],o=a,void 0!==(r="function"==typeof o?o.apply(t,i):o)&&(n.exports=r))}(0,function(){return function(e){function t(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=314)}([function(e,t,n){function o(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=-1,o=null;null!=e;){if(n===t){o=e;break}e.host&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e=e.host:(n++,e=e.parentNode)}return o}function i(e,t,n){for(;null!=e&&e!==n;){if(e.nodeType===Node.ELEMENT_NODE&&(t.indexOf(e.nodeName)>-1||t.indexOf(e)>-1))return e;e=e.host&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e.host:e.parentNode}return null}function r(e,t,n){for(var o=[];e&&(e=i(e,t,n))&&(!n||n.contains(e));)o.push(e),e=e.host&&e.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e.host:e.parentNode;var r=o.length;return r?o[r-1]:null}function s(e,t){var n=e.parentNode,o=[];for("string"==typeof t?o=Array.prototype.slice.call(document.querySelectorAll(t),0):o.push(t);null!=n;){if(o.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function a(e){function t(e){return e.nodeType===Node.ELEMENT_NODE&&e.nodeName===o.toUpperCase()}var n,o="hot-table",i=!1;for(n=l(e);null!=n;){if(t(n)){i=!0;break}if(n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(i=t(n.host))break;n=n.host}n=n.parentNode}return i}function l(e){return"undefined"!=typeof Polymer&&"function"==typeof wrap?wrap(e):e}function u(e){return"undefined"!=typeof Polymer&&"function"==typeof unwrap?unwrap(e):e}function c(e){var t=0;if(e.previousSibling)for(;e=e.previousSibling;)++t;return t}function d(e,t){var n=document.querySelector(".ht_clone_"+e);return n?n.contains(t):null}function h(e){var t=0,n=[];if(!e||!e.length)return n;for(;e[t];)n.push(e[t]),t++;return n}function f(e,t){return q(e,t)}function p(e,t){return $(e,t)}function g(e,t){return Z(e,t)}function m(e,t){if(3===e.nodeType)t.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var n=e.childNodes,o=n.length-1;o>=0;o--)m(n[o],e)}function v(e){for(var t;t=e.lastChild;)e.removeChild(t)}function w(e,t){ie.test(t)?e.innerHTML=t:y(e,t)}function y(e,t){var n=e.firstChild;n&&3===n.nodeType&&null===n.nextSibling?re?n.textContent=t:n.data=t:(v(e),e.appendChild(document.createTextNode(t)))}function C(e){for(var t=e;u(t)!==document.documentElement;){if(null===t)return!1;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(t.host){if(t.host.impl)return C(t.host.impl);if(t.host)return C(t.host);throw new Error("Lost in Web Components world")}return!1}if("none"===t.style.display)return!1;t=t.parentNode}return!0}function b(e){var t,n,o,i,r;if(i=document.documentElement,(0,J.hasCaptionProblem)()&&e.firstChild&&"CAPTION"===e.firstChild.nodeName)return r=e.getBoundingClientRect(),{top:r.top+(window.pageYOffset||i.scrollTop)-(i.clientTop||0),left:r.left+(window.pageXOffset||i.scrollLeft)-(i.clientLeft||0)};for(t=e.offsetLeft,n=e.offsetTop,o=e;(e=e.offsetParent)&&e!==document.body;)t+=e.offsetLeft,n+=e.offsetTop,o=e;return o&&"fixed"===o.style.position&&(t+=window.pageXOffset||i.scrollLeft,n+=window.pageYOffset||i.scrollTop),{left:t,top:n}}function S(){var e=window.scrollY;return void 0===e&&(e=document.documentElement.scrollTop),e}function T(){var e=window.scrollX;return void 0===e&&(e=document.documentElement.scrollLeft),e}function E(e){return e===window?S():e.scrollTop}function R(e){return e===window?T():e.scrollLeft}function O(e){for(var t,n,o,i=e.parentNode,r=["auto","scroll"],s="",a="",l="",u="";i&&i.style&&document.body!==i;){if(t=i.style.overflow,n=i.style.overflowX,o=i.style.overflowY,"scroll"==t||"scroll"==n||"scroll"==o)return i;if(window.getComputedStyle&&(s=window.getComputedStyle(i),a=s.getPropertyValue("overflow"),l=s.getPropertyValue("overflow-y"),u=s.getPropertyValue("overflow-x"),"scroll"===a||"scroll"===u||"scroll"===l))return i;if(i.clientHeight<=i.scrollHeight&&(-1!==r.indexOf(o)||-1!==r.indexOf(t)||-1!==r.indexOf(a)||-1!==r.indexOf(l)))return i;if(i.clientWidth<=i.scrollWidth&&(-1!==r.indexOf(n)||-1!==r.indexOf(t)||-1!==r.indexOf(a)||-1!==r.indexOf(u)))return i;i=i.parentNode}return window}function _(e){for(var t=e.parentNode;t&&t.style&&document.body!==t;){if("visible"!==t.style.overflow&&""!==t.style.overflow)return t;if(window.getComputedStyle){var n=window.getComputedStyle(t);if("visible"!==n.getPropertyValue("overflow")&&""!==n.getPropertyValue("overflow"))return t}t=t.parentNode}return window}function k(e,t){if(e){if(e!==window){var n,o=e.style[t];return""!==o&&void 0!==o?o:(n=M(e),""!==n[t]&&void 0!==n[t]?n[t]:void 0)}if("width"===t)return window.innerWidth+"px";if("height"===t)return window.innerHeight+"px"}}function M(e){return e.currentStyle||document.defaultView.getComputedStyle(e)}function D(e){return e.offsetWidth}function H(e){return(0,J.hasCaptionProblem)()&&e.firstChild&&"CAPTION"===e.firstChild.nodeName?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight}function x(e){return e.clientHeight||e.innerHeight}function A(e){return e.clientWidth||e.innerWidth}function P(e,t,n){window.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)}function N(e,t,n){window.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent("on"+t,n)}function L(e){if(e.selectionStart)return e.selectionStart;if(document.selection){e.focus();var t=document.selection.createRange();if(null==t)return 0;var n=e.createTextRange(),o=n.duplicate();return n.moveToBookmark(t.getBookmark()),o.setEndPoint("EndToStart",n),o.text.length}return 0}function W(e){if(e.selectionEnd)return e.selectionEnd;if(document.selection){var t=document.selection.createRange();if(null==t)return 0;return e.createTextRange().text.indexOf(t.text)+t.text.length}return 0}function j(){var e="";return window.getSelection?e=window.getSelection().toString():document.selection&&"Control"!==document.selection.type&&(e=document.selection.createRange().text),e}function F(e,t,n){if(void 0===n&&(n=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,n)}catch(r){var o=e.parentNode,i=o.style.display;o.style.display="block",e.setSelectionRange(t,n),o.style.display=i}}else if(e.createTextRange){var r=e.createTextRange();r.collapse(!0),r.moveEnd("character",n),r.moveStart("character",t),r.select()}}function I(){var e=document.createElement("div");e.style.height="200px",e.style.width="100%";var t=document.createElement("div");t.style.boxSizing="content-box",t.style.height="150px",t.style.left="0px",t.style.overflow="hidden",t.style.position="absolute",t.style.top="0px",t.style.width="200px",t.style.visibility="hidden",t.appendChild(e),(document.body||document.documentElement).appendChild(t);var n=e.offsetWidth;t.style.overflow="scroll";var o=e.offsetWidth;return n==o&&(o=t.clientWidth),(document.body||document.documentElement).removeChild(t),n-o}function V(){return void 0===oe&&(oe=I()),oe}function B(e){return e.offsetWidth!==e.clientWidth}function Y(e){return e.offsetHeight!==e.clientHeight}function z(e,t,n){(0,Q.isIE8)()||(0,Q.isIE9)()?(e.style.top=n,e.style.left=t):(0,Q.isSafari)()?e.style["-webkit-transform"]="translate3d("+t+","+n+",0)":e.style.transform="translate3d("+t+","+n+",0)"}function U(e){var t;return e.style.transform&&""!==(t=e.style.transform)?["transform",t]:e.style["-webkit-transform"]&&""!==(t=e.style["-webkit-transform"])?["-webkit-transform",t]:-1}function G(e){e.style.transform&&""!==e.style.transform?e.style.transform="":e.style["-webkit-transform"]&&""!==e.style["-webkit-transform"]&&(e.style["-webkit-transform"]="")}function K(e){var t=["INPUT","SELECT","TEXTAREA"];return e&&(t.indexOf(e.nodeName)>-1||"true"===e.contentEditable)}function X(e){return K(e)&&-1==e.className.indexOf("handsontableInput")&&-1==e.className.indexOf("copyPaste")}t.__esModule=!0,t.HTML_CHARACTERS=void 0,t.getParent=o,t.closest=i,t.closestDown=r,t.isChildOf=s,t.isChildOfWebComponentTable=a,t.polymerWrap=l,t.polymerUnwrap=u,t.index=c,t.overlayContainsElement=d,t.hasClass=f,t.addClass=p,t.removeClass=g,t.removeTextNodes=m,t.empty=v,t.fastInnerHTML=w,t.fastInnerText=y,t.isVisible=C,t.offset=b,t.getWindowScrollTop=S,t.getWindowScrollLeft=T,t.getScrollTop=E,t.getScrollLeft=R,t.getScrollableElement=O,t.getTrimmingContainer=_,t.getStyle=k,t.getComputedStyle=M,t.outerWidth=D,t.outerHeight=H,t.innerHeight=x,t.innerWidth=A,t.addEvent=P,t.removeEvent=N,t.getCaretPosition=L,t.getSelectionEndPosition=W,t.getSelectionText=j,t.setCaretPosition=F,t.getScrollbarWidth=V,t.hasVerticalScrollbar=B,t.hasHorizontalScrollbar=Y,t.setOverlayPosition=z,t.getCssTransform=U,t.resetCssTransform=G,t.isInput=K,t.isOutsideInput=X;var q,$,Z,Q=n(20),J=n(37),ee=!!document.documentElement.classList;if(ee){var te=function(){var e=document.createElement("div");return e.classList.add("test","test2"),e.classList.contains("test2")}();q=function(e,t){return""!==t&&e.classList.contains(t)},$=function(e,t){var n=0;if("string"==typeof t&&(t=t.split(" ")),t=h(t),te)e.classList.add.apply(e.classList,t);else for(;t&&t[n];)e.classList.add(t[n]),n++},Z=function(e,t){var n=0;if("string"==typeof t&&(t=t.split(" ")),t=h(t),te)e.classList.remove.apply(e.classList,t);else for(;t&&t[n];)e.classList.remove(t[n]),n++}}else{var ne=function(e){return new RegExp("(\\s|^)"+e+"(\\s|$)")};q=function(e,t){return!!e.className.match(ne(t))},$=function(e,t){var n=0,o=e.className;if("string"==typeof t&&(t=t.split(" ")),""===o)o=t.join(" ");else for(;t&&t[n];)ne(t[n]).test(o)||(o+=" "+t[n]),n++;e.className=o},Z=function(e,t){var n=0,o=e.className;for("string"==typeof t&&(t=t.split(" "));t&&t[n];)o=o.replace(ne(t[n])," ").trim(),n++;e.className!==o&&(e.className=o)}}var oe,ie=t.HTML_CHARACTERS=/(<(.*)>|&(.*);)/,re=!!document.createTextNode("test").textContent},function(e,t,n){var o=n(5),i=n(43),r=n(26),s=n(27),a=n(23),l=function e(t,n,l){var u,c,d,h,f=t&e.F,p=t&e.G,g=t&e.S,m=t&e.P,v=t&e.B,w=p?o:g?o[n]||(o[n]={}):(o[n]||{}).prototype,y=p?i:i[n]||(i[n]={}),C=y.prototype||(y.prototype={});p&&(l=n);for(u in l)c=!f&&w&&void 0!==w[u],d=(c?w:l)[u],h=v&&c?a(d,o):m&&"function"==typeof d?a(Function.call,d):d,w&&s(w,u,d,t&e.U),y[u]!=d&&r(y,u,h),m&&C[u]!=d&&(C[u]=d)};o.core=i,l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,e.exports=l},function(e,t,n){function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e){var t;return Array.isArray(e)?t=[]:(t={},g(e,function(e,n){"__children"!==n&&(e&&"object"===(void 0===e?"undefined":C(e))&&!Array.isArray(e)?t[n]=i(e):Array.isArray(e)?e.length&&"object"===C(e[0])&&!Array.isArray(e[0])?t[n]=[i(e[0])]:t[n]=[]:t[n]=null)})),t}function r(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function a(e,t){return g(t,function(t,n){e[n]=t}),e}function l(e,t){g(t,function(n,o){t[o]&&"object"===C(t[o])?(e[o]||(Array.isArray(t[o])?e[o]=[]:"[object Date]"===Object.prototype.toString.call(t[o])?e[o]=t[o]:e[o]={}),l(e[o],t[o])):e[o]=t[o]})}function u(e){return"object"===(void 0===e?"undefined":C(e))?JSON.parse(JSON.stringify(e)):e}function c(e){var t={};return g(e,function(e,n){t[n]=e}),t}function d(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,n=Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return(0,b.arrayEach)(n,function(t){e.MIXINS.push(t.MIXIN_NAME),g(t,function(t,n){if(void 0!==e.prototype[n])throw new Error("Mixin conflict. Property '"+n+"' already exist and cannot be overwritten.");if("function"==typeof t)e.prototype[n]=t;else{Object.defineProperty(e.prototype,n,{get:function(e,t){e="_"+e;var n=function(e){return(Array.isArray(e)||f(e))&&(e=u(e)),e};return function(){return void 0===this[e]&&(this[e]=n(t)),this[e]}}(n,t),set:function(e){return e="_"+e,function(t){this[e]=t}}(n),configurable:!0})}})}),e}function h(e,t){return JSON.stringify(e)===JSON.stringify(t)}function f(e){return"[object Object]"==Object.prototype.toString.call(e)}function p(e,t,n,o){o.value=n,o.writable=!1!==o.writable,o.enumerable=!1!==o.enumerable,o.configurable=!1!==o.configurable,Object.defineProperty(e,t,o)}function g(e,t){for(var n in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,n))&&!1===t(e[n],n,e))break;return e}function m(e,t){var n=t.split("."),o=e;return g(n,function(e){if(void 0===(o=o[e]))return o=void 0,!1}),o}function v(e){if(!f(e))return 0;return function e(t){var n=0;return f(t)?g(t,function(t){n+=e(t)}):n++,n}(e)}function w(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value",i="_"+n,r=(t={_touched:!1},o(t,i,e),o(t,"isTouched",function(){return this._touched}),t);return Object.defineProperty(r,n,{get:function(){return this[i]},set:function(e){this._touched=!0,this[i]=e},enumerable:!0,configurable:!0}),r}function y(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.__esModule=!0;var C="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return void 0===e?"undefined":s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":s(e)};t.duckSchema=i,t.inherit=r,t.extend=a,t.deepExtend=l,t.deepClone=u,t.clone=c,t.mixin=d,t.isObjectEquals=h,t.isObject=f,t.defineGetter=p,t.objectEach=g,t.getProperty=m,t.deepObjectSize=v,t.createObjectPropListener=w,t.hasOwnProperty=y;var b=n(7)},function(e,t,n){function o(e){return e&&e.__esModule?e:{default:e}}function i(e){if("function"==typeof e)return e;if(!E(e))throw Error('No registered renderer found under "'+e+'" name');return T(e)}t.__esModule=!0,t.getRegisteredRenderers=t.getRegisteredRendererNames=t.hasRenderer=t.getRenderer=t.registerRenderer=void 0;var r=n(50),s=o(r),a=n(319),l=o(a),u=n(320),c=o(u),d=n(321),h=o(d),f=n(322),p=o(f),g=n(323),m=o(g),v=n(324),w=o(v),y=n(325),C=o(y),b=(0,s.default)("renderers"),S=b.register,T=b.getItem,E=b.hasItem,R=b.getNames,O=b.getValues;S("base",l.default),S("autocomplete",c.default),S("checkbox",h.default),S("html",p.default),S("numeric",m.default),S("password",w.default),S("text",C.default),t.registerRenderer=S,t.getRenderer=i,t.hasRenderer=E,t.getRegisteredRendererNames=R,t.getRegisteredRenderers=O},function(e,t,n){var o=n(77)("wks"),i=n(48),r=n(5).Symbol,s="function"==typeof r;(e.exports=function(e){return o[e]||(o[e]=s&&r[e]||(s?r:i)("Symbol."+e))}).store=o},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t,n){function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){var n=void 0,o=void 0,i=void 0,r=void 0,s=void 0,c=void 0;if(t.isTargetWebComponent=!1,t.realTarget=t.target,c=t.stopImmediatePropagation,t.stopImmediatePropagation=function(){c.apply(this),(0,u.stopImmediatePropagation)(this)},!d.isHotTableEnv)return t;for(t=(0,a.polymerWrap)(t),s=t.path?t.path.length:0;s--;){if("HOT-TABLE"===t.path[s].nodeName)n=!0;else if(n&&t.path[s].shadowRoot){r=t.path[s];break}0!==s||r||(r=t.path[s])}return r||(r=t.target),t.isTargetWebComponent=!0,(0,l.isWebComponentSupportedNatively)()?t.realTarget=t.srcElement||t.toElement:(e instanceof Core||e instanceof Walkontable)&&(e instanceof Core?o=e.view?e.view.wt.wtTable.TABLE:null:e instanceof Walkontable&&(o=e.wtTable.TABLE.parentNode.parentNode),i=(0,a.closest)(t.target,["HOT-TABLE"],o),t.realTarget=i?o.querySelector("HOT-TABLE")||t.target:t.target),Object.defineProperty(t,"target",{get:function(){return(0,a.polymerWrap)(r)},enumerable:!0,configurable:!0}),t}function r(){return c}t.__esModule=!0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();t.getListenersCounter=r;var a=n(0),l=n(37),u=n(10),c=0,d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;o(this,e),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}return s(e,[{key:"addEventListener",value:function(e,t,n){function o(e){e=i(s,e),n.call(this,e)}var r=this,s=this.context;return this.context.eventListeners.push({element:e,event:t,callback:n,callbackProxy:o}),window.addEventListener?e.addEventListener(t,o,!1):e.attachEvent("on"+t,o),c++,function(){r.removeEventListener(e,t,n)}}},{key:"removeEventListener",value:function(e,t,n){for(var o=this.context.eventListeners.length,i=void 0;o--;)if(i=this.context.eventListeners[o],i.event==t&&i.element==e){if(n&&n!=i.callback)continue;this.context.eventListeners.splice(o,1),i.element.removeEventListener?i.element.removeEventListener(i.event,i.callbackProxy,!1):i.element.detachEvent("on"+i.event,i.callbackProxy),c--}}},{key:"clearEvents",value:function(){if(this.context)for(var e=this.context.eventListeners.length;e--;){var t=this.context.eventListeners[e];t&&this.removeEventListener(t.element,t.event,t.callback)}}},{key:"clear",value:function(){this.clearEvents()}},{key:"destroy",value:function(){this.clearEvents(),this.context=null}},{key:"fireEvent",value:function(e,t){var n,o={bubbles:!0,cancelable:"mousemove"!==t,view:window,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};document.createEvent?(n=document.createEvent("MouseEvents"),n.initMouseEvent(t,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,o.relatedTarget||document.body.parentNode)):n=document.createEventObject(),e.dispatchEvent?e.dispatchEvent(n):e.fireEvent("on"+t,n)}}]),e}();t.default=d},function(e,t,n){function o(e){for(var t=0,n=e.length;t<n;)e[t]=[e[t]],t++}function i(e,t){for(var n=0,o=t.length;n<o;)e.push(t[n]),n++}function r(e){var t=[];if(!e||0===e.length||!e[0]||0===e[0].length)return t;for(var n=e.length,o=e[0].length,i=0;i<n;i++)for(var r=0;r<o;r++)t[r]||(t[r]=[]),t[r][i]=e[i][r];return t}function s(e,t,n,o){var i=-1,r=e.length;for(o&&r&&(n=e[++i]);++i<r;)n=t(n,e[i],i,e);return n}function a(e,t){for(var n=-1,o=e.length,i=-1,r=[];++n<o;){var s=e[n];t(s,n,e)&&(r[++i]=s)}return r}function l(e,t){for(var n=-1,o=e.length,i=-1,r=[];++n<o;){var s=e[n];r[++i]=t(s,n,e)}return r}function u(e,t){for(var n=-1,o=e.length;++n<o&&!1!==t(e[n],n,e););return e}function c(e){return s(e,function(e,t){return e+t},0)}function d(e){return s(e,function(e,t){return e>t?e:t},Array.isArray(e)?e[0]:void 0)}function h(e){return s(e,function(e,t){return e<t?e:t},Array.isArray(e)?e[0]:void 0)}function f(e){return e.length?c(e)/e.length:0}function p(e){return s(e,function(e,t){return e.concat(Array.isArray(t)?p(t):t)},[])}function g(e){var t=[];return u(e,function(e){-1===t.indexOf(e)&&t.push(e)}),t}t.__esModule=!0,t.to2dArray=o,t.extendArray=i,t.pivot=r,t.arrayReduce=s,t.arrayFilter=a,t.arrayMap=l,t.arrayEach=u,t.arraySum=c,t.arrayMax=d,t.arrayMin=h,t.arrayAvg=f,t.arrayFlatten=p,t.arrayUnique=g},function(e,t,n){function o(e){return e&&e.__esModule?e:{default:e}}function i(e){var t={},n=e;this.getConstructor=function(){return e},this.getInstance=function(e){return e.guid in t||(t[e.guid]=new n(e)),t[e.guid]},d.default.getSingleton().add("afterDestroy",function(){t={}})}function r(e,t){var n=void 0;if("function"==typeof e)P.get(e)||a(null,e),n=P.get(e);else{if("string"!=typeof e)throw Error('Only strings and functions can be passed as "editor" parameter');n=W(e)}if(!n)throw Error('No editor registered under name "'+e+'"');return n.getInstance(t)}function s(e){if(!j(e))throw Error('No registered editor found under "'+e+'" name');return W(e).getConstructor()}function a(e,t){var n=new i(t);"string"==typeof e&&L(e,n),P.set(t,n)}t.__esModule=!0,t.getRegisteredEditors=t.getRegisteredEditorNames=t.hasEditor=t.getEditorInstance=t.getEditor=t.registerEditor=void 0,t.RegisteredEditor=i,t._getEditorInstance=r;var l=n(50),u=o(l),c=n(21),d=o(c),h=n(31),f=o(h),p=n(255),g=o(p),m=n(307),v=o(m),w=n(308),y=o(w),C=n(309),b=o(C),S=n(256),T=o(S),E=n(310),R=o(E),O=n(311),_=o(O),k=n(312),M=o(k),D=n(313),H=o(D),x=n(42),A=o(x),P=new WeakMap,N=(0,u.default)("editors"),L=N.register,W=N.getItem,j=N.hasItem,F=N.getNames,I=N.getValues;a("base",f.default),a("autocomplete",g.default),a("checkbox",v.default),a("date",y.default),a("dropdown",b.default),a("handsontable",T.default),a("mobile",R.default),a("numeric",_.default),a("password",M.default),a("select",H.default),a("text",A.default),t.registerEditor=a,t.getEditor=s,t.getEditorInstance=r,t.hasEditor=j,t.getRegisteredEditorNames=F,t.getRegisteredEditors=I},function(e,t){e.exports=function(e){return"object"===(void 0===e?"undefined":s(e))?null!==e:"function"==typeof e}},function(e,t,n){function o(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function i(e){return!1===e.isImmediatePropagationEnabled}function r(e){"function"==typeof e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function s(e){return e.pageX?e.pageX:e.clientX+(0,c.getWindowScrollLeft)()}function a(e){return e.pageY?e.pageY:e.clientY+(0,c.getWindowScrollTop)()}function l(e){return 2===e.button}function u(e){return 0===e.button}t.__esModule=!0,t.stopImmediatePropagation=o,t.isImmediatePropagationStopped=i,t.stopPropagation=r,t.pageX=s,t.pageY=a,t.isRightClick=l,t.isLeftClick=u;var c=n(0)},function(e,t,n){var o=n(9);e.exports=function(e){if(!o(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){var o=n(11),i=n(264),r=n(80),s=Object.defineProperty;t.f=n(14)?Object.defineProperty:function(e,t,n){if(o(e),t=r(t,!0),o(n),i)try{return s(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){function o(e){return 32==e||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function i(e){return-1!==[l.ARROW_DOWN,l.ARROW_UP,l.ARROW_LEFT,l.ARROW_RIGHT,l.HOME,l.END,l.DELETE,l.BACKSPACE,l.F1,l.F2,l.F3,l.F4,l.F5,l.F6,l.F7,l.F8,l.F9,l.F10,l.F11,l.F12,l.TAB,l.PAGE_DOWN,l.PAGE_UP,l.ENTER,l.ESCAPE,l.SHIFT,l.CAPS_LOCK,l.ALT].indexOf(e)}function r(e){return-1!==[l.CONTROL_LEFT,224,l.COMMAND_LEFT,l.COMMAND_RIGHT].indexOf(e)}function s(e,t){var n=t.split("|"),o=!1;return(0,a.arrayEach)(n,function(t){if(e===l[t])return o=!0,!1}),o}t.__esModule=!0,t.KEY_CODES=void 0,t.isPrintableChar=o,t.isMetaKey=i,t.isCtrlKey=r,t.isKey=s;var a=n(7),l=t.KEY_CODES={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL_LEFT:91,COMMAND_LEFT:17,COMMAND_RIGHT:93,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,V:86}},function(e,t,n){e.exports=!n(25)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var o=n(71),i=n(24);e.exports=function(e){return o(i(e))}},function(e,t,n){var o=n(60),i=Math.min;e.exports=function(e){return e>0?i(o(e),9007199254740991):0}},function(e,t,n){function o(e){var t=void 0===e?"undefined":l(e);return"number"==t?!isNaN(e)&&isFinite(e):"string"==t?!!e.length&&(1==e.length?/\d/.test(e):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(e)):"object"==t&&!(!e||"number"!=typeof e.valueOf()||e instanceof Date)}function i(e,t,n){var o=-1;for("function"==typeof t?(n=t,t=e):o=e-1;++o<=t&&!1!==n(o););}function r(e,t,n){var o=e+1;for("function"==typeof t&&(n=t,t=0);--o>=t&&!1!==n(o););}function a(e,t){return t=parseInt(t.toString().replace("%",""),10),t=parseInt(e*t/100,10)}t.__esModule=!0;var l="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return void 0===e?"undefined":s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":s(e)};t.isNumeric=o,t.rangeEach=i,t.rangeEachReverse=r,t.valueAccordingPercent=a},function(e,t,n){function o(e){return e&&e.__esModule?e:{default:e}}function i(e){if("function"==typeof e)return e;if(!w(e))throw Error('No registered validator found under "'+e+'" name');return v(e)}t.__esModule=!0,t.getRegisteredValidators=t.getRegisteredValidatorNames=t.hasValidator=t.getValidator=t.registerValidator=void 0;var r=n(50),s=o(r),a=n(328),l=o(a),u=n(329),c=o(u),d=n(330),h=o(d),f=n(331),p=o(f),g=(0,s.default)("validators"),m=g.register,v=g.getItem,w=g.hasItem,y=g.getNames,C=g.getValues;m("autocomplete",l.default),m("date",c.default),m("numeric",h.default),m("time",p.default),t.registerValidator=m,t.getValidator=i,t.hasValidator=w,t.getRegisteredValidatorNames=y,t.getRegisteredValidators=C},function(e,t,n){function o(){return l}function i(){return u}function r(){return c}function s(){return d}function a(e){return e||(e=navigator.userAgent),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)}t.__esModule=!0,t.isIE8=o,t.isIE9=i,t.isSafari=r,t.isChrome=s,t.isMobileBrowser=a;var l=!document.createTextNode("test").textContent,u=!!document.documentMode,c=/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor),d=/Chrome/.test(navigator.userAgent)&&/Google/.test(navigator.vendor)},function(e,t,n){function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(7),s=n(2),a=["afterCellMetaReset","afterChange","afterChangesObserved","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","afterRender","beforeRenderer","afterRenderer","afterScrollHorizontally","afterScrollVertically","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSetCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterUpdateSettings","afterValidate","beforeAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeInit","beforeInitWalkontable","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeRender","beforeSetRangeStart","beforeSetRangeEnd","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyCol","unmodifyCol","unmodifyRow","modifyColHeader","modifyColWidth","modifyRow","modifyRowHeader","modifyRowHeight","modifyData","modifyRowData","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnMove","afterColumnMove","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","modifyColumnHeaderHeight","beforeUndo","afterUndo","beforeRedo","afterRedo","modifyRowHeaderWidth","beforeAutofillInsidePopulate","modifyTransformStart","modifyTransformEnd","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","manualRowHeights","skipLengthCache","afterTrimRow","afterUntrimRow","afterDropdownMenuShow","afterDropdownMenuHide","hiddenRow","hiddenColumn","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","afterBeginEditing"],l=function(){function e(){o(this,e),this.globalBucket=this.createEmptyBucket()}return i(e,null,[{key:"getSingleton",value:function(){return u}}]),i(e,[{key:"createEmptyBucket",value:function(){var e=Object.create(null);return(0,r.arrayEach)(a,function(t){return e[t]=[]}),e}},{key:"getBucket",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}},{key:"add",value:function(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(Array.isArray(t))(0,r.arrayEach)(t,function(t){return n.add(e,t,o)});else{var i=this.getBucket(o);if(void 0===i[e]&&(this.register(e),i[e]=[]),t.skip=!1,-1===i[e].indexOf(t)){var s=!1;t.initialHook&&(0,r.arrayEach)(i[e],function(n,o){if(n.initialHook)return i[e][o]=t,s=!0,!1}),s||i[e].push(t)}}return this}},{key:"once",value:function(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(t)?(0,r.arrayEach)(t,function(t){return n.once(e,t,o)}):(t.runOnce=!0,this.add(e,t,o))}},{key:"remove",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=this.getBucket(n);return void 0!==o[e]&&o[e].indexOf(t)>=0&&(t.skip=!0,!0)}},{key:"has",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getBucket(t);return!(void 0===n[e]||!n[e].length)}},{key:"run",value:function(e,t,n,o,i,r,s,a){var l=this.globalBucket[t],u=-1,c=l?l.length:0;if(c)for(;++u<c;)if(l[u]&&!l[u].skip){var d=l[u].call(e,n,o,i,r,s,a);void 0!==d&&(n=d),l[u]&&l[u].runOnce&&this.remove(t,l[u])}var h=this.getBucket(e)[t],f=-1,p=h?h.length:0;if(p)for(;++f<p;)if(h[f]&&!h[f].skip){var g=h[f].call(e,n,o,i,r,s,a);void 0!==g&&(n=g),h[f]&&h[f].runOnce&&this.remove(t,h[f],e)}return n}},{key:"destroy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(0,s.objectEach)(this.getBucket(e),function(e,t,n){return n[t].length=0})}},{key:"register",value:function(e){this.isRegistered(e)||a.push(e)}},{key:"deregister",value:function(e){this.isRegistered(e)&&a.splice(a.indexOf(e),1)}},{key:"isRegistered",value:function(e){return a.indexOf(e)>=0}},{key:"getRegistered",value:function(){return a}}]),e}(),u=new l;t.default=l},function(e,t,n){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=n(0),a=n(2),l=n(7),u=n(6),c=o(u),d=n(245),h=o(d),f={},p=function(){function e(t){i(this,e),(0,a.defineGetter)(this,"wot",t,{writable:!1}),this.instance=this.wot,this.type="",this.mainTableScrollableElement=null,this.TABLE=this.wot.wtTable.TABLE,this.hider=this.wot.wtTable.hider,this.spreader=this.wot.wtTable.spreader,this.holder=this.wot.wtTable.holder,this.wtRootElement=this.wot.wtTable.wtRootElement,this.trimmingContainer=(0,s.getTrimmingContainer)(this.hider.parentNode.parentNode),this.areElementSizesAdjusted=!1,this.updateStateOfRendering()}return r(e,null,[{key:"registerOverlay",value:function(t,n){if(-1===e.CLONE_TYPES.indexOf(t))throw new Error("Unsupported overlay ("+t+").");f[t]=n}},{key:"createOverlay",value:function(e,t){return new f[e](t)}},{key:"hasOverlay",value:function(e){return void 0!==f[e]}},{key:"isOverlayTypeOf",value:function(e,t){return!(!e||!f[t])&&e instanceof f[t]}},{key:"CLONE_TOP",get:function(){return"top"}},{key:"CLONE_BOTTOM",get:function(){return"bottom"}},{key:"CLONE_LEFT",get:function(){return"left"}},{key:"CLONE_TOP_LEFT_CORNER",get:function(){return"top_left_corner"}},{key:"CLONE_BOTTOM_LEFT_CORNER",get:function(){return"bottom_left_corner"}},{key:"CLONE_DEBUG",get:function(){return"debug"}},{key:"CLONE_TYPES",get:function(){return[e.CLONE_TOP,e.CLONE_BOTTOM,e.CLONE_LEFT,e.CLONE_TOP_LEFT_CORNER,e.CLONE_BOTTOM_LEFT_CORNER,e.CLONE_DEBUG]}}]),r(e,[{key:"updateStateOfRendering",value:function(){var e=this.needFullRender;this.needFullRender=this.shouldBeRendered();var t=e!==this.needFullRender;return t&&!this.needFullRender&&this.reset(),t}},{key:"shouldBeRendered",value:function(){return!0}},{key:"updateTrimmingContainer",value:function(){this.trimmingContainer=(0,s.getTrimmingContainer)(this.hider.parentNode.parentNode)}},{key:"updateMainScrollableElement",value:function(){this.mainTableScrollableElement=(0,s.getScrollableElement)(this.wot.wtTable.TABLE)}},{key:"makeClone",value:function(t){if(-1===e.CLONE_TYPES.indexOf(t))throw new Error('Clone type "'+t+'" is not supported.');var n=document.createElement("DIV"),o=document.createElement("TABLE");n.className="ht_clone_"+t+" handsontable",n.style.position="absolute",n.style.top=0,n.style.left=0,n.style.overflow="hidden",o.className=this.wot.wtTable.TABLE.className,n.appendChild(o),this.type=t,this.wot.wtTable.wtRootElement.parentNode.appendChild(n);var i=this.wot.getSetting("preventOverflow");return!0===i||"horizontal"===i&&this.type===e.CLONE_TOP||"vertical"===i&&this.type===e.CLONE_LEFT?this.mainTableScrollableElement=window:this.mainTableScrollableElement=(0,s.getScrollableElement)(this.wot.wtTable.TABLE),new h.default({cloneSource:this.wot,cloneOverlay:this,table:o})}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.shouldBeRendered();this.clone&&(this.needFullRender||t)&&this.clone.draw(e),this.needFullRender=t}},{key:"reset",value:function(){if(this.clone){var e=this.clone.wtTable.holder,t=this.clone.wtTable.hider,n=e.style,o=t.style,i=e.parentNode.style;(0,l.arrayEach)([n,o,i],function(e){e.width="",e.height=""})}}},{key:"destroy",value:function(){new c.default(this.clone).destroy()}}]),e}();t.default=p},function(e,t,n){var o=n(66);e.exports=function(e,t,n){if(o(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,o){return e.call(t,n,o)};case 3:return function(n,o,i){return e.call(t,n,o,i)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){var o=n(12),i=n(35);e.exports=n(14)?function(e,t,n){return o.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var o=n(5),i=n(26),r=n(15),s=n(48)("src"),a=Function.toString,l=(""+a).split("toString");n(43).inspectSource=function(e){return a.call(e)},(e.exports=function(e,t,n,a){var u="function"==typeof n;u&&(r(n,"name")||i(n,"name",t)),e[t]!==n&&(u&&(r(n,s)||i(n,s,e[t]?""+e[t]:l.join(String(t)))),e===o?e[t]=n:a?e[t]?e[t]=n:i(e,t,n):(delete e[t],i(e,t,n)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[s]||a.call(this)})},function(e,t,n){function o(e){var t=void 0;switch(void 0===e?"undefined":u(e)){case"string":case"number":t=""+e;break;case"object":t=null===e?"":e.toString();break;case"undefined":t="";break;default:t=e.toString()}return t}function i(e){return void 0!==e}function r(e){return void 0===e}function a(e){return null===e||""===e||r(e)}function l(e){return"[object RegExp]"===Object.prototype.toString.call(e)}t.__esModule=!0;var u="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return void 0===e?"undefined":s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":s(e)};t.stringify=o,t.isDefined=i,t.isUndefined=r,t.isEmpty=a,t.isRegExp=l},function(e,t,n){function o(e){return e[0].toUpperCase()+e.substr(1)}function i(){for(var e=[],t=arguments.length,n=Array(t),o=0;o<t;o++)n[o]=arguments[o];for(var i=n.length;i--;){var r=(0,u.stringify)(n[i]).toLowerCase();-1===e.indexOf(r)&&e.push(r)}return 1===e.length}function r(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}function s(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(""+e).replace(/(?:\\)?\[([^[\]]+)]/g,function(e,n){return"\\"===e.charAt(0)?e.substr(1,e.length-1):void 0===t[n]?"":t[n]})}function l(e){return e+="",e.replace(c,"")}t.__esModule=!0,t.toUpperCaseFirst=o,t.equalsIgnoreCase=i,t.randomString=r,t.isPercentValue=s,t.substitute=a,t.stripTags=l;var u=n(28),c=(n(18),/<\/?\w+\/?>|<\w+[\s|\/][^>]*>/gi)},function(e,t,n){function o(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0,t.Viewport=t.TableRenderer=t.Table=t.Settings=t.Selection=t.Scroll=t.Overlays=t.Event=t.Core=t.default=t.Border=t.TopLeftCornerOverlay=t.TopOverlay=t.LeftOverlay=t.DebugOverlay=t.RowFilter=t.ColumnFilter=t.CellRange=t.CellCoords=t.ViewportRowsCalculator=t.ViewportColumnsCalculator=void 0,n(91),n(108),n(117),n(118),n(102),n(116),n(99),n(100),n(101),n(90),n(113),n(111),n(109),n(114),n(115),n(110),n(112),n(103),n(104),n(105),n(107),n(106),n(88),n(89),n(84),n(87),n(86),n(85),n(64),n(93),n(94),n(96),n(95),n(92),n(98),n(97),n(119),n(122),n(120),n(121),n(124),n(123),n(126),n(125);var i=n(243),r=o(i),s=n(244),a=o(s),l=n(41),u=o(l),c=n(65),d=o(c),h=n(247),f=o(h),p=n(248),g=o(p),m=n(290),v=o(m),w=n(291),y=o(w),C=n(292),b=o(C),S=n(293),T=o(S),E=n(242),R=o(E),O=n(245),_=o(O),k=n(246),M=o(k),D=n(249),H=o(D),x=n(250),A=o(x),P=n(294),N=o(P),L=n(251),W=o(L),j=n(252),F=o(j),I=n(253),V=o(I),B=n(254),Y=o(B);t.ViewportColumnsCalculator=r.default,t.ViewportRowsCalculator=a.default,t.CellCoords=u.default,t.CellRange=d.default,t.ColumnFilter=f.default,t.RowFilter=g.default,t.DebugOverlay=v.default,t.LeftOverlay=y.default,t.TopOverlay=b.default,t.TopLeftCornerOverlay=T.default,t.Border=R.default,t.default=_.default,t.Core=_.default,t.Event=M.default,t.Overlays=H.default,t.Scroll=A.default,t.Selection=N.default,t.Settings=W.default,t.Table=F.default,t.TableRenderer=V.default,t.Viewport=Y.default},function(e,t,n){function o(e){this.instance=e,this.state=s.VIRGIN,this._opened=!1,this._fullEditMode=!1,this._closeCallback=null,this.init()}t.__esModule=!0,t.EditorState=void 0;var i=n(30),r=n(28),s=t.EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"};o.prototype._fireCallbacks=function(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)},o.prototype.init=function(){},o.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented")},o.prototype.setValue=function(e){throw Error("Editor setValue() method unimplemented")},o.prototype.open=function(){throw Error("Editor open() method unimplemented")},o.prototype.close=function(){throw Error("Editor close() method unimplemented")},o.prototype.prepare=function(e,t,n,o,i,r){this.TD=o,this.row=e,this.col=t,this.prop=n,this.originalValue=i,this.cellProperties=r,this.state=s.VIRGIN},o.prototype.extend=function(){function e(){t.apply(this,arguments)}var t=this.constructor;return function(e,t){function n(){}return n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e,e}(e,t)},o.prototype.saveValue=function(e,t){var n=void 0,o=void 0;t?(n=this.instance.getSelected(),n[0]>n[2]&&(o=n[0],n[0]=n[2],n[2]=o),n[1]>n[3]&&(o=n[1],n[1]=n[3],n[3]=o)):n=[this.row,this.col,null,null],this.instance.populateFromArray(n[0],n[1],e,n[2],n[3],"edit")},o.prototype.beginEditing=function(e,t){this.state==s.VIRGIN&&(this.instance.view.scrollViewport(new i.CellCoords(this.row,this.col)),this.instance.view.render(),this.state=s.EDITING,e="string"==typeof e?e:this.originalValue,this.setValue((0,r.stringify)(e)),this.open(t),this._opened=!0,this.focus(),this.instance.view.render(),this.instance.runHooks("afterBeginEditing",this.row,this.col))},o.prototype.finishEditing=function(e,t,n){var o,i=this;if(n){var r=this._closeCallback;this._closeCallback=function(e){r&&r(e),n(e),i.instance.view.render()}}if(!this.isWaiting()){if(this.state==s.VIRGIN)return void this.instance._registerTimeout(setTimeout(function(){i._fireCallbacks(!0)},0));if(this.state==s.EDITING){if(e)return this.cancelChanges(),void this.instance.view.render();var a=this.getValue();o=this.instance.getSettings().trimWhitespace?[["string"==typeof a?String.prototype.trim.call(a||""):a]]:[[a]],this.state=s.WAITING,this.saveValue(o,t),this.instance.getCellValidator(this.cellProperties)?this.instance.addHookOnce("postAfterValidate",function(e){i.state=s.FINISHED,i.discardEditor(e)}):(this.state=s.FINISHED,this.discardEditor(!0))}}},o.prototype.cancelChanges=function(){this.state=s.FINISHED,this.discardEditor()},o.prototype.discardEditor=function(e){this.state===s.FINISHED&&(!1===e&&!0!==this.cellProperties.allowInvalid?(this.instance.selectCell(this.row,this.col),this.focus(),this.state=s.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=s.VIRGIN,this._fireCallbacks(!0)))},o.prototype.enableFullEditMode=function(){this._fullEditMode=!0},o.prototype.isInFullEditMode=function(){return this._fullEditMode},o.prototype.isOpened=function(){return this._opened},o.prototype.isWaiting=function(){return this.state===s.WAITING},o.prototype.checkEditorSection=function(){var e=this.instance.countRows(),t="";return this.row<this.instance.getSettings().fixedRowsTop?t=this.col<this.instance.getSettings().fixedColumnsLeft?"top-left-corner":"top":this.instance.getSettings().fixedRowsBottom&&this.row>=e-this.instance.getSettings().fixedRowsBottom?t=this.col<this.instance.getSettings().fixedColumnsLeft?"bottom-left-corner":"bottom":this.col<this.instance.getSettings().fixedColumnsLeft&&(t="left"),t},t.default=o},function(e,t,n){var o=n(4)("unscopables"),i=Array.prototype;void 0==i[o]&&n(26)(i,o,{}),e.exports=function(e){i[o][e]=!0}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t,n){var o=n(273),i=n(69);e.exports=Object.keys||function(e){return o(e,i)}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var o=n(24);e.exports=function(e){return Object(o(e))}},function(e,t,n){function o(e){return p.call(window,e)}function i(e){g.call(window,e)}function r(){return"ontouchstart"in window}function a(){var e=document.createElement("div");return!(!e.createShadowRoot||!e.createShadowRoot.toString().match(/\[native code\]/))}function l(){var e=document.createElement("TABLE");e.style.borderSpacing=0,e.style.borderWidth=0,e.style.padding=0;var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var n=document.createElement("CAPTION");n.innerHTML="c<br>c<br>c<br>c",n.style.padding=0,n.style.margin=0,e.insertBefore(n,t),document.body.appendChild(e),v=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function u(){return void 0===v&&l(),v}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return w||(w="object"===("undefined"==typeof Intl?"undefined":d(Intl))?new Intl.Collator(e,t).compare:"function"==typeof String.prototype.localeCompare?function(e,t){return(""+e).localeCompare(t)}:function(e,t){return e===t?0:e>t?-1:1})}t.__esModule=!0;var d="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return void 0===e?"undefined":s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":s(e)};t.requestAnimationFrame=o,t.cancelAnimationFrame=i,t.isTouchSupported=r,t.isWebComponentSupportedNatively=a,t.hasCaptionProblem=u,t.getComparisonFunction=c;for(var h=0,f=["ms","moz","webkit","o"],p=window.requestAnimationFrame,g=window.cancelAnimationFrame,m=0;m<f.length&&!p;++m)p=window[f[m]+"RequestAnimationFrame"],g=window[f[m]+"CancelAnimationFrame"]||window[f[m]+"CancelRequestAnimationFrame"];p||(p=function(e){var t=(new Date).getTime(),n=Math.max(0,16-(t-h)),o=window.setTimeout(function(){e(t+n)},n);return h=t+n,o}),g||(g=function(e){clearTimeout(e)});var v,w=void 0},function(e,t,n){function o(e){return"function"==typeof e}function i(e){function t(){var t=this,s=arguments,a=Date.now(),l=!1;i.lastCallThrottled=!0,o||(o=a,l=!0);var u=n-(a-o);return l?(i.lastCallThrottled=!1,e.apply(this,s)):(r&&clearTimeout(r),r=setTimeout(function(){i.lastCallThrottled=!1,e.apply(t,s),o=0,r=void 0},u)),i}var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,o=0,i={lastCallThrottled:!0},r=null;return t}function r(e){function t(){a=r}function n(){return a?(a--,e.apply(this,arguments)):s.apply(this,arguments)}var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,s=i(e,o),a=r;return n.clearHits=t,n}function s(e){function t(){var t=this,r=arguments;return o&&clearTimeout(o),o=setTimeout(function(){i=e.apply(t,r)},n),i}var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,o=null,i=void 0;return t}function a(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var o=t[0],i=t.slice(1);return function(){return(0,d.arrayReduce)(i,function(e,t){return t(e)},o.apply(this,arguments))}}function l(e){for(var t=arguments.length,n=Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return function(){for(var t=arguments.length,o=Array(t),i=0;i<t;i++)o[i]=arguments[i];return e.apply(this,n.concat(o))}}function u(e){function t(o){return function(){for(var i=arguments.length,r=Array(i),s=0;s<i;s++)r[s]=arguments[s];var a=o.concat(r);return a.length>=n?e.apply(this,a):t(a)}}var n=e.length;return t([])}function c(e){function t(o){return function(){for(var i=arguments.length,r=Array(i),s=0;s<i;s++)r[s]=arguments[s];var a=o.concat(r.reverse());return a.length>=n?e.apply(this,a):t(a)}}var n=e.length;return t([])}t.__esModule=!0,t.isFunction=o,t.throttle=i,t.throttleAfterHits=r,t.debounce=s,t.pipe=a,t.partial=l,t.curry=u,t.curryRight=c;var d=n(7)},function(e,t,n){function o(e,t){e=(0,c.toUpperCaseFirst)(e),l.default.getSingleton().add("construct",function(){var n=void 0;d.has(this)||d.set(this,{}),n=d.get(this),n[e]||(n[e]=new t(this))}),l.default.getSingleton().add("afterDestroy",function(){if(d.has(this)){var e=d.get(this);(0,u.objectEach)(e,function(e){return e.destroy()}),d.delete(this)}})}function i(e,t){if("string"!=typeof t)throw Error('Only strings can be passed as "plugin" parameter');var n=(0,c.toUpperCaseFirst)(t);if(d.has(e)&&d.get(e)[n])return d.get(e)[n]}function r(e){return d.has(e)?Object.keys(d.get(e)):[]}function s(e,t){var n=null;return d.has(e)&&(0,u.objectEach)(d.get(e),function(e,o){e===t&&(n=o)}),n}t.__esModule=!0,t.getPluginName=t.getRegistredPluginNames=t.getPlugin=t.registerPlugin=void 0;var a=n(21),l=function(e){return e&&e.__esModule?e:{default:e}}(a),u=n(2),c=n(29),d=new WeakMap;t.registerPlugin=o,t.getPlugin=i,t.getRegistredPluginNames=r,t.getPluginName=s},function(e,t,n){(function(e){!function(t,n){e.exports=n()}(0,function(){function t(){return So.apply(null,arguments)}function o(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function i(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function r(e){var t;for(t in e)return!1;return!0}function a(e){return void 0===e}function l(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function u(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function c(e,t){var n,o=[];for(n=0;n<e.length;++n)o.push(t(e[n],n));return o}function d(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function h(e,t){for(var n in t)d(t,n)&&(e[n]=t[n]);return d(t,"toString")&&(e.toString=t.toString),d(t,"valueOf")&&(e.valueOf=t.valueOf),e}function f(e,t,n,o){return Ct(e,t,n,o,!0).utc()}function p(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function g(e){return null==e._pf&&(e._pf=p()),e._pf}function m(e){if(null==e._isValid){var t=g(e),n=Eo.call(t.parsedDateParts,function(e){return null!=e}),o=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&n);if(e._strict&&(o=o&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return o;e._isValid=o}return e._isValid}function v(e){var t=f(NaN);return null!=e?h(g(t),e):g(t).userInvalidated=!0,t}function w(e,t){var n,o,i;if(a(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),a(t._i)||(e._i=t._i),a(t._f)||(e._f=t._f),a(t._l)||(e._l=t._l),a(t._strict)||(e._strict=t._strict),a(t._tzm)||(e._tzm=t._tzm),a(t._isUTC)||(e._isUTC=t._isUTC),a(t._offset)||(e._offset=t._offset),a(t._pf)||(e._pf=g(t)),a(t._locale)||(e._locale=t._locale),Ro.length>0)for(n=0;n<Ro.length;n++)o=Ro[n],i=t[o],a(i)||(e[o]=i);return e}function y(e){w(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===Oo&&(Oo=!0,t.updateOffset(this),Oo=!1)}function C(e){return e instanceof y||null!=e&&null!=e._isAMomentObject}function b(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function S(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=b(t)),n}function T(e,t,n){var o,i=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),s=0;for(o=0;o<i;o++)(n&&e[o]!==t[o]||!n&&S(e[o])!==S(t[o]))&&s++;return s+r}function E(e){!1===t.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function R(e,n){var o=!0;return h(function(){if(null!=t.deprecationHandler&&t.deprecationHandler(null,e),o){for(var i,r=[],a=0;a<arguments.length;a++){if(i="","object"===s(arguments[a])){i+="\n["+a+"] ";for(var l in arguments[0])i+=l+": "+arguments[0][l]+", ";i=i.slice(0,-2)}else i=arguments[a];r.push(i)}E(e+"\nArguments: "+Array.prototype.slice.call(r).join("")+"\n"+(new Error).stack),o=!1}return n.apply(this,arguments)},n)}function O(e,n){null!=t.deprecationHandler&&t.deprecationHandler(e,n),_o[e]||(E(n),_o[e]=!0)}function _(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function k(e){var t,n;for(n in e)t=e[n],_(t)?this[n]=t:this["_"+n]=t;this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function M(e,t){var n,o=h({},e);for(n in t)d(t,n)&&(i(e[n])&&i(t[n])?(o[n]={},h(o[n],e[n]),h(o[n],t[n])):null!=t[n]?o[n]=t[n]:delete o[n]);for(n in e)d(e,n)&&!d(t,n)&&i(e[n])&&(o[n]=h({},o[n]));return o}function D(e){null!=e&&this.set(e)}function H(e,t,n){var o=this._calendar[e]||this._calendar.sameElse;return _(o)?o.call(t,n):o}function x(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])}function A(){return this._invalidDate}function P(e){return this._ordinal.replace("%d",e)}function N(e,t,n,o){var i=this._relativeTime[n];return _(i)?i(e,t,n,o):i.replace(/%d/i,e)}function L(e,t){var n=this._relativeTime[e>0?"future":"past"];return _(n)?n(t):n.replace(/%s/i,t)}function W(e,t){var n=e.toLowerCase();No[n]=No[n+"s"]=No[t]=e}function j(e){return"string"==typeof e?No[e]||No[e.toLowerCase()]:void 0}function F(e){var t,n,o={};for(n in e)d(e,n)&&(t=j(n))&&(o[t]=e[n]);return o}function I(e,t){Lo[e]=t}function V(e){var t=[];for(var n in e)t.push({unit:n,priority:Lo[n]});return t.sort(function(e,t){return e.priority-t.priority}),t}function B(e,n){return function(o){return null!=o?(z(this,e,o),t.updateOffset(this,n),this):Y(this,e)}}function Y(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function z(e,t,n){e.isValid()&&e._d["set"+(e._isUTC?"UTC":"")+t](n)}function U(e){return e=j(e),_(this[e])?this[e]():this}function G(e,t){if("object"===(void 0===e?"undefined":s(e))){e=F(e);for(var n=V(e),o=0;o<n.length;o++)this[n[o].unit](e[n[o].unit])}else if(e=j(e),_(this[e]))return this[e](t);return this}function K(e,t,n){var o=""+Math.abs(e),i=t-o.length;return(e>=0?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+o}function X(e,t,n,o){var i=o;"string"==typeof o&&(i=function(){return this[o]()}),e&&(Io[e]=i),t&&(Io[t[0]]=function(){return K(i.apply(this,arguments),t[1],t[2])}),n&&(Io[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function q(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function $(e){var t,n,o=e.match(Wo);for(t=0,n=o.length;t<n;t++)Io[o[t]]?o[t]=Io[o[t]]:o[t]=q(o[t]);return function(t){var i,r="";for(i=0;i<n;i++)r+=_(o[i])?o[i].call(t,e):o[i];return r}}function Z(e,t){return e.isValid()?(t=Q(t,e.localeData()),Fo[t]=Fo[t]||$(t),Fo[t](e)):e.localeData().invalidDate()}function Q(e,t){function n(e){return t.longDateFormat(e)||e}var o=5;for(jo.lastIndex=0;o>=0&&jo.test(e);)e=e.replace(jo,n),jo.lastIndex=0,o-=1;return e}function J(e,t,n){ii[e]=_(t)?t:function(e,o){return e&&n?n:t}}function ee(e,t){return d(ii,e)?ii[e](t._strict,t._locale):new RegExp(te(e))}function te(e){return ne(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,o,i){return t||n||o||i}))}function ne(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function oe(e,t){var n,o=t;for("string"==typeof e&&(e=[e]),l(t)&&(o=function(e,n){n[t]=S(e)}),n=0;n<e.length;n++)ri[e[n]]=o}function ie(e,t){oe(e,function(e,n,o,i){o._w=o._w||{},t(e,o._w,o,i)})}function re(e,t,n){null!=t&&d(ri,e)&&ri[e](t,n._a,n,e)}function se(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}function ae(e,t){return e?o(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||mi).test(t)?"format":"standalone"][e.month()]:o(this._months)?this._months:this._months.standalone}function le(e,t){return e?o(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[mi.test(t)?"format":"standalone"][e.month()]:o(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function ue(e,t,n){var o,i,r,s=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],o=0;o<12;++o)r=f([2e3,o]),this._shortMonthsParse[o]=this.monthsShort(r,"").toLocaleLowerCase(),this._longMonthsParse[o]=this.months(r,"").toLocaleLowerCase();return n?"MMM"===t?(i=gi.call(this._shortMonthsParse,s),-1!==i?i:null):(i=gi.call(this._longMonthsParse,s),-1!==i?i:null):"MMM"===t?-1!==(i=gi.call(this._shortMonthsParse,s))?i:(i=gi.call(this._longMonthsParse,s),-1!==i?i:null):-1!==(i=gi.call(this._longMonthsParse,s))?i:(i=gi.call(this._shortMonthsParse,s),-1!==i?i:null)}function ce(e,t,n){var o,i,r;if(this._monthsParseExact)return ue.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),o=0;o<12;o++){if(i=f([2e3,o]),n&&!this._longMonthsParse[o]&&(this._longMonthsParse[o]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[o]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),n||this._monthsParse[o]||(r="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[o]=new RegExp(r.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[o].test(e))return o;if(n&&"MMM"===t&&this._shortMonthsParse[o].test(e))return o;if(!n&&this._monthsParse[o].test(e))return o}}function de(e,t){var n;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=S(t);else if(t=e.localeData().monthsParse(t),!l(t))return e;return n=Math.min(e.date(),se(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function he(e){return null!=e?(de(this,e),t.updateOffset(this,!0),this):Y(this,"Month")}function fe(){return se(this.year(),this.month())}function pe(e){return this._monthsParseExact?(d(this,"_monthsRegex")||me.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(d(this,"_monthsShortRegex")||(this._monthsShortRegex=yi),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function ge(e){return this._monthsParseExact?(d(this,"_monthsRegex")||me.call(this),e?this._monthsStrictRegex:this._monthsRegex):(d(this,"_monthsRegex")||(this._monthsRegex=Ci),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function me(){function e(e,t){return t.length-e.length}var t,n,o=[],i=[],r=[];for(t=0;t<12;t++)n=f([2e3,t]),o.push(this.monthsShort(n,"")),i.push(this.months(n,"")),r.push(this.months(n,"")),r.push(this.monthsShort(n,""));for(o.sort(e),i.sort(e),r.sort(e),t=0;t<12;t++)o[t]=ne(o[t]),i[t]=ne(i[t]);for(t=0;t<24;t++)r[t]=ne(r[t]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+o.join("|")+")","i")}function ve(e){return we(e)?366:365}function we(e){return e%4==0&&e%100!=0||e%400==0}function ye(){return we(this.year())}function Ce(e,t,n,o,i,r,s){var a=new Date(e,t,n,o,i,r,s);return e<100&&e>=0&&isFinite(a.getFullYear())&&a.setFullYear(e),a}function be(e){var t=new Date(Date.UTC.apply(null,arguments));return e<100&&e>=0&&isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e),t}function Se(e,t,n){var o=7+t-n;return-(7+be(e,0,o).getUTCDay()-t)%7+o-1}function Te(e,t,n,o,i){var r,s,a=(7+n-o)%7,l=Se(e,o,i),u=1+7*(t-1)+a+l;return u<=0?(r=e-1,s=ve(r)+u):u>ve(e)?(r=e+1,s=u-ve(e)):(r=e,s=u),{year:r,dayOfYear:s}}function Ee(e,t,n){var o,i,r=Se(e.year(),t,n),s=Math.floor((e.dayOfYear()-r-1)/7)+1;return s<1?(i=e.year()-1,o=s+Re(i,t,n)):s>Re(e.year(),t,n)?(o=s-Re(e.year(),t,n),i=e.year()+1):(i=e.year(),o=s),{week:o,year:i}}function Re(e,t,n){var o=Se(e,t,n),i=Se(e+1,t,n);return(ve(e)-o+i)/7}function Oe(e){return Ee(e,this._week.dow,this._week.doy).week}function _e(){return this._week.dow}function ke(){return this._week.doy}function Me(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")}function De(e){var t=Ee(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")}function He(e,t){return"string"!=typeof e?e:isNaN(e)?(e=t.weekdaysParse(e),"number"==typeof e?e:null):parseInt(e,10)}function xe(e,t){return"string"==typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function Ae(e,t){return e?o(this._weekdays)?this._weekdays[e.day()]:this._weekdays[this._weekdays.isFormat.test(t)?"format":"standalone"][e.day()]:o(this._weekdays)?this._weekdays:this._weekdays.standalone}function Pe(e){return e?this._weekdaysShort[e.day()]:this._weekdaysShort}function Ne(e){return e?this._weekdaysMin[e.day()]:this._weekdaysMin}function Le(e,t,n){var o,i,r,s=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],o=0;o<7;++o)r=f([2e3,1]).day(o),this._minWeekdaysParse[o]=this.weekdaysMin(r,"").toLocaleLowerCase(),this._shortWeekdaysParse[o]=this.weekdaysShort(r,"").toLocaleLowerCase(),this._weekdaysParse[o]=this.weekdays(r,"").toLocaleLowerCase();return n?"dddd"===t?(i=gi.call(this._weekdaysParse,s),-1!==i?i:null):"ddd"===t?(i=gi.call(this._shortWeekdaysParse,s),-1!==i?i:null):(i=gi.call(this._minWeekdaysParse,s),-1!==i?i:null):"dddd"===t?-1!==(i=gi.call(this._weekdaysParse,s))?i:-1!==(i=gi.call(this._shortWeekdaysParse,s))?i:(i=gi.call(this._minWeekdaysParse,s),-1!==i?i:null):"ddd"===t?-1!==(i=gi.call(this._shortWeekdaysParse,s))?i:-1!==(i=gi.call(this._weekdaysParse,s))?i:(i=gi.call(this._minWeekdaysParse,s),-1!==i?i:null):-1!==(i=gi.call(this._minWeekdaysParse,s))?i:-1!==(i=gi.call(this._weekdaysParse,s))?i:(i=gi.call(this._shortWeekdaysParse,s),-1!==i?i:null)}function We(e,t,n){var o,i,r;if(this._weekdaysParseExact)return Le.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),o=0;o<7;o++){if(i=f([2e3,1]).day(o),n&&!this._fullWeekdaysParse[o]&&(this._fullWeekdaysParse[o]=new RegExp("^"+this.weekdays(i,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[o]=new RegExp("^"+this.weekdaysShort(i,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[o]=new RegExp("^"+this.weekdaysMin(i,"").replace(".",".?")+"$","i")),this._weekdaysParse[o]||(r="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[o]=new RegExp(r.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[o].test(e))return o;if(n&&"ddd"===t&&this._shortWeekdaysParse[o].test(e))return o;if(n&&"dd"===t&&this._minWeekdaysParse[o].test(e))return o;if(!n&&this._weekdaysParse[o].test(e))return o}}function je(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=He(e,this.localeData()),this.add(e-t,"d")):t}function Fe(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")}function Ie(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=xe(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7}function Ve(e){return this._weekdaysParseExact?(d(this,"_weekdaysRegex")||ze.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(d(this,"_weekdaysRegex")||(this._weekdaysRegex=Oi),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function Be(e){return this._weekdaysParseExact?(d(this,"_weekdaysRegex")||ze.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(d(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=_i),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Ye(e){return this._weekdaysParseExact?(d(this,"_weekdaysRegex")||ze.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(d(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=ki),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function ze(){function e(e,t){return t.length-e.length}var t,n,o,i,r,s=[],a=[],l=[],u=[];for(t=0;t<7;t++)n=f([2e3,1]).day(t),o=this.weekdaysMin(n,""),i=this.weekdaysShort(n,""),r=this.weekdays(n,""),s.push(o),a.push(i),l.push(r),u.push(o),u.push(i),u.push(r);for(s.sort(e),a.sort(e),l.sort(e),u.sort(e),t=0;t<7;t++)a[t]=ne(a[t]),l[t]=ne(l[t]),u[t]=ne(u[t]);this._weekdaysRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+s.join("|")+")","i")}function Ue(){return this.hours()%12||12}function Ge(){return this.hours()||24}function Ke(e,t){X(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function Xe(e,t){return t._meridiemParse}function qe(e){return"p"===(e+"").toLowerCase().charAt(0)}function $e(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"}function Ze(e){return e?e.toLowerCase().replace("_","-"):e}function Qe(e){for(var t,n,o,i,r=0;r<e.length;){for(i=Ze(e[r]).split("-"),t=i.length,n=Ze(e[r+1]),n=n?n.split("-"):null;t>0;){if(o=Je(i.slice(0,t).join("-")))return o;if(n&&n.length>=t&&T(i,n,!0)>=t-1)break;t--}r++}return null}function Je(t){var o=null;if(!Ai[t]&&void 0!==e&&e&&e.exports)try{o=Mi._abbr,n(351)("./"+t),et(o)}catch(e){}return Ai[t]}function et(e,t){var n;return e&&(n=a(t)?ot(e):tt(e,t))&&(Mi=n),Mi._abbr}function tt(e,t){if(null!==t){var n=xi;if(t.abbr=e,null!=Ai[e])O("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Ai[e]._config;else if(null!=t.parentLocale){if(null==Ai[t.parentLocale])return Pi[t.parentLocale]||(Pi[t.parentLocale]=[]),Pi[t.parentLocale].push({name:e,config:t}),null;n=Ai[t.parentLocale]._config}return Ai[e]=new D(M(n,t)),Pi[e]&&Pi[e].forEach(function(e){tt(e.name,e.config)}),et(e),Ai[e]}return delete Ai[e],null}function nt(e,t){if(null!=t){var n,o=xi;null!=Ai[e]&&(o=Ai[e]._config),t=M(o,t),n=new D(t),n.parentLocale=Ai[e],Ai[e]=n,et(e)}else null!=Ai[e]&&(null!=Ai[e].parentLocale?Ai[e]=Ai[e].parentLocale:null!=Ai[e]&&delete Ai[e]);return Ai[e]}function ot(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Mi;if(!o(e)){if(t=Je(e))return t;e=[e]}return Qe(e)}function it(){return Do(Ai)}function rt(e){var t,n=e._a;return n&&-2===g(e).overflow&&(t=n[ai]<0||n[ai]>11?ai:n[li]<1||n[li]>se(n[si],n[ai])?li:n[ui]<0||n[ui]>24||24===n[ui]&&(0!==n[ci]||0!==n[di]||0!==n[hi])?ui:n[ci]<0||n[ci]>59?ci:n[di]<0||n[di]>59?di:n[hi]<0||n[hi]>999?hi:-1,g(e)._overflowDayOfYear&&(t<si||t>li)&&(t=li),g(e)._overflowWeeks&&-1===t&&(t=fi),g(e)._overflowWeekday&&-1===t&&(t=pi),g(e).overflow=t),e}function st(e){var t,n,o,i,r,s,a=e._i,l=Ni.exec(a)||Li.exec(a);if(l){for(g(e).iso=!0,t=0,n=ji.length;t<n;t++)if(ji[t][1].exec(l[1])){i=ji[t][0],o=!1!==ji[t][2];break}if(null==i)return void(e._isValid=!1);if(l[3]){for(t=0,n=Fi.length;t<n;t++)if(Fi[t][1].exec(l[3])){r=(l[2]||" ")+Fi[t][0];break}if(null==r)return void(e._isValid=!1)}if(!o&&null!=r)return void(e._isValid=!1);if(l[4]){if(!Wi.exec(l[4]))return void(e._isValid=!1);s="Z"}e._f=i+(r||"")+(s||""),ft(e)}else e._isValid=!1}function at(e){var t,n,o,i,r,s,a,l,u={" GMT":" +0000"," EDT":" -0400"," EST":" -0500"," CDT":" -0500"," CST":" -0600"," MDT":" -0600"," MST":" -0700"," PDT":" -0700"," PST":" -0800"},c="YXWVUTSRQPONZABCDEFGHIKLM";if(t=e._i.replace(/\([^\)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s|\s$/g,""),n=Vi.exec(t)){if(o=n[1]?"ddd"+(5===n[1].length?", ":" "):"",i="D MMM "+(n[2].length>10?"YYYY ":"YY "),r="HH:mm"+(n[4]?":ss":""),n[1]){var d=new Date(n[2]),h=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][d.getDay()];if(n[1].substr(0,3)!==h)return g(e).weekdayMismatch=!0,void(e._isValid=!1)}switch(n[5].length){case 2:0===l?a=" +0000":(l=c.indexOf(n[5][1].toUpperCase())-12,a=(l<0?" -":" +")+(""+l).replace(/^-?/,"0").match(/..$/)[0]+"00");break;case 4:a=u[n[5]];break;default:a=u[" GMT"]}n[5]=a,e._i=n.splice(1).join(""),s=" ZZ",e._f=o+i+r+s,ft(e),g(e).rfc2822=!0}else e._isValid=!1}function lt(e){var n=Ii.exec(e._i);if(null!==n)return void(e._d=new Date(+n[1]));st(e),!1===e._isValid&&(delete e._isValid,at(e),!1===e._isValid&&(delete e._isValid,t.createFromInputFallback(e)))}function ut(e,t,n){return null!=e?e:null!=t?t:n}function ct(e){var n=new Date(t.now());return e._useUTC?[n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()]:[n.getFullYear(),n.getMonth(),n.getDate()]}function dt(e){var t,n,o,i,r=[];if(!e._d){for(o=ct(e),e._w&&null==e._a[li]&&null==e._a[ai]&&ht(e),null!=e._dayOfYear&&(i=ut(e._a[si],o[si]),(e._dayOfYear>ve(i)||0===e._dayOfYear)&&(g(e)._overflowDayOfYear=!0),n=be(i,0,e._dayOfYear),e._a[ai]=n.getUTCMonth(),e._a[li]=n.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=r[t]=o[t];for(;t<7;t++)e._a[t]=r[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[ui]&&0===e._a[ci]&&0===e._a[di]&&0===e._a[hi]&&(e._nextDay=!0,e._a[ui]=0),e._d=(e._useUTC?be:Ce).apply(null,r),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[ui]=24)}}function ht(e){var t,n,o,i,r,s,a,l;if(t=e._w,null!=t.GG||null!=t.W||null!=t.E)r=1,s=4,n=ut(t.GG,e._a[si],Ee(bt(),1,4).year),o=ut(t.W,1),((i=ut(t.E,1))<1||i>7)&&(l=!0);else{r=e._locale._week.dow,s=e._locale._week.doy;var u=Ee(bt(),r,s);n=ut(t.gg,e._a[si],u.year),o=ut(t.w,u.week),null!=t.d?((i=t.d)<0||i>6)&&(l=!0):null!=t.e?(i=t.e+r,(t.e<0||t.e>6)&&(l=!0)):i=r}o<1||o>Re(n,r,s)?g(e)._overflowWeeks=!0:null!=l?g(e)._overflowWeekday=!0:(a=Te(n,o,i,r,s),e._a[si]=a.year,e._dayOfYear=a.dayOfYear)}function ft(e){if(e._f===t.ISO_8601)return void st(e);if(e._f===t.RFC_2822)return void at(e);e._a=[],g(e).empty=!0;var n,o,i,r,s,a=""+e._i,l=a.length,u=0;for(i=Q(e._f,e._locale).match(Wo)||[],n=0;n<i.length;n++)r=i[n],o=(a.match(ee(r,e))||[])[0],o&&(s=a.substr(0,a.indexOf(o)),s.length>0&&g(e).unusedInput.push(s),a=a.slice(a.indexOf(o)+o.length),u+=o.length),Io[r]?(o?g(e).empty=!1:g(e).unusedTokens.push(r),re(r,o,e)):e._strict&&!o&&g(e).unusedTokens.push(r);g(e).charsLeftOver=l-u,a.length>0&&g(e).unusedInput.push(a),e._a[ui]<=12&&!0===g(e).bigHour&&e._a[ui]>0&&(g(e).bigHour=void 0),g(e).parsedDateParts=e._a.slice(0),g(e).meridiem=e._meridiem,e._a[ui]=pt(e._locale,e._a[ui],e._meridiem),dt(e),rt(e)}function pt(e,t,n){var o;return null==n?t:null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?(o=e.isPM(n),o&&t<12&&(t+=12),o||12!==t||(t=0),t):t}function gt(e){var t,n,o,i,r;if(0===e._f.length)return g(e).invalidFormat=!0,void(e._d=new Date(NaN));for(i=0;i<e._f.length;i++)r=0,t=w({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[i],ft(t),m(t)&&(r+=g(t).charsLeftOver,r+=10*g(t).unusedTokens.length,g(t).score=r,(null==o||r<o)&&(o=r,n=t));h(e,n||t)}function mt(e){if(!e._d){var t=F(e._i);e._a=c([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)}),dt(e)}}function vt(e){var t=new y(rt(wt(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function wt(e){var t=e._i,n=e._f;return e._locale=e._locale||ot(e._l),null===t||void 0===n&&""===t?v({nullInput:!0}):("string"==typeof t&&(e._i=t=e._locale.preparse(t)),C(t)?new y(rt(t)):(u(t)?e._d=t:o(n)?gt(e):n?ft(e):yt(e),m(e)||(e._d=null),e))}function yt(e){var n=e._i;a(n)?e._d=new Date(t.now()):u(n)?e._d=new Date(n.valueOf()):"string"==typeof n?lt(e):o(n)?(e._a=c(n.slice(0),function(e){return parseInt(e,10)}),dt(e)):i(n)?mt(e):l(n)?e._d=new Date(n):t.createFromInputFallback(e)}function Ct(e,t,n,s,a){var l={};return!0!==n&&!1!==n||(s=n,n=void 0),(i(e)&&r(e)||o(e)&&0===e.length)&&(e=void 0),l._isAMomentObject=!0,l._useUTC=l._isUTC=a,l._l=n,l._i=e,l._f=t,l._strict=s,vt(l)}function bt(e,t,n,o){return Ct(e,t,n,o,!1)}function St(e,t){var n,i;if(1===t.length&&o(t[0])&&(t=t[0]),!t.length)return bt();for(n=t[0],i=1;i<t.length;++i)t[i].isValid()&&!t[i][e](n)||(n=t[i]);return n}function Tt(){return St("isBefore",[].slice.call(arguments,0))}function Et(){return St("isAfter",[].slice.call(arguments,0))}function Rt(e){for(var t in e)if(-1===Ui.indexOf(t)||null!=e[t]&&isNaN(e[t]))return!1;for(var n=!1,o=0;o<Ui.length;++o)if(e[Ui[o]]){if(n)return!1;parseFloat(e[Ui[o]])!==S(e[Ui[o]])&&(n=!0)}return!0}function Ot(){return this._isValid}function _t(){return Gt(NaN)}function kt(e){var t=F(e),n=t.year||0,o=t.quarter||0,i=t.month||0,r=t.week||0,s=t.day||0,a=t.hour||0,l=t.minute||0,u=t.second||0,c=t.millisecond||0;this._isValid=Rt(t),this._milliseconds=+c+1e3*u+6e4*l+1e3*a*60*60,this._days=+s+7*r,this._months=+i+3*o+12*n,this._data={},this._locale=ot(),this._bubble()}function Mt(e){return e instanceof kt}function Dt(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function Ht(e,t){X(e,0,0,function(){var e=this.utcOffset(),n="+";return e<0&&(e=-e,n="-"),n+K(~~(e/60),2)+t+K(~~e%60,2)})}function xt(e,t){var n=(t||"").match(e);if(null===n)return null;var o=n[n.length-1]||[],i=(o+"").match(Gi)||["-",0,0],r=60*i[1]+S(i[2]);return 0===r?0:"+"===i[0]?r:-r}function At(e,n){var o,i;return n._isUTC?(o=n.clone(),i=(C(e)||u(e)?e.valueOf():bt(e).valueOf())-o.valueOf(),o._d.setTime(o._d.valueOf()+i),t.updateOffset(o,!1),o):bt(e).local()}function Pt(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function Nt(e,n,o){var i,r=this._offset||0;if(!this.isValid())return null!=e?this:NaN;if(null!=e){if("string"==typeof e){if(null===(e=xt(ti,e)))return this}else Math.abs(e)<16&&!o&&(e*=60);return!this._isUTC&&n&&(i=Pt(this)),this._offset=e,this._isUTC=!0,null!=i&&this.add(i,"m"),r!==e&&(!n||this._changeInProgress?Zt(this,Gt(e-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,t.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?r:Pt(this)}function Lt(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function Wt(e){return this.utcOffset(0,e)}function jt(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Pt(this),"m")),this}function Ft(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=xt(ei,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this}function It(e){return!!this.isValid()&&(e=e?bt(e).utcOffset():0,(this.utcOffset()-e)%60==0)}function Vt(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function Bt(){if(!a(this._isDSTShifted))return this._isDSTShifted;var e={};if(w(e,this),e=wt(e),e._a){var t=e._isUTC?f(e._a):bt(e._a);this._isDSTShifted=this.isValid()&&T(e._a,t.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function Yt(){return!!this.isValid()&&!this._isUTC}function zt(){return!!this.isValid()&&this._isUTC}function Ut(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}function Gt(e,t){var n,o,i,r=e,a=null;return Mt(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:l(e)?(r={},t?r[t]=e:r.milliseconds=e):(a=Ki.exec(e))?(n="-"===a[1]?-1:1,r={y:0,d:S(a[li])*n,h:S(a[ui])*n,m:S(a[ci])*n,s:S(a[di])*n,ms:S(Dt(1e3*a[hi]))*n}):(a=Xi.exec(e))?(n="-"===a[1]?-1:1,r={y:Kt(a[2],n),M:Kt(a[3],n),w:Kt(a[4],n),d:Kt(a[5],n),h:Kt(a[6],n),m:Kt(a[7],n),s:Kt(a[8],n)}):null==r?r={}:"object"===(void 0===r?"undefined":s(r))&&("from"in r||"to"in r)&&(i=qt(bt(r.from),bt(r.to)),r={},r.ms=i.milliseconds,r.M=i.months),o=new kt(r),Mt(e)&&d(e,"_locale")&&(o._locale=e._locale),o}function Kt(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function Xt(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function qt(e,t){var n;return e.isValid()&&t.isValid()?(t=At(t,e),e.isBefore(t)?n=Xt(e,t):(n=Xt(t,e),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function $t(e,t){return function(n,o){var i,r;return null===o||isNaN(+o)||(O(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),r=n,n=o,o=r),n="string"==typeof n?+n:n,i=Gt(n,o),Zt(this,i,e),this}}function Zt(e,n,o,i){var r=n._milliseconds,s=Dt(n._days),a=Dt(n._months);e.isValid()&&(i=null==i||i,r&&e._d.setTime(e._d.valueOf()+r*o),s&&z(e,"Date",Y(e,"Date")+s*o),a&&de(e,Y(e,"Month")+a*o),i&&t.updateOffset(e,s||a))}function Qt(e,t){var n=e.diff(t,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function Jt(e,n){var o=e||bt(),i=At(o,this).startOf("day"),r=t.calendarFormat(this,i)||"sameElse",s=n&&(_(n[r])?n[r].call(this,o):n[r]);return this.format(s||this.localeData().calendar(r,this,bt(o)))}function en(){return new y(this)}function tn(e,t){var n=C(e)?e:bt(e);return!(!this.isValid()||!n.isValid())&&(t=j(a(t)?"millisecond":t),"millisecond"===t?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf())}function nn(e,t){var n=C(e)?e:bt(e);return!(!this.isValid()||!n.isValid())&&(t=j(a(t)?"millisecond":t),"millisecond"===t?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf())}function on(e,t,n,o){return o=o||"()",("("===o[0]?this.isAfter(e,n):!this.isBefore(e,n))&&(")"===o[1]?this.isBefore(t,n):!this.isAfter(t,n))}function rn(e,t){var n,o=C(e)?e:bt(e);return!(!this.isValid()||!o.isValid())&&(t=j(t||"millisecond"),"millisecond"===t?this.valueOf()===o.valueOf():(n=o.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()))}function sn(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function an(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function ln(e,t,n){var o,i,r,s;return this.isValid()?(o=At(e,this),o.isValid()?(i=6e4*(o.utcOffset()-this.utcOffset()),t=j(t),"year"===t||"month"===t||"quarter"===t?(s=un(this,o),"quarter"===t?s/=3:"year"===t&&(s/=12)):(r=this-o,s="second"===t?r/1e3:"minute"===t?r/6e4:"hour"===t?r/36e5:"day"===t?(r-i)/864e5:"week"===t?(r-i)/6048e5:r),n?s:b(s)):NaN):NaN}function un(e,t){var n,o,i=12*(t.year()-e.year())+(t.month()-e.month()),r=e.clone().add(i,"months");return t-r<0?(n=e.clone().add(i-1,"months"),o=(t-r)/(r-n)):(n=e.clone().add(i+1,"months"),o=(t-r)/(n-r)),-(i+o)||0}function cn(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function dn(){if(!this.isValid())return null;var e=this.clone().utc();return e.year()<0||e.year()>9999?Z(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):_(Date.prototype.toISOString)?this.toDate().toISOString():Z(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function hn(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="";this.isLocal()||(e=0===this.utcOffset()?"moment.utc":"moment.parseZone",t="Z");var n="["+e+'("]',o=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i=t+'[")]';return this.format(n+o+"-MM-DD[T]HH:mm:ss.SSS"+i)}function fn(e){e||(e=this.isUtc()?t.defaultFormatUtc:t.defaultFormat);var n=Z(this,e);return this.localeData().postformat(n)}function pn(e,t){return this.isValid()&&(C(e)&&e.isValid()||bt(e).isValid())?Gt({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function gn(e){return this.from(bt(),e)}function mn(e,t){return this.isValid()&&(C(e)&&e.isValid()||bt(e).isValid())?Gt({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function vn(e){return this.to(bt(),e)}function wn(e){var t;return void 0===e?this._locale._abbr:(t=ot(e),null!=t&&(this._locale=t),this)}function yn(){return this._locale}function Cn(e){switch(e=j(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this}function bn(e){return void 0===(e=j(e))||"millisecond"===e?this:("date"===e&&(e="day"),this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms"))}function Sn(){return this._d.valueOf()-6e4*(this._offset||0)}function Tn(){return Math.floor(this.valueOf()/1e3)}function En(){return new Date(this.valueOf())}function Rn(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function On(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function _n(){return this.isValid()?this.toISOString():null}function kn(){return m(this)}function Mn(){return h({},g(this))}function Dn(){return g(this).overflow}function Hn(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function xn(e,t){X(0,[e,e.length],0,t)}function An(e){return Wn.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Pn(e){return Wn.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function Nn(){return Re(this.year(),1,4)}function Ln(){var e=this.localeData()._week;return Re(this.year(),e.dow,e.doy)}function Wn(e,t,n,o,i){var r;return null==e?Ee(this,o,i).year:(r=Re(e,o,i),t>r&&(t=r),jn.call(this,e,t,n,o,i))}function jn(e,t,n,o,i){var r=Te(e,t,n,o,i),s=be(r.year,0,r.dayOfYear);return this.year(s.getUTCFullYear()),this.month(s.getUTCMonth()),this.date(s.getUTCDate()),this}function Fn(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)}function In(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")}function Vn(e,t){t[hi]=S(1e3*("0."+e))}function Bn(){return this._isUTC?"UTC":""}function Yn(){return this._isUTC?"Coordinated Universal Time":""}function zn(e){return bt(1e3*e)}function Un(){return bt.apply(null,arguments).parseZone()}function Gn(e){return e}function Kn(e,t,n,o){var i=ot(),r=f().set(o,t);return i[n](r,e)}function Xn(e,t,n){if(l(e)&&(t=e,e=void 0),e=e||"",null!=t)return Kn(e,t,n,"month");var o,i=[];for(o=0;o<12;o++)i[o]=Kn(e,o,n,"month");return i}function qn(e,t,n,o){"boolean"==typeof e?(l(t)&&(n=t,t=void 0),t=t||""):(t=e,n=t,e=!1,l(t)&&(n=t,t=void 0),t=t||"");var i=ot(),r=e?i._week.dow:0;if(null!=n)return Kn(t,(n+r)%7,o,"day");var s,a=[];for(s=0;s<7;s++)a[s]=Kn(t,(s+r)%7,o,"day");return a}function $n(e,t){return Xn(e,t,"months")}function Zn(e,t){return Xn(e,t,"monthsShort")}function Qn(e,t,n){return qn(e,t,n,"weekdays")}function Jn(e,t,n){return qn(e,t,n,"weekdaysShort")}function eo(e,t,n){return qn(e,t,n,"weekdaysMin")}function to(){var e=this._data;return this._milliseconds=rr(this._milliseconds),this._days=rr(this._days),this._months=rr(this._months),e.milliseconds=rr(e.milliseconds),e.seconds=rr(e.seconds),e.minutes=rr(e.minutes),e.hours=rr(e.hours),e.months=rr(e.months),e.years=rr(e.years),this}function no(e,t,n,o){var i=Gt(t,n);return e._milliseconds+=o*i._milliseconds,e._days+=o*i._days,e._months+=o*i._months,e._bubble()}function oo(e,t){return no(this,e,t,1)}function io(e,t){return no(this,e,t,-1)}function ro(e){return e<0?Math.floor(e):Math.ceil(e)}function so(){var e,t,n,o,i,r=this._milliseconds,s=this._days,a=this._months,l=this._data;return r>=0&&s>=0&&a>=0||r<=0&&s<=0&&a<=0||(r+=864e5*ro(lo(a)+s),s=0,a=0),l.milliseconds=r%1e3,e=b(r/1e3),l.seconds=e%60,t=b(e/60),l.minutes=t%60,n=b(t/60),l.hours=n%24,s+=b(n/24),i=b(ao(s)),a+=i,s-=ro(lo(i)),o=b(a/12),a%=12,l.days=s,l.months=a,l.years=o,this}function ao(e){return 4800*e/146097}function lo(e){return 146097*e/4800}function uo(e){if(!this.isValid())return NaN;var t,n,o=this._milliseconds;if("month"===(e=j(e))||"year"===e)return t=this._days+o/864e5,n=this._months+ao(t),"month"===e?n:n/12;switch(t=this._days+Math.round(lo(this._months)),e){case"week":return t/7+o/6048e5;case"day":return t+o/864e5;case"hour":return 24*t+o/36e5;case"minute":return 1440*t+o/6e4;case"second":return 86400*t+o/1e3;case"millisecond":return Math.floor(864e5*t)+o;default:throw new Error("Unknown unit "+e)}}function co(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*S(this._months/12):NaN}function ho(e){return function(){return this.as(e)}}function fo(e){return e=j(e),this.isValid()?this[e+"s"]():NaN}function po(e){return function(){return this.isValid()?this._data[e]:NaN}}function go(){return b(this.days()/7)}function mo(e,t,n,o,i){return i.relativeTime(t||1,!!n,e,o)}function vo(e,t,n){var o=Gt(e).abs(),i=br(o.as("s")),r=br(o.as("m")),s=br(o.as("h")),a=br(o.as("d")),l=br(o.as("M")),u=br(o.as("y")),c=i<=Sr.ss&&["s",i]||i<Sr.s&&["ss",i]||r<=1&&["m"]||r<Sr.m&&["mm",r]||s<=1&&["h"]||s<Sr.h&&["hh",s]||a<=1&&["d"]||a<Sr.d&&["dd",a]||l<=1&&["M"]||l<Sr.M&&["MM",l]||u<=1&&["y"]||["yy",u];return c[2]=t,c[3]=+e>0,c[4]=n,mo.apply(null,c)}function wo(e){return void 0===e?br:"function"==typeof e&&(br=e,!0)}function yo(e,t){return void 0!==Sr[e]&&(void 0===t?Sr[e]:(Sr[e]=t,"s"===e&&(Sr.ss=t-1),!0))}function Co(e){if(!this.isValid())return this.localeData().invalidDate();var t=this.localeData(),n=vo(this,!e,t);return e&&(n=t.pastFuture(+this,n)),t.postformat(n)}function bo(){if(!this.isValid())return this.localeData().invalidDate();var e,t,n,o=Tr(this._milliseconds)/1e3,i=Tr(this._days),r=Tr(this._months);e=b(o/60),t=b(e/60),o%=60,e%=60,n=b(r/12),r%=12;var s=n,a=r,l=i,u=t,c=e,d=o,h=this.asSeconds();return h?(h<0?"-":"")+"P"+(s?s+"Y":"")+(a?a+"M":"")+(l?l+"D":"")+(u||c||d?"T":"")+(u?u+"H":"")+(c?c+"M":"")+(d?d+"S":""):"P0D"}var So,To;To=Array.prototype.some?Array.prototype.some:function(e){for(var t=Object(this),n=t.length>>>0,o=0;o<n;o++)if(o in t&&e.call(this,t[o],o,t))return!0;return!1};var Eo=To,Ro=t.momentProperties=[],Oo=!1,_o={};t.suppressDeprecationWarnings=!1,t.deprecationHandler=null;var ko;ko=Object.keys?Object.keys:function(e){var t,n=[];for(t in e)d(e,t)&&n.push(t);return n};var Mo,Do=ko,Ho={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},xo={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},Ao=/\d{1,2}/,Po={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},No={},Lo={},Wo=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,jo=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Fo={},Io={},Vo=/\d/,Bo=/\d\d/,Yo=/\d{3}/,zo=/\d{4}/,Uo=/[+-]?\d{6}/,Go=/\d\d?/,Ko=/\d\d\d\d?/,Xo=/\d\d\d\d\d\d?/,qo=/\d{1,3}/,$o=/\d{1,4}/,Zo=/[+-]?\d{1,6}/,Qo=/\d+/,Jo=/[+-]?\d+/,ei=/Z|[+-]\d\d:?\d\d/gi,ti=/Z|[+-]\d\d(?::?\d\d)?/gi,ni=/[+-]?\d+(\.\d{1,3})?/,oi=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,ii={},ri={},si=0,ai=1,li=2,ui=3,ci=4,di=5,hi=6,fi=7,pi=8;Mo=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};var gi=Mo;X("M",["MM",2],"Mo",function(){return this.month()+1}),X("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),X("MMMM",0,0,function(e){return this.localeData().months(this,e)}),W("month","M"),I("month",8),J("M",Go),J("MM",Go,Bo),J("MMM",function(e,t){return t.monthsShortRegex(e)}),J("MMMM",function(e,t){return t.monthsRegex(e)}),oe(["M","MM"],function(e,t){t[ai]=S(e)-1}),oe(["MMM","MMMM"],function(e,t,n,o){var i=n._locale.monthsParse(e,o,n._strict);null!=i?t[ai]=i:g(n).invalidMonth=e});var mi=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,vi="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),wi="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),yi=oi,Ci=oi;X("Y",0,0,function(){var e=this.year();return e<=9999?""+e:"+"+e}),X(0,["YY",2],0,function(){return this.year()%100}),X(0,["YYYY",4],0,"year"),X(0,["YYYYY",5],0,"year"),X(0,["YYYYYY",6,!0],0,"year"),W("year","y"),I("year",1),J("Y",Jo),J("YY",Go,Bo),J("YYYY",$o,zo),J("YYYYY",Zo,Uo),J("YYYYYY",Zo,Uo),oe(["YYYYY","YYYYYY"],si),oe("YYYY",function(e,n){n[si]=2===e.length?t.parseTwoDigitYear(e):S(e)}),oe("YY",function(e,n){n[si]=t.parseTwoDigitYear(e)}),oe("Y",function(e,t){t[si]=parseInt(e,10)}),t.parseTwoDigitYear=function(e){return S(e)+(S(e)>68?1900:2e3)};var bi=B("FullYear",!0);X("w",["ww",2],"wo","week"),X("W",["WW",2],"Wo","isoWeek"),W("week","w"),W("isoWeek","W"),I("week",5),I("isoWeek",5),J("w",Go),J("ww",Go,Bo),J("W",Go),J("WW",Go,Bo),ie(["w","ww","W","WW"],function(e,t,n,o){t[o.substr(0,1)]=S(e)});var Si={dow:0,doy:6};X("d",0,"do","day"),X("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),X("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),X("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),X("e",0,0,"weekday"),X("E",0,0,"isoWeekday"),W("day","d"),W("weekday","e"),W("isoWeekday","E"),I("day",11),I("weekday",11),I("isoWeekday",11),J("d",Go),J("e",Go),J("E",Go),J("dd",function(e,t){return t.weekdaysMinRegex(e)}),J("ddd",function(e,t){return t.weekdaysShortRegex(e)}),J("dddd",function(e,t){return t.weekdaysRegex(e)}),ie(["dd","ddd","dddd"],function(e,t,n,o){var i=n._locale.weekdaysParse(e,o,n._strict);null!=i?t.d=i:g(n).invalidWeekday=e}),ie(["d","e","E"],function(e,t,n,o){t[o]=S(e)});var Ti="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Ei="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Ri="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Oi=oi,_i=oi,ki=oi;X("H",["HH",2],0,"hour"),X("h",["hh",2],0,Ue),X("k",["kk",2],0,Ge),X("hmm",0,0,function(){return""+Ue.apply(this)+K(this.minutes(),2)}),X("hmmss",0,0,function(){return""+Ue.apply(this)+K(this.minutes(),2)+K(this.seconds(),2)}),X("Hmm",0,0,function(){return""+this.hours()+K(this.minutes(),2)}),X("Hmmss",0,0,function(){return""+this.hours()+K(this.minutes(),2)+K(this.seconds(),2)}),Ke("a",!0),Ke("A",!1),W("hour","h"),I("hour",13),J("a",Xe),J("A",Xe),J("H",Go),J("h",Go),J("k",Go),J("HH",Go,Bo),J("hh",Go,Bo),J("kk",Go,Bo),J("hmm",Ko),J("hmmss",Xo),J("Hmm",Ko),J("Hmmss",Xo),oe(["H","HH"],ui),oe(["k","kk"],function(e,t,n){var o=S(e);t[ui]=24===o?0:o}),oe(["a","A"],function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e}),oe(["h","hh"],function(e,t,n){t[ui]=S(e),g(n).bigHour=!0}),oe("hmm",function(e,t,n){var o=e.length-2;t[ui]=S(e.substr(0,o)),t[ci]=S(e.substr(o)),g(n).bigHour=!0}),oe("hmmss",function(e,t,n){var o=e.length-4,i=e.length-2;t[ui]=S(e.substr(0,o)),t[ci]=S(e.substr(o,2)),t[di]=S(e.substr(i)),g(n).bigHour=!0}),oe("Hmm",function(e,t,n){var o=e.length-2;t[ui]=S(e.substr(0,o)),t[ci]=S(e.substr(o))}),oe("Hmmss",function(e,t,n){var o=e.length-4,i=e.length-2;t[ui]=S(e.substr(0,o)),t[ci]=S(e.substr(o,2)),t[di]=S(e.substr(i))});var Mi,Di=/[ap]\.?m?\.?/i,Hi=B("Hours",!0),xi={calendar:Ho,longDateFormat:xo,invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:Ao,relativeTime:Po,months:vi,monthsShort:wi,week:Si,weekdays:Ti,weekdaysMin:Ri,weekdaysShort:Ei,meridiemParse:Di},Ai={},Pi={},Ni=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Li=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Wi=/Z|[+-]\d\d(?::?\d\d)?/,ji=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],Fi=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Ii=/^\/?Date\((\-?\d+)/i,Vi=/^((?:Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d?\d\s(?:Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(?:\d\d)?\d\d\s)(\d\d:\d\d)(\:\d\d)?(\s(?:UT|GMT|[ECMP][SD]T|[A-IK-Za-ik-z]|[+-]\d{4}))$/;t.createFromInputFallback=R("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),t.ISO_8601=function(){},t.RFC_2822=function(){};var Bi=R("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=bt.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:v()}),Yi=R("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=bt.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:v()}),zi=function(){return Date.now?Date.now():+new Date},Ui=["year","quarter","month","week","day","hour","minute","second","millisecond"];Ht("Z",":"),Ht("ZZ",""),J("Z",ti),J("ZZ",ti),oe(["Z","ZZ"],function(e,t,n){n._useUTC=!0,n._tzm=xt(ti,e)});var Gi=/([\+\-]|\d\d)/gi;t.updateOffset=function(){};var Ki=/^(\-)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,Xi=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/;Gt.fn=kt.prototype,Gt.invalid=_t;var qi=$t(1,"add"),$i=$t(-1,"subtract");t.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",t.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var Zi=R("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});X(0,["gg",2],0,function(){return this.weekYear()%100}),X(0,["GG",2],0,function(){return this.isoWeekYear()%100}),xn("gggg","weekYear"),xn("ggggg","weekYear"),xn("GGGG","isoWeekYear"),xn("GGGGG","isoWeekYear"),W("weekYear","gg"),W("isoWeekYear","GG"),I("weekYear",1),I("isoWeekYear",1),J("G",Jo),J("g",Jo),J("GG",Go,Bo),J("gg",Go,Bo),J("GGGG",$o,zo),J("gggg",$o,zo),J("GGGGG",Zo,Uo),J("ggggg",Zo,Uo),ie(["gggg","ggggg","GGGG","GGGGG"],function(e,t,n,o){t[o.substr(0,2)]=S(e)}),ie(["gg","GG"],function(e,n,o,i){n[i]=t.parseTwoDigitYear(e)}),X("Q",0,"Qo","quarter"),W("quarter","Q"),I("quarter",7),J("Q",Vo),oe("Q",function(e,t){t[ai]=3*(S(e)-1)}),X("D",["DD",2],"Do","date"),W("date","D"),I("date",9),J("D",Go),J("DD",Go,Bo),J("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient}),oe(["D","DD"],li),oe("Do",function(e,t){t[li]=S(e.match(Go)[0],10)});var Qi=B("Date",!0);X("DDD",["DDDD",3],"DDDo","dayOfYear"),W("dayOfYear","DDD"),I("dayOfYear",4),J("DDD",qo),J("DDDD",Yo),oe(["DDD","DDDD"],function(e,t,n){n._dayOfYear=S(e)}),X("m",["mm",2],0,"minute"),W("minute","m"),I("minute",14),J("m",Go),J("mm",Go,Bo),oe(["m","mm"],ci);var Ji=B("Minutes",!1);X("s",["ss",2],0,"second"),W("second","s"),I("second",15),J("s",Go),J("ss",Go,Bo),oe(["s","ss"],di);var er=B("Seconds",!1);X("S",0,0,function(){return~~(this.millisecond()/100)}),X(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),X(0,["SSS",3],0,"millisecond"),X(0,["SSSS",4],0,function(){return 10*this.millisecond()}),X(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),X(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),X(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),X(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),X(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),W("millisecond","ms"),I("millisecond",16),J("S",qo,Vo),J("SS",qo,Bo),J("SSS",qo,Yo);var tr;for(tr="SSSS";tr.length<=9;tr+="S")J(tr,Qo);for(tr="S";tr.length<=9;tr+="S")oe(tr,Vn);var nr=B("Milliseconds",!1);X("z",0,0,"zoneAbbr"),X("zz",0,0,"zoneName");var or=y.prototype;or.add=qi,or.calendar=Jt,or.clone=en,or.diff=ln,or.endOf=bn,or.format=fn,or.from=pn,or.fromNow=gn,or.to=mn,or.toNow=vn,or.get=U,or.invalidAt=Dn,or.isAfter=tn,or.isBefore=nn,or.isBetween=on,or.isSame=rn,or.isSameOrAfter=sn,or.isSameOrBefore=an,or.isValid=kn,or.lang=Zi,or.locale=wn,or.localeData=yn,or.max=Yi,or.min=Bi,or.parsingFlags=Mn,or.set=G,or.startOf=Cn,or.subtract=$i,or.toArray=Rn,or.toObject=On,or.toDate=En,or.toISOString=dn,or.inspect=hn,or.toJSON=_n,or.toString=cn,or.unix=Tn,or.valueOf=Sn,or.creationData=Hn,or.year=bi,or.isLeapYear=ye,or.weekYear=An,or.isoWeekYear=Pn,or.quarter=or.quarters=Fn,or.month=he,or.daysInMonth=fe,or.week=or.weeks=Me,or.isoWeek=or.isoWeeks=De,or.weeksInYear=Ln,or.isoWeeksInYear=Nn,or.date=Qi,or.day=or.days=je,or.weekday=Fe,or.isoWeekday=Ie,or.dayOfYear=In,or.hour=or.hours=Hi,or.minute=or.minutes=Ji,or.second=or.seconds=er,or.millisecond=or.milliseconds=nr,or.utcOffset=Nt,or.utc=Wt,or.local=jt,or.parseZone=Ft,or.hasAlignedHourOffset=It,or.isDST=Vt,or.isLocal=Yt,or.isUtcOffset=zt,or.isUtc=Ut,or.isUTC=Ut,or.zoneAbbr=Bn,or.zoneName=Yn,or.dates=R("dates accessor is deprecated. Use date instead.",Qi),or.months=R("months accessor is deprecated. Use month instead",he),or.years=R("years accessor is deprecated. Use year instead",bi),or.zone=R("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Lt),or.isDSTShifted=R("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",Bt);var ir=D.prototype;ir.calendar=H,ir.longDateFormat=x,ir.invalidDate=A,ir.ordinal=P,ir.preparse=Gn,ir.postformat=Gn,ir.relativeTime=N,ir.pastFuture=L,ir.set=k,ir.months=ae,ir.monthsShort=le,ir.monthsParse=ce,ir.monthsRegex=ge,ir.monthsShortRegex=pe,ir.week=Oe,ir.firstDayOfYear=ke,ir.firstDayOfWeek=_e,ir.weekdays=Ae,ir.weekdaysMin=Ne,ir.weekdaysShort=Pe,ir.weekdaysParse=We,ir.weekdaysRegex=Ve,ir.weekdaysShortRegex=Be,ir.weekdaysMinRegex=Ye,ir.isPM=qe,ir.meridiem=$e,et("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===S(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),t.lang=R("moment.lang is deprecated. Use moment.locale instead.",et),t.langData=R("moment.langData is deprecated. Use moment.localeData instead.",ot);var rr=Math.abs,sr=ho("ms"),ar=ho("s"),lr=ho("m"),ur=ho("h"),cr=ho("d"),dr=ho("w"),hr=ho("M"),fr=ho("y"),pr=po("milliseconds"),gr=po("seconds"),mr=po("minutes"),vr=po("hours"),wr=po("days"),yr=po("months"),Cr=po("years"),br=Math.round,Sr={ss:44,s:45,m:45,h:22,d:26,M:11},Tr=Math.abs,Er=kt.prototype;return Er.isValid=Ot,Er.abs=to,Er.add=oo,Er.subtract=io,Er.as=uo,Er.asMilliseconds=sr,Er.asSeconds=ar,Er.asMinutes=lr,Er.asHours=ur,Er.asDays=cr,Er.asWeeks=dr,Er.asMonths=hr,Er.asYears=fr,Er.valueOf=co,Er._bubble=so,Er.get=fo,Er.milliseconds=pr,Er.seconds=gr,Er.minutes=mr,Er.hours=vr,Er.days=wr,Er.weeks=go,Er.months=yr,Er.years=Cr,Er.humanize=Co,Er.toISOString=bo,Er.toString=bo,Er.toJSON=bo,Er.locale=wn,Er.localeData=yn,Er.toIsoString=R("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",bo),Er.lang=Zi,X("X",0,0,"unix"),X("x",0,0,"valueOf"),J("x",Jo),J("X",ni),oe("X",function(e,t,n){n._d=new Date(1e3*parseFloat(e,10))}),oe("x",function(e,t,n){n._d=new Date(S(e))}),t.version="2.18.1",function(e){So=e}(bt),t.fn=or,t.min=Tt,t.max=Et,t.now=zi,t.utc=f,t.unix=zn,t.months=$n,t.isDate=u,t.locale=et,t.invalid=v,t.duration=Gt,t.isMoment=C,t.weekdays=Qn,t.parseZone=Un,t.localeData=ot,t.isDuration=Mt,t.monthsShort=Zn,t.weekdaysMin=eo,t.defineLocale=tt,t.updateLocale=nt,t.locales=it,t.weekdaysShort=Jn,t.normalizeUnits=j,t.relativeTimeRounding=wo,t.relativeTimeThreshold=yo,t.calendarFormat=Qt,t.prototype=or,t}),window.moment=n(40)}).call(t,n(354)(e))},function(e,t,n){function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(){function e(t,n){o(this,e),void 0!==t&&void 0!==n?(this.row=t,this.col=n):(this.row=null,this.col=null)}return i(e,[{key:"isValid",value:function(e){return!(this.row<0||this.col<0)&&!(this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns"))}},{key:"isEqual",value:function(e){return e===this||this.row===e.row&&this.col===e.col}},{key:"isSouthEastOf",value:function(e){return this.row>=e.row&&this.col>=e.col}},{key:"isNorthWestOf",value:function(e){return this.row<=e.row&&this.col<=e.col}},{key:"isSouthWestOf",value:function(e){return this.row>=e.row&&this.col<=e.col}},{key:"isNorthEastOf",value:function(e){return this.row<=e.row&&this.col>=e.col}}]),e}();t.default=r},function(e,t,n){function o(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var i=n(0),r=n(289),s=o(r),a=n(31),l=o(a),u=n(6),c=o(u),d=n(13),h=n(10),f=l.default.prototype.extend();f.prototype.init=function(){var e=this;this.createElements(),this.eventManager=new c.default(this),this.bindEvents(),this.autoResize=(0,s.default)(),this.instance.addHook("afterDestroy",function(){e.destroy()})},f.prototype.getValue=function(){return this.TEXTAREA.value},f.prototype.setValue=function(e){this.TEXTAREA.value=e};var p=function(e){var t,n=this,o=n.getActiveEditor();if(t=(e.ctrlKey||e.metaKey)&&!e.altKey,e.target===o.TEXTAREA&&!(0,h.isImmediatePropagationStopped)(e)){if(17===e.keyCode||224===e.keyCode||91===e.keyCode||93===e.keyCode)return void(0,h.stopImmediatePropagation)(e);switch(e.keyCode){case d.KEY_CODES.ARROW_RIGHT:case d.KEY_CODES.ARROW_LEFT:o.isInFullEditMode()&&(!o.isWaiting()&&!o.allowKeyEventPropagation||!o.isWaiting()&&o.allowKeyEventPropagation&&!o.allowKeyEventPropagation(e.keyCode))&&(0,h.stopImmediatePropagation)(e);break;case d.KEY_CODES.ARROW_UP:case d.KEY_CODES.ARROW_DOWN:o.isInFullEditMode()&&(!o.isWaiting()&&!o.allowKeyEventPropagation||!o.isWaiting()&&o.allowKeyEventPropagation&&!o.allowKeyEventPropagation(e.keyCode))&&(0,h.stopImmediatePropagation)(e);break;case d.KEY_CODES.ENTER:var r=o.instance.getSelected(),s=!(r[0]===r[2]&&r[1]===r[3]);if(t&&!s||e.altKey){if(o.isOpened()){var a=(0,i.getCaretPosition)(o.TEXTAREA),l=o.getValue(),u=l.slice(0,a)+"\n"+l.slice(a);o.setValue(u),(0,i.setCaretPosition)(o.TEXTAREA,a+1)}else o.beginEditing(o.originalValue+"\n");(0,h.stopImmediatePropagation)(e)}e.preventDefault();break;case d.KEY_CODES.A:case d.KEY_CODES.X:case d.KEY_CODES.C:case d.KEY_CODES.V:t&&(0,h.stopImmediatePropagation)(e);break;case d.KEY_CODES.BACKSPACE:case d.KEY_CODES.DELETE:case d.KEY_CODES.HOME:case d.KEY_CODES.END:(0,h.stopImmediatePropagation)(e)}-1===[d.KEY_CODES.ARROW_UP,d.KEY_CODES.ARROW_RIGHT,d.KEY_CODES.ARROW_DOWN,d.KEY_CODES.ARROW_LEFT].indexOf(e.keyCode)&&o.autoResize.resize(String.fromCharCode(e.keyCode))}};f.prototype.open=function(){this.refreshDimensions(),this.instance.addHook("beforeKeyDown",p)},f.prototype.close=function(e){this.textareaParentStyle.display="none",this.autoResize.unObserve(),document.activeElement===this.TEXTAREA&&this.instance.listen(),this.instance.removeHook("beforeKeyDown",p)},f.prototype.focus=function(){this.TEXTAREA.focus(),(0,i.setCaretPosition)(this.TEXTAREA,this.TEXTAREA.value.length)},f.prototype.createElements=function(){this.TEXTAREA=document.createElement("TEXTAREA"),(0,i.addClass)(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.TEXTAREA_PARENT=document.createElement("DIV"),(0,i.addClass)(this.TEXTAREA_PARENT,"handsontableInputHolder"),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.textareaParentStyle.top=0,this.textareaParentStyle.left=0,this.textareaParentStyle.display="none",this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.instance.rootElement.appendChild(this.TEXTAREA_PARENT);var e=this;this.instance._registerTimeout(setTimeout(function(){e.refreshDimensions()},0))},f.prototype.getEditedCell=function(){var e,t=this.checkEditorSection();switch(t){case"top":e=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=101;break;case"top-left-corner":e=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=103;break;case"bottom-left-corner":e=this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=103;break;case"left":e=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=102;break;case"bottom":e=this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=102;break;default:e=this.instance.getCell(this.row,this.col),this.textareaParentStyle.zIndex=""}return-1!=e&&-2!=e?e:void 0},f.prototype.refreshValue=function(){var e=this.instance.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()},f.prototype.refreshDimensions=function(){if(this.state===a.EditorState.EDITING){if(this.TD=this.getEditedCell(),!this.TD)return void this.close(!0);var e,t=(0,i.offset)(this.TD),n=(0,i.offset)(this.instance.rootElement),o=(0,i.getScrollableElement)(this.TD),r=this.instance.countRows(),s=t.top===n.top?0:1,l=t.top-n.top-s-(o.scrollTop||0),u=t.left-n.left-1-(o.scrollLeft||0),c=this.instance.getSettings(),d=(this.instance.hasRowHeaders(),this.instance.hasColHeaders()),h=this.checkEditorSection(),f=this.TD.style.backgroundColor;switch(h){case"top":e=(0,i.getCssTransform)(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":e=(0,i.getCssTransform)(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":e=(0,i.getCssTransform)(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":e=(0,i.getCssTransform)(this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":e=(0,i.getCssTransform)(this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.holder.parentNode)}(d&&0===this.instance.getSelected()[0]||c.fixedRowsBottom&&this.instance.getSelected()[0]===r-c.fixedRowsBottom)&&(l+=1),0===this.instance.getSelected()[1]&&(u+=1),e&&-1!=e?this.textareaParentStyle[e[0]]=e[1]:(0,i.resetCssTransform)(this.TEXTAREA_PARENT),this.textareaParentStyle.top=l+"px",this.textareaParentStyle.left=u+"px";var p=this.instance.view.wt.wtViewport.rowsRenderCalculator.startPosition,g=this.instance.view.wt.wtViewport.columnsRenderCalculator.startPosition,m=this.instance.view.wt.wtOverlays.leftOverlay.getScrollPosition(),v=this.instance.view.wt.wtOverlays.topOverlay.getScrollPosition(),w=(0,i.getScrollbarWidth)(),y=this.TD.offsetTop+p-v,C=this.TD.offsetLeft+g-m,b=(0,i.innerWidth)(this.TD)-8,S=(0,i.hasVerticalScrollbar)(o)?w:0,T=(0,i.hasHorizontalScrollbar)(o)?w:0,E=this.instance.view.maximumVisibleElementWidth(C)-9-S,R=this.TD.scrollHeight+1,O=Math.max(this.instance.view.maximumVisibleElementHeight(y)-T,23),_=(0,i.getComputedStyle)(this.TD);this.TEXTAREA.style.fontSize=_.fontSize,this.TEXTAREA.style.fontFamily=_.fontFamily,this.TEXTAREA.style.backgroundColor="",this.TEXTAREA.style.backgroundColor=f||(0,i.getComputedStyle)(this.TEXTAREA).backgroundColor,this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(R,O),maxHeight:O,minWidth:Math.min(b,E),maxWidth:E},!0),this.textareaParentStyle.display="block"}},f.prototype.bindEvents=function(){var e=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(e){(0,h.stopPropagation)(e)}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(e){(0,h.stopPropagation)(e)}),this.instance.addHook("afterScrollHorizontally",function(){e.refreshDimensions()}),this.instance.addHook("afterScrollVertically",function(){e.refreshDimensions()}),this.instance.addHook("afterColumnResize",function(){e.refreshDimensions(),e.focus()}),this.instance.addHook("afterRowResize",function(){e.refreshDimensions(),e.focus()}),this.instance.addHook("afterDestroy",function(){e.eventManager.destroy()})},f.prototype.destroy=function(){this.eventManager.destroy()},t.default=f},function(e,t){var n=e.exports={version:"2.4.0"};"number"==typeof __e&&(__e=n)},function(e,t){e.exports={}},function(e,t,n){var o=n(48)("meta"),i=n(9),r=n(15),a=n(12).f,l=0,u=Object.isExtensible||function(){return!0},c=!n(25)(function(){return u(Object.preventExtensions({}))}),d=function(e){a(e,o,{value:{i:"O"+ ++l,w:{}}})},h=function(e,t){if(!i(e))return"symbol"==(void 0===e?"undefined":s(e))?e:("string"==typeof e?"S":"P")+e;if(!r(e,o)){if(!u(e))return"F";if(!t)return"E";d(e)}return e[o].i},f=function(e,t){if(!r(e,o)){if(!u(e))return!0;if(!t)return!1;d(e)}return e[o].w},p=function(e){return c&&g.NEED&&u(e)&&!r(e,o)&&d(e),e},g=e.exports={KEY:o,NEED:!1,fastKey:h,getWeak:f,onFreeze:p}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){var o=n(12).f,i=n(15),r=n(4)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,r)&&o(e,r,{configurable:!0,value:t})}},function(e,t){var n=0,o=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+o).toString(36))}},function(t,n,o){var i,r;/*!
 * numbro.js
 * version : 1.11.0
 * author : Företagsplatsen AB
 * license : MIT
 * http://www.foretagsplatsen.se
 */
(function(){function s(e){this._value=e}function a(e){return 0===e?1:Math.floor(Math.log(Math.abs(e))/Math.LN10)+1}function l(e){var t,n="";for(t=0;t<e;t++)n+="0";return n}function u(e,t){var n,o,i,r,s,a,u,c;return c=e.toString(),n=c.split("e")[0],r=c.split("e")[1],o=n.split(".")[0],i=n.split(".")[1]||"",+r>0?c=o+i+l(r-i.length):(s=+o<0?"-0":"0",t>0&&(s+="."),u=l(-1*r-1),a=(u+Math.abs(o)+i).substr(0,t),c=s+a),+r>0&&t>0&&(c+="."+l(t)),c}function c(e,t,n,o){var i,r,s=Math.pow(10,t);return e.toString().indexOf("e")>-1?(r=u(e,t),"-"===r.charAt(0)&&+r>=0&&(r=r.substr(1))):r=(n(e+"e+"+t)/s).toFixed(t),o&&(i=new RegExp("0{1,"+o+"}$"),r=r.replace(i,"")),r}function d(e,t,n){var o=t.replace(/\{[^\{\}]*\}/g,"");return o.indexOf("$")>-1?f(e,M[H].currency.symbol,t,n):o.indexOf("%")>-1?g(e,t,n):o.indexOf(":")>-1?m(e):y(e._value,t,n)}function h(e,t){var n,o,i,r,s,a=t,l=!1;if(t.indexOf(":")>-1)e._value=v(t);else if(t===x)e._value=0;else{for("."!==M[H].delimiters.decimal&&(t=t.replace(/\./g,"").replace(M[H].delimiters.decimal,".")),n=new RegExp("[^a-zA-Z]"+M[H].abbreviations.thousand+"(?:\\)|(\\"+M[H].currency.symbol+")?(?:\\))?)?$"),o=new RegExp("[^a-zA-Z]"+M[H].abbreviations.million+"(?:\\)|(\\"+M[H].currency.symbol+")?(?:\\))?)?$"),i=new RegExp("[^a-zA-Z]"+M[H].abbreviations.billion+"(?:\\)|(\\"+M[H].currency.symbol+")?(?:\\))?)?$"),r=new RegExp("[^a-zA-Z]"+M[H].abbreviations.trillion+"(?:\\)|(\\"+M[H].currency.symbol+")?(?:\\))?)?$"),s=1;s<R.length&&!l;++s)t.indexOf(R[s])>-1?l=Math.pow(1024,s):t.indexOf(O[s])>-1&&(l=Math.pow(1e3,s));var u=t.replace(/[^0-9\.]+/g,"");""===u?e._value=NaN:(e._value=(l||1)*(a.match(n)?Math.pow(10,3):1)*(a.match(o)?Math.pow(10,6):1)*(a.match(i)?Math.pow(10,9):1)*(a.match(r)?Math.pow(10,12):1)*(t.indexOf("%")>-1?.01:1)*((t.split("-").length+Math.min(t.split("(").length-1,t.split(")").length-1))%2?1:-1)*Number(u),e._value=l?Math.ceil(e._value):e._value)}return e._value}function f(e,t,n,o){var i,r,s=n,a=s.indexOf("$"),l=s.indexOf("("),u=s.indexOf("+"),c=s.indexOf("-"),d="",h="";if(-1===s.indexOf("$")?"infix"===M[H].currency.position?(h=t,M[H].currency.spaceSeparated&&(h=" "+h+" ")):M[H].currency.spaceSeparated&&(d=" "):s.indexOf(" $")>-1?(d=" ",s=s.replace(" $","")):s.indexOf("$ ")>-1?(d=" ",s=s.replace("$ ","")):s=s.replace("$",""),r=y(e._value,s,o,h),-1===n.indexOf("$"))switch(M[H].currency.position){case"postfix":r.indexOf(")")>-1?(r=r.split(""),r.splice(-1,0,d+t),r=r.join("")):r=r+d+t;break;case"infix":break;case"prefix":r.indexOf("(")>-1||r.indexOf("-")>-1?(r=r.split(""),i=Math.max(l,c)+1,r.splice(i,0,t+d),r=r.join("")):r=t+d+r;break;default:throw Error('Currency position should be among ["prefix", "infix", "postfix"]')}else a<=1?r.indexOf("(")>-1||r.indexOf("+")>-1||r.indexOf("-")>-1?(r=r.split(""),i=1,(a<l||a<u||a<c)&&(i=0),r.splice(i,0,t+d),r=r.join("")):r=t+d+r:r.indexOf(")")>-1?(r=r.split(""),r.splice(-1,0,d+t),r=r.join("")):r=r+d+t;return r}function p(e,t,n,o){return f(e,t,n,o)}function g(e,t,n){var o,i="",r=100*e._value;return t.indexOf(" %")>-1?(i=" ",t=t.replace(" %","")):t=t.replace("%",""),o=y(r,t,n),o.indexOf(")")>-1?(o=o.split(""),o.splice(-1,0,i+"%"),o=o.join("")):o=o+i+"%",o}function m(e){var t=Math.floor(e._value/60/60),n=Math.floor((e._value-60*t*60)/60),o=Math.round(e._value-60*t*60-60*n);return t+":"+(n<10?"0"+n:n)+":"+(o<10?"0"+o:o)}function v(e){var t=e.split(":"),n=0;return 3===t.length?(n+=60*Number(t[0])*60,n+=60*Number(t[1]),n+=Number(t[2])):2===t.length&&(n+=60*Number(t[0]),n+=Number(t[1])),Number(n)}function w(e,t,n){var o,i,r,s=t[0],a=Math.abs(e);if(a>=n){for(o=1;o<t.length;++o)if(i=Math.pow(n,o),r=Math.pow(n,o+1),a>=i&&a<r){s=t[o],e/=i;break}s===t[0]&&(e/=Math.pow(n,t.length-1),s=t[t.length-1])}return{value:e,suffix:s}}function y(e,t,n,o){var i,r,s,u,d,h,f,p,g,m,v,y,C,b,S,T,E=!1,R=!1,O=!1,_="",D=!1,A=!1,P=!1,N=!1,L=!1,W="",j="",F=Math.abs(e),I="",V=!1,B=!1,Y="";if(0===e&&null!==x)return x;if(!isFinite(e))return""+e;if(0===t.indexOf("{")){var z=t.indexOf("}");if(-1===z)throw Error('Format should also contain a "}"');m=t.slice(1,z),t=t.slice(z+1)}else m="";if(t.indexOf("}")===t.length-1&&t.length){var U=t.indexOf("{");if(-1===U)throw Error('Format should also contain a "{"');v=t.slice(U+1,-1),t=t.slice(0,U+1)}else v="";var G;for(G=-1===t.indexOf(".")?t.match(/([0-9]+).*/):t.match(/([0-9]+)\..*/),S=null===G?-1:G[1].length,-1!==t.indexOf("-")&&(V=!0),t.indexOf("(")>-1?(E=!0,t=t.slice(1,-1)):t.indexOf("+")>-1&&(R=!0,t=t.replace(/\+/g,"")),t.indexOf("a")>-1&&(p=t.split(".")[0].match(/[0-9]+/g)||["0"],p=parseInt(p[0],10),D=t.indexOf("aK")>=0,A=t.indexOf("aM")>=0,P=t.indexOf("aB")>=0,N=t.indexOf("aT")>=0,L=D||A||P||N,t.indexOf(" a")>-1?(_=" ",t=t.replace(" a","")):t=t.replace("a",""),s=a(e),d=s%3,d=0===d?3:d,p&&0!==F&&(h=3*~~((Math.min(p,s)-d)/3),F/=Math.pow(10,h)),s!==p&&(F>=Math.pow(10,12)&&!L||N?(_+=M[H].abbreviations.trillion,e/=Math.pow(10,12)):F<Math.pow(10,12)&&F>=Math.pow(10,9)&&!L||P?(_+=M[H].abbreviations.billion,e/=Math.pow(10,9)):F<Math.pow(10,9)&&F>=Math.pow(10,6)&&!L||A?(_+=M[H].abbreviations.million,e/=Math.pow(10,6)):(F<Math.pow(10,6)&&F>=Math.pow(10,3)&&!L||D)&&(_+=M[H].abbreviations.thousand,e/=Math.pow(10,3))),u=a(e),p&&u<p&&-1===t.indexOf(".")&&(t+="[.]",t+=l(p-u))),T=0;T<k.length;++T)if(i=k[T],t.indexOf(i.marker)>-1){t.indexOf(" "+i.marker)>-1&&(W=" "),t=t.replace(W+i.marker,""),r=w(e,i.suffixes,i.scale),e=r.value,W+=r.suffix;break}if(t.indexOf("o")>-1&&(t.indexOf(" o")>-1?(j=" ",t=t.replace(" o","")):t=t.replace("o",""),M[H].ordinal&&(j+=M[H].ordinal(e))),t.indexOf("[.]")>-1&&(O=!0,t=t.replace("[.]",".")),g=t.split(".")[1],y=t.indexOf(","),g){var K=[];if(-1!==g.indexOf("*")?(I=e.toString(),K=I.split("."),K.length>1&&(I=c(e,K[1].length,n))):g.indexOf("[")>-1?(g=g.replace("]",""),g=g.split("["),I=c(e,g[0].length+g[1].length,n,g[1].length)):I=c(e,g.length,n),K=I.split("."),f=K[0],K.length>1&&K[1].length){I=(o?_+o:M[H].delimiters.decimal)+K[1]}else I="";O&&0===Number(I.slice(1))&&(I="")}else f=c(e,0,n);return f.indexOf("-")>-1&&(f=f.slice(1),B=!0),f.length<S&&(f=l(S-f.length)+f),y>-1&&(f=f.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+M[H].delimiters.thousands)),0===t.indexOf(".")&&(f=""),C=t.indexOf("("),b=t.indexOf("-"),Y=C<b?(E&&B?"(":"")+(V&&B||!E&&B?"-":""):(V&&B||!E&&B?"-":"")+(E&&B?"(":""),m+Y+(!B&&R&&0!==e?"+":"")+f+I+(j||"")+(_&&!o?_:"")+(W||"")+(E&&B?")":"")+v}function C(e,t){M[e]=t}function b(e){H=e;var t=M[e].defaults;t&&t.format&&E.defaultFormat(t.format),t&&t.currencyFormat&&E.defaultCurrencyFormat(t.currencyFormat)}function S(e){var t=e.toString().split(".");return t.length<2?1:Math.pow(10,t[1].length)}function T(){return Array.prototype.slice.call(arguments).reduce(function(e,t){var n=S(e),o=S(t);return n>o?n:o},-1/0)}var E,R=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],O=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],_={general:{scale:1024,suffixes:O,marker:"bd"},binary:{scale:1024,suffixes:R,marker:"b"},decimal:{scale:1e3,suffixes:O,marker:"d"}},k=[_.general,_.binary,_.decimal],M={},D=M,H="en-US",x=null,A="0,0",P="0$",N=void 0!==t&&t.exports,L={delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(e){var t=e%10;return 1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},currency:{symbol:"$",position:"prefix"},defaults:{currencyFormat:",0000 a"},formats:{fourDigits:"0000 a",fullWithTwoDecimals:"$ ,0.00",fullWithTwoDecimalsNoCurrency:",0.00"}};E=function(e){return e=E.isNumbro(e)?e.value():"string"==typeof e||"number"==typeof e?E.fn.unformat(e):NaN,new s(Number(e))},E.version="1.11.0",E.isNumbro=function(e){return e instanceof s},E.setLanguage=function(e,t){console.warn("`setLanguage` is deprecated since version 1.6.0. Use `setCulture` instead");var n=e,o=e.split("-")[0],i=null;D[n]||(Object.keys(D).forEach(function(e){i||e.split("-")[0]!==o||(i=e)}),n=i||t||"en-US"),b(n)},E.setCulture=function(e,t){var n=e,o=e.split("-")[1],i=null;M[n]||(o&&Object.keys(M).forEach(function(e){i||e.split("-")[1]!==o||(i=e)}),n=i||t||"en-US"),b(n)},E.language=function(e,t){if(console.warn("`language` is deprecated since version 1.6.0. Use `culture` instead"),!e)return H;if(e&&!t){if(!D[e])throw new Error("Unknown language : "+e);b(e)}return!t&&D[e]||C(e,t),E},E.culture=function(e,t){if(!e)return H;if(e&&!t){if(!M[e])throw new Error("Unknown culture : "+e);b(e)}return!t&&M[e]||C(e,t),E},E.languageData=function(e){if(console.warn("`languageData` is deprecated since version 1.6.0. Use `cultureData` instead"),!e)return D[H];if(!D[e])throw new Error("Unknown language : "+e);return D[e]},E.cultureData=function(e){if(!e)return M[H];if(!M[e])throw new Error("Unknown culture : "+e);return M[e]},E.culture("en-US",L),E.languages=function(){return console.warn("`languages` is deprecated since version 1.6.0. Use `cultures` instead"),D},E.cultures=function(){return M},E.zeroFormat=function(e){x="string"==typeof e?e:null},E.defaultFormat=function(e){A="string"==typeof e?e:"0.0"},E.defaultCurrencyFormat=function(e){P="string"==typeof e?e:"0$"},E.validate=function(e,t){var n,o,i,r,s,a,l,u;if("string"!=typeof e&&(e+="",console.warn&&console.warn("Numbro.js: Value is not string. It has been co-erced to: ",e)),e=e.trim(),e=e.replace(/^[+-]?/,""),e.match(/^\d+$/))return!0;if(""===e)return!1;try{l=E.cultureData(t)}catch(e){l=E.cultureData(E.culture())}return i=l.currency.symbol,s=l.abbreviations,n=l.delimiters.decimal,o="."===l.delimiters.thousands?"\\.":l.delimiters.thousands,(null===(u=e.match(/^[^\d\.\,]+/))||(e=e.substr(1),u[0]===i))&&((null===(u=e.match(/[^\d]+$/))||(e=e.slice(0,-1),u[0]===s.thousand||u[0]===s.million||u[0]===s.billion||u[0]===s.trillion))&&(a=new RegExp(o+"{2}"),!e.match(/[^\d.,]/g)&&(r=e.split(n),!(r.length>2)&&(r.length<2?!!r[0].match(/^\d+.*\d$/)&&!r[0].match(a):""===r[0]?!r[0].match(a)&&!!r[1].match(/^\d+$/):1===r[0].length?!!r[0].match(/^\d+$/)&&!r[0].match(a)&&!!r[1].match(/^\d+$/):!!r[0].match(/^\d+.*\d$/)&&!r[0].match(a)&&!!r[1].match(/^\d+$/)))))},E.loadLanguagesInNode=function(){console.warn("`loadLanguagesInNode` is deprecated since version 1.6.0. Use `loadCulturesInNode` instead"),E.loadCulturesInNode()},E.loadCulturesInNode=function(){var e=o(287);for(var t in e)t&&E.culture(t,e[t])},"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(e,t){if(null===this||void 0===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof e)throw new TypeError(e+" is not a function");var n,o,i=this.length>>>0,r=!1;for(1<arguments.length&&(o=t,r=!0),n=0;i>n;++n)this.hasOwnProperty(n)&&(r?o=e(o,this[n],n,this):(o=this[n],r=!0));if(!r)throw new TypeError("Reduce of empty array with no initial value");return o}),E.fn=s.prototype={clone:function(){return E(this)},format:function(e,t){return d(this,e||A,void 0!==t?t:Math.round)},formatCurrency:function(e,t){return f(this,M[H].currency.symbol,e||P,void 0!==t?t:Math.round)},formatForeignCurrency:function(e,t,n){return p(this,e,t||P,void 0!==n?n:Math.round)},unformat:function(e){if("number"==typeof e)return e;if("string"==typeof e){var t=h(this,e);return isNaN(t)?void 0:t}},binaryByteUnits:function(){return w(this._value,_.binary.suffixes,_.binary.scale).suffix},byteUnits:function(){return w(this._value,_.general.suffixes,_.general.scale).suffix},decimalByteUnits:function(){return w(this._value,_.decimal.suffixes,_.decimal.scale).suffix},value:function(){return this._value},valueOf:function(){return this._value},set:function(e){return this._value=Number(e),this},add:function(e){function t(e,t){return e+n*t}var n=T.call(null,this._value,e);return this._value=[this._value,e].reduce(t,0)/n,this},subtract:function(e){function t(e,t){return e-n*t}var n=T.call(null,this._value,e);return this._value=[e].reduce(t,this._value*n)/n,this},multiply:function(e){function t(e,t){var n=T(e,t),o=e*n;return o*=t*n,o/=n*n}return this._value=[this._value,e].reduce(t,1),this},divide:function(e){function t(e,t){var n=T(e,t);return e*n/(t*n)}return this._value=[this._value,e].reduce(t),this},difference:function(e){return Math.abs(E(this._value).subtract(e).value())}},function(){return void 0!==e&&void 0===e.browser&&e.title&&(-1!==e.title.indexOf("node")||e.title.indexOf("meteor-tool")>0||"grunt"===e.title||"gulp"===e.title)&&!0}()&&E.loadCulturesInNode(),N?t.exports=E:("undefined"==typeof ender&&(this.numbro=E),i=[],void 0!==(r=function(){return E}.apply(n,i))&&(t.exports=r))}).call("undefined"==typeof window?this:window),window.numbro=o(49)},function(e,t,n){function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(){function e(e,t){l.set(e,t)}function t(e){return l.get(e)}function n(e){return l.has(e)}function i(){return[].concat(o(l.keys()))}function s(){return[].concat(o(l.values()))}var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";r.has(a)||r.set(a,new Map);var l=r.get(a);return{register:e,getItem:t,hasItem:n,getNames:i,getValues:s}}t.__esModule=!0,t.default=i;var r=t.collection=new Map},function(e,t){e.exports=function(e,t,n,o){if(!(e instanceof t)||void 0!==o&&o in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var o=n(23),i=n(71),r=n(36),s=n(17),a=n(335);e.exports=function(e,t){var n=1==e,l=2==e,u=3==e,c=4==e,d=6==e,h=5==e||d,f=t||a;return function(t,a,p){for(var g,m,v=r(t),w=i(v),y=o(a,p,3),C=s(w.length),b=0,S=n?f(t,C):l?f(t,0):void 0;C>b;b++)if((h||b in w)&&(g=w[b],m=y(g,b,v),e))if(n)S[b]=m;else if(m)switch(e){case 3:return!0;case 5:return g;case 6:return b;case 2:S.push(g)}else if(c)return!1;return d?-1:u||c?c:S}}},function(e,t,n){var o=n(5),i=n(1),r=n(27),s=n(58),a=n(45),l=n(55),u=n(51),c=n(9),d=n(25),h=n(72),f=n(47),p=n(338);e.exports=function(e,t,n,g,m,v){var w=o[e],y=w,C=m?"set":"add",b=y&&y.prototype,S={},T=function(e){var t=b[e];r(b,e,"delete"==e?function(e){return!(v&&!c(e))&&t.call(this,0===e?0:e)}:"has"==e?function(e){return!(v&&!c(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return v&&!c(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,n){return t.call(this,0===e?0:e,n),this})};if("function"==typeof y&&(v||b.forEach&&!d(function(){(new y).entries().next()}))){var E=new y,R=E[C](v?{}:-0,1)!=E,O=d(function(){E.has(1)}),_=h(function(e){new y(e)}),k=!v&&d(function(){for(var e=new y,t=5;t--;)e[C](t,t);return!e.has(-0)});_||(y=t(function(t,n){u(t,y,e);var o=p(new w,t,y);return void 0!=n&&l(n,m,o[C],o),o}),y.prototype=b,b.constructor=y),(O||k)&&(T("delete"),T("has"),m&&T("get")),(k||R)&&T(C),v&&b.clear&&delete b.clear}else y=g.getConstructor(t,e,m,C),s(y.prototype,n),a.NEED=!0;return f(y,e),S[e]=y,i(i.G+i.W+i.F*(y!=w),S),v||g.setStrong(y,e,m),y}},function(e,t,n){var o=n(26),i=n(27),r=n(25),s=n(24),a=n(4);e.exports=function(e,t,n){var l=a(e),u=n(s,l,""[e]),c=u[0],d=u[1];r(function(){var t={};return t[l]=function(){return 7},7!=""[e](t)})&&(i(String.prototype,e,c),o(RegExp.prototype,l,2==t?function(e,t){return d.call(e,this,t)}:function(e){return d.call(e,this)}))}},function(e,t,n){var o=n(23),i=n(269),r=n(265),s=n(11),a=n(17),l=n(280),u={},c={},t=e.exports=function(e,t,n,d,h){var f,p,g,m,v=h?function(){return e}:l(e),w=o(n,d,t?2:1),y=0;if("function"!=typeof v)throw TypeError(e+" is not iterable!");if(r(v)){for(f=a(e.length);f>y;y++)if((m=t?w(s(p=e[y])[0],p[1]):w(e[y]))===u||m===c)return m}else for(g=v.call(e);!(p=g.next()).done;)if((m=i(g,w,p.value,t))===u||m===c)return m};t.BREAK=u,t.RETURN=c},function(e,t){e.exports=!1},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var o=n(27);e.exports=function(e,t,n){for(var i in t)o(e,i,t[i],n);return e}},function(e,t,n){var o=n(60),i=Math.max,r=Math.min;e.exports=function(e,t){return e=o(e),e<0?i(e+t,0):r(e,t)}},function(e,t){var n=Math.ceil,o=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?o:n)(e)}},function(e,t,n){function o(e){return e&&e.__esModule?e:{default:e}}function i(e){if(!x(e))throw Error('You declared cell type "'+e+'" as a string that is not mapped to a known object.\n                 Cell type must be an object or a string mapped to an object registered by "Handsontable.cellTypes.registerCellType" method');return H(e)}function r(e,t){var n=t.editor,o=t.renderer,i=t.validator;n&&(0,l.registerEditor)(e,n),o&&(0,u.registerRenderer)(e,o),i&&(0,c.registerValidator)(e,i),D(e,t)}t.__esModule=!0,t.getRegisteredCellTypes=t.getRegisteredCellTypeNames=t.hasCellType=t.getCellType=t.registerCellType=void 0;var s=n(50),a=o(s),l=n(8),u=n(3),c=n(19),d=n(295),h=o(d),f=n(296),p=o(f),g=n(297),m=o(g),v=n(298),w=o(v),y=n(299),C=o(y),b=n(300),S=o(b),T=n(301),E=o(T),R=n(302),O=o(R),_=n(303),k=o(_),M=(0,a.default)("cellTypes"),D=M.register,H=M.getItem,x=M.hasItem,A=M.getNames,P=M.getValues;r("autocomplete",h.default),r("checkbox",p.default),r("date",m.default),r("dropdown",w.default),r("handsontable",C.default),r("numeric",S.default),r("password",E.default),r("text",O.default),r("time",k.default),t.registerCellType=r,t.getCellType=i,t.hasCellType=x,t.getRegisteredCellTypeNames=A,t.getRegisteredCellTypes=P},function(e,t,n){function o(e){for(var t=e+1,n="",o=void 0;t>0;)o=(t-1)%f,n=String.fromCharCode(65+o)+n,t=parseInt((t-o)/f,10);return n}function i(e){var t=0;if(e)for(var n=0,o=e.length-1;n<e.length;n+=1,o-=1)t+=Math.pow(f,o)*(h.indexOf(e[n])+1);return--t}function r(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,r=[];for(e=0;e<n;e++){var s=[];for(t=0;t<i;t++)s.push(o(t)+(e+1));r.push(s)}return r}function s(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,r=[];for(e=0;e<n;e++){var s={};for(t=0;t<i;t++)s["prop"+t]=o(t)+(e+1);r.push(s)}return r}function a(e,t){for(var n=[],o=void 0,i=0;i<e;i++){o=[];for(var r=0;r<t;r++)o.push("");n.push(o)}return n}function l(e){var t,n,o,i,r=[],s=0;for(t=0,n=e.length;t<n;t++)for(o=0,i=e[t].length;o<i;o++)o==s&&(r.push([]),s++),r[o].push(e[t][o]);return r}function u(e,t){return t=void 0===t||t,function(n,o){return function n(o){if(o){if((0,d.hasOwnProperty)(o,e)&&void 0!==o[e])return o[e];if((0,d.hasOwnProperty)(o,"type")&&o.type){var i;if("string"!=typeof o.type)throw new Error("Cell type must be a string ");if(i=(0,c.getCellType)(o.type),(0,d.hasOwnProperty)(i,e))return i[e];if(t)return}return n(Object.getPrototypeOf(o))}}("number"==typeof n?this.getCellMeta(n,o):n)}}t.__esModule=!0,t.spreadsheetColumnLabel=o,t.spreadsheetColumnIndex=i,t.createSpreadsheetData=r,t.createSpreadsheetObjectData=s,t.createEmptySpreadsheetData=a,t.translateRowsToColumns=l,t.cellMethodLookupFactory=u;var c=n(61),d=n(2),h="ABCDEFGHIJKLMNOPQRSTUVWXYZ",f=h.length},function(e,t,n){function o(e,t){function n(){}(0,i.inherit)(n,e);for(var o=0,r=t.length;o<r;o++)n.prototype[t[o]]=void 0;return n}t.__esModule=!0,t.columnFactory=o;var i=n(2)},function(e,t,n){var o=n(32),i=n(271),r=n(44),s=n(16);e.exports=n(270)(Array,"Array",function(e,t){this._t=s(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):"keys"==t?i(0,n):"values"==t?i(0,e[n]):i(0,[n,e[n]])},"values"),r.Arguments=r.Array,o("keys"),o("values"),o("entries")},function(e,t,n){function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(41),s=function(e){return e&&e.__esModule?e:{default:e}}(r),a=function(){function e(t,n,i){o(this,e),this.highlight=t,this.from=n,this.to=i}return i(e,[{key:"isValid",value:function(e){return this.from.isValid(e)&&this.to.isValid(e)}},{key:"isSingle",value:function(){return this.from.row===this.to.row&&this.from.col===this.to.col}},{key:"getHeight",value:function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}},{key:"getWidth",value:function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}},{key:"includes",value:function(e){var t=e.row,n=e.col,o=this.getTopLeftCorner(),i=this.getBottomRightCorner();return o.row<=t&&i.row>=t&&o.col<=n&&i.col>=n}},{key:"includesRange",value:function(e){return this.includes(e.getTopLeftCorner())&&this.includes(e.getBottomRightCorner())}},{key:"isEqual",value:function(e){return Math.min(this.from.row,this.to.row)==Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)==Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)==Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)==Math.max(e.from.col,e.to.col)}},{key:"overlaps",value:function(e){return e.isSouthEastOf(this.getTopLeftCorner())&&e.isNorthWestOf(this.getBottomRightCorner())}},{key:"isSouthEastOf",value:function(e){return this.getTopLeftCorner().isSouthEastOf(e)||this.getBottomRightCorner().isSouthEastOf(e)}},{key:"isNorthWestOf",value:function(e){return this.getTopLeftCorner().isNorthWestOf(e)||this.getBottomRightCorner().isNorthWestOf(e)}},{key:"expand",value:function(e){var t=this.getTopLeftCorner(),n=this.getBottomRightCorner();return(e.row<t.row||e.col<t.col||e.row>n.row||e.col>n.col)&&(this.from=new s.default(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=new s.default(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0)}},{key:"expandByRange",value:function(t){if(this.includesRange(t)||!this.overlaps(t))return!1;var n=this.getTopLeftCorner(),o=this.getBottomRightCorner(),i=(this.getTopRightCorner(),this.getBottomLeftCorner(),t.getTopLeftCorner()),r=t.getBottomRightCorner(),a=Math.min(n.row,i.row),l=Math.min(n.col,i.col),u=Math.max(o.row,r.row),c=Math.max(o.col,r.col),d=new s.default(a,l),h=new s.default(u,c),f=new e(d,d,h).isCorner(this.from,t),p=t.isEqual(new e(d,d,h));return f&&!p&&(this.from.col>d.col&&(d.col=c,h.col=l),this.from.row>d.row&&(d.row=u,h.row=a)),this.from=d,this.to=h,!0}},{key:"getDirection",value:function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}},{key:"setDirection",value:function(e){switch(e){case"NW-SE":var t=[this.getTopLeftCorner(),this.getBottomRightCorner()];this.from=t[0],this.to=t[1];break;case"NE-SW":var n=[this.getTopRightCorner(),this.getBottomLeftCorner()];this.from=n[0],this.to=n[1];break;case"SE-NW":var o=[this.getBottomRightCorner(),this.getTopLeftCorner()];this.from=o[0],this.to=o[1];break;case"SW-NE":var i=[this.getBottomLeftCorner(),this.getTopRightCorner()];this.from=i[0],this.to=i[1]}}},{key:"getTopLeftCorner",value:function(){return new s.default(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"getBottomRightCorner",value:function(){return new s.default(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getTopRightCorner",value:function(){return new s.default(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}},{key:"getBottomLeftCorner",value:function(){return new s.default(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}},{key:"isCorner",value:function(e,t){return!!(t&&t.includes(e)&&(this.getTopLeftCorner().isEqual(new s.default(t.from.row,t.from.col))||this.getTopRightCorner().isEqual(new s.default(t.from.row,t.to.col))||this.getBottomLeftCorner().isEqual(new s.default(t.to.row,t.from.col))||this.getBottomRightCorner().isEqual(new s.default(t.to.row,t.to.col))))||(e.isEqual(this.getTopLeftCorner())||e.isEqual(this.getTopRightCorner())||e.isEqual(this.getBottomLeftCorner())||e.isEqual(this.getBottomRightCorner()))}},{key:"getOppositeCorner",value:function(e,t){if(!(e instanceof s.default))return!1;if(t&&t.includes(e)){if(this.getTopLeftCorner().isEqual(new s.default(t.from.row,t.from.col)))return this.getBottomRightCorner();if(this.getTopRightCorner().isEqual(new s.default(t.from.row,t.to.col)))return this.getBottomLeftCorner();if(this.getBottomLeftCorner().isEqual(new s.default(t.to.row,t.from.col)))return this.getTopRightCorner();if(this.getBottomRightCorner().isEqual(new s.default(t.to.row,t.to.col)))return this.getTopLeftCorner()}return e.isEqual(this.getBottomRightCorner())?this.getTopLeftCorner():e.isEqual(this.getTopLeftCorner())?this.getBottomRightCorner():e.isEqual(this.getTopRightCorner())?this.getBottomLeftCorner():e.isEqual(this.getBottomLeftCorner())?this.getTopRightCorner():void 0}},{key:"getBordersSharedWith",value:function(e){if(!this.includesRange(e))return[];var t={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},o=[];return t.top==n.top&&o.push("top"),t.right==n.right&&o.push("right"),t.bottom==n.bottom&&o.push("bottom"),t.left==n.left&&o.push("left"),o}},{key:"getInner",value:function(){for(var e=this.getTopLeftCorner(),t=this.getBottomRightCorner(),n=[],o=e.row;o<=t.row;o++)for(var i=e.col;i<=t.col;i++)this.from.row===o&&this.from.col===i||this.to.row===o&&this.to.col===i||n.push(new s.default(o,i));return n}},{key:"getAll",value:function(){for(var e=this.getTopLeftCorner(),t=this.getBottomRightCorner(),n=[],o=e.row;o<=t.row;o++)for(var i=e.col;i<=t.col;i++)e.row===o&&e.col===i?n.push(e):t.row===o&&t.col===i?n.push(t):n.push(new s.default(o,i));return n}},{key:"forAll",value:function(e){for(var t=this.getTopLeftCorner(),n=this.getBottomRightCorner(),o=t.row;o<=n.row;o++)for(var i=t.col;i<=n.col;i++){var r=e(o,i);if(!1===r)return}}}]),e}();t.default=a},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var o=n(12),i=n(35);e.exports=function(e,t,n){t in e?o.f(e,t,i(0,n)):e[t]=n}},function(e,t,n){var o=n(9),i=n(5).document,r=o(i)&&o(i.createElement);e.exports=function(e){return r?i.createElement(e):{}}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){var o=n(4)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[o]=!1,!"/./"[e](t)}catch(e){}}return!0}},function(e,t,n){var o=n(33);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==o(e)?e.split(""):Object(e)}},function(e,t,n){var o=n(4)("iterator"),i=!1;try{var r=[7][o]();r.return=function(){i=!0},Array.from(r,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var r=[7],s=r[o]();s.next=function(){return{done:n=!0}},r[o]=function(){return s},e(r)}catch(e){}return n}},function(e,t,n){var o=n(11),i=n(343),r=n(69),s=n(76)("IE_PROTO"),a=function(){},l=function(){var e,t=n(68)("iframe"),o=r.length;for(t.style.display="none",n(263).appendChild(t),t.src="javascript:",e=t.contentWindow.document,e.open(),e.write("<script>document.F=Object<\/script>"),e.close(),l=e.F;o--;)delete l.prototype[r[o]];return l()};e.exports=Object.create||function(e,t){var n;return null!==e?(a.prototype=o(e),n=new a,a.prototype=null,n[s]=e):n=l(),void 0===t?n:i(n,t)}},function(e,t,n){var o=n(46),i=n(35),r=n(16),s=n(80),a=n(15),l=n(264),u=Object.getOwnPropertyDescriptor;t.f=n(14)?u:function(e,t){if(e=r(e),t=s(t,!0),l)try{return u(e,t)}catch(e){}if(a(e,t))return i(!o.f.call(e,t),e[t])}},function(e,t,n){var o=n(273),i=n(69).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return o(e,i)}},function(e,t,n){var o=n(77)("keys"),i=n(48);e.exports=function(e){return o[e]||(o[e]=i(e))}},function(e,t,n){var o=n(5),i=o["__core-js_shared__"]||(o["__core-js_shared__"]={});e.exports=function(e){return i[e]||(i[e]={})}},function(e,t,n){var o=n(268),i=n(24);e.exports=function(e,t,n){if(o(t))throw TypeError("String#"+n+" doesn't accept regex!");return String(i(e))}},function(e,t,n){var o,i,r,s=n(23),a=n(339),l=n(263),u=n(68),c=n(5),d=c.process,h=c.setImmediate,f=c.clearImmediate,p=c.MessageChannel,g=0,m={},v=function(){var e=+this;if(m.hasOwnProperty(e)){var t=m[e];delete m[e],t()}},w=function(e){v.call(e.data)};h&&f||(h=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return m[++g]=function(){a("function"==typeof e?e:Function(e),t)},o(g),g},f=function(e){delete m[e]},"process"==n(33)(d)?o=function(e){d.nextTick(s(v,e,1))}:p?(i=new p,r=i.port2,i.port1.onmessage=w,o=s(r.postMessage,r,1)):c.addEventListener&&"function"==typeof postMessage&&!c.importScripts?(o=function(e){c.postMessage(e+"","*")},c.addEventListener("message",w,!1)):o="onreadystatechange"in u("script")?function(e){l.appendChild(u("script")).onreadystatechange=function(){l.removeChild(this),v.call(e)}}:function(e){setTimeout(s(v,e,1),0)}),e.exports={set:h,clear:f}},function(e,t,n){var o=n(9);e.exports=function(e,t){if(!o(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!o(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!o(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!o(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){function o(e){return e&&e.__esModule?e:{default:e}}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){function n(){var e=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue:function(){this.validatorsInQueue++,e=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(e){},checkIfQueueIsEmpty:function(){0==this.validatorsInQueue&&0==e&&(e=!0,this.onQueueEmpty(this.valid))}}}function o(e,t,o){function i(){var n;e.length&&(n=B.runHooks("beforeChange",e,t),(0,f.isFunction)(n)?console.warn("Your beforeChange callback returns a function. It's not supported since Handsontable 0.12.1 (and the returned function will not be executed)."):!1===n&&e.splice(0,e.length)),o()}var r=new n;r.onQueueEmpty=i;for(var s=e.length-1;s>=0;s--)if(null===e[s])e.splice(s,1);else{var a=e[s][0],l=C.propToCol(e[s][1]),u=B.getCellMeta(a,l);if("numeric"===u.type&&"string"==typeof e[s][3]&&e[s][3].length>0&&(/^-?[\d\s]*(\.|,)?\d*$/.test(e[s][3])||u.format)){var h=e[s][3].length;(0,p.isUndefined)(u.language)?c.default.culture("en-US"):e[s][3].indexOf(".")===h-3&&-1===e[s][3].indexOf(",")?c.default.culture("en-US"):c.default.culture(u.language);var g=c.default.cultureData(c.default.culture());g.delimiters;c.default.validate(e[s][3])&&!isNaN(e[s][3])?e[s][3]=parseFloat(e[s][3]):e[s][3]=(0,c.default)().unformat(e[s][3])||e[s][3]}B.getCellValidator(u)&&(r.addValidatorToQueue(),B.validateCell(e[s][3],u,function(t,n){return function(o){if("boolean"!=typeof o)throw new Error("Validation error: result is not boolean");if(!1===o&&!1===n.allowInvalid){e.splice(t,1),n.valid=!0;var i=B.getCell(n.row,n.col);(0,d.removeClass)(i,B.getSettings().invalidCellClassName),--t}r.removeValidatorFormQueue()}}(s,u),t))}r.checkIfQueueIsEmpty()}function r(e,t){var n=e.length-1;if(!(n<0)){for(;n>=0;n--){var o=!1;if(null!==e[n]){if(null!=e[n][2]||null!=e[n][3]){if(w.settings.allowInsertRow)for(;e[n][0]>B.countRows()-1;){var i=C.createRow(void 0,void 0,t);if(0===i){o=!0;break}}if(!o){if("array"===B.dataType&&(!w.settings.columns||0===w.settings.columns.length)&&w.settings.allowInsertColumn)for(;C.propToCol(e[n][1])>B.countCols()-1;)C.createCol(void 0,void 0,t);C.set(e[n][0],e[n][1],e[n][3])}}}else e.splice(n,1)}B.forceFullRender=!0,H.adjustRowsAndCols(),B.runHooks("beforeChangeRender",e,t),L.refreshBorders(null,!0),B.view.wt.wtOverlays.adjustElementsSize(),B.runHooks("afterChange",e,t||"edit");var r=B.getActiveEditor();r&&(0,p.isDefined)(r.refreshValue)&&r.refreshValue()}}function s(e,t,n){return"object"===(void 0===e?"undefined":l(e))?e:[[e,t,n]]}function u(e){if((0,S.hasOwnProperty)(e,"type")){var t,n={};"object"===l(e.type)?t=e.type:"string"==typeof e.type&&(t=(0,I.getCellType)(e.type));for(var o in t)(0,S.hasOwnProperty)(t,o)&&!(0,S.hasOwnProperty)(e,o)&&(n[o]=t[o]);return n}}function m(){throw new Error("This method cannot be called because this Handsontable instance has been destroyed")}var w,C,M,H,L,j,B=this,Y=function(){},z=new b.default(B);(0,S.extend)(Y.prototype,F.default.prototype),(0,S.extend)(Y.prototype,t),(0,S.extend)(Y.prototype,u(t)),this.rootElement=e,this.isHotTableEnv=(0,d.isChildOfWebComponentTable)(this.rootElement),b.default.isHotTableEnv=this.isHotTableEnv,this.container=document.createElement("DIV"),this.renderCall=!1,e.insertBefore(this.container,e.firstChild),this.guid="ht_"+(0,_.randomString)();var U=(0,P.getTranslator)(B);M=new x.default(B),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid),w={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width"],settings:new Y,selRange:null,isPopulated:null,scrollable:null,firstRun:!0},H={alter:function(e,t,n,o,r){function s(e,t,n,o){var r=function(){var e=void 0;return"array"===o?e=[]:"object"===o&&(e={}),e},s=(0,T.arrayMap)(new Array(n),function(){return r()});s.unshift(t,0),e.splice.apply(e,i(s))}var a;switch(n=n||1,e){case"insert_row":var l=B.countSourceRows();if(B.getSettings().maxRows===l)return;t=(0,p.isDefined)(t)?t:l,a=C.createRow(t,n,o),s(w.cellSettings,t,n,"array"),a&&(L.isSelected()&&w.selRange.from.row>=t?(w.selRange.from.row+=a,L.transformEnd(a,0)):L.refreshBorders());break;case"insert_col":a=C.createCol(t,n,o);for(var u=0,c=B.countSourceRows();u<c;u++)w.cellSettings[u]&&s(w.cellSettings[u],t,n);if(a){if(Array.isArray(B.getSettings().colHeaders)){var d=[t,0];d.length+=a,Array.prototype.splice.apply(B.getSettings().colHeaders,d)}L.isSelected()&&w.selRange.from.col>=t?(w.selRange.from.col+=a,L.transformEnd(0,a)):L.refreshBorders()}break;case"remove_row":C.removeRow(t,n,o),w.cellSettings.splice(t,n);var h=B.countRows(),f=B.getSettings().fixedRowsTop;f>=t+1&&(B.getSettings().fixedRowsTop-=Math.min(n,f-t));var g=B.getSettings().fixedRowsBottom;g&&t>=h-g&&(B.getSettings().fixedRowsBottom-=Math.min(n,g)),H.adjustRowsAndCols(),L.refreshBorders();break;case"remove_col":var m=U.toPhysicalColumn(t);C.removeCol(t,n,o);for(var v=0,y=B.countSourceRows();v<y;v++)w.cellSettings[v]&&w.cellSettings[v].splice(m,n);var b=B.getSettings().fixedColumnsLeft;b>=t+1&&(B.getSettings().fixedColumnsLeft-=Math.min(n,b-t)),Array.isArray(B.getSettings().colHeaders)&&(void 0===m&&(m=-1),B.getSettings().colHeaders.splice(m,n)),H.adjustRowsAndCols(),L.refreshBorders();break;default:throw new Error('There is no such action "'+e+'"')}r||H.adjustRowsAndCols()},adjustRowsAndCols:function(){if(w.settings.minRows){var e=B.countRows();if(e<w.settings.minRows)for(var t=0,n=w.settings.minRows;t<n-e;t++)C.createRow(B.countRows(),1,"auto")}if(w.settings.minSpareRows){var o=B.countEmptyRows(!0);if(o<w.settings.minSpareRows)for(;o<w.settings.minSpareRows&&B.countSourceRows()<w.settings.maxRows;o++)C.createRow(B.countRows(),1,"auto")}var i=void 0;if((w.settings.minCols||w.settings.minSpareCols)&&(i=B.countEmptyCols(!0)),w.settings.minCols&&!w.settings.columns&&B.countCols()<w.settings.minCols)for(;B.countCols()<w.settings.minCols;i++)C.createCol(B.countCols(),1,"auto");if(w.settings.minSpareCols&&!w.settings.columns&&"array"===B.dataType&&i<w.settings.minSpareCols)for(;i<w.settings.minSpareCols&&B.countCols()<w.settings.maxCols;i++)C.createCol(B.countCols(),1,"auto");var r=B.countRows(),s=B.countCols();if(0!==r&&0!==s||L.deselect(),L.isSelected()){var a=!1,l=w.selRange.from.row,u=w.selRange.from.col,c=w.selRange.to.row,d=w.selRange.to.col;l>r-1?(l=r-1,a=!0,c>l&&(c=l)):c>r-1&&(c=r-1,a=!0,l>c&&(l=c)),u>s-1?(u=s-1,a=!0,d>u&&(d=u)):d>s-1&&(d=s-1,a=!0,u>d&&(u=d)),a&&B.selectCell(l,u,c,d)}B.view&&B.view.wt.wtOverlays.adjustElementsSize()},populateFromArray:function(e,t,n,o,r,s,a){var u,c,d,h,f=[],g={};if(0===(c=t.length))return!1;var m,v,y,C;null===n||n.row,null===n||n.col;switch(r){case"shift_down":for(m=n?n.col-e.col+1:0,v=n?n.row-e.row+1:0,t=(0,A.translateRowsToColumns)(t),d=0,h=t.length,y=Math.max(h,m);d<y;d++)if(d<h){var b;for(u=0,c=t[d].length;u<v-c;u++)t[d].push(t[d][u%c]);t[d].unshift(e.col+d,e.row,0),(b=B).spliceCol.apply(b,i(t[d]))}else{var T;t[d%h][0]=e.col+d,(T=B).spliceCol.apply(T,i(t[d%h]))}break;case"shift_right":for(m=n?n.col-e.col+1:0,v=n?n.row-e.row+1:0,u=0,c=t.length,C=Math.max(c,v);u<C;u++)if(u<c){var E;for(d=0,h=t[u].length;d<m-h;d++)t[u].push(t[u][d%h]);t[u].unshift(e.row+u,e.col,0),(E=B).spliceRow.apply(E,i(t[u]))}else{var R;t[u%c][0]=e.row+u,(R=B).spliceRow.apply(R,i(t[u%c]))}break;case"overwrite":default:g.row=e.row,g.col=e.col;var O={row:n&&e?n.row-e.row+1:1,col:n&&e?n.col-e.col+1:1},_=0,k=0,M=!0,D=void 0,H=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=t[e%t.length];return null!==n?o[n%o.length]:o},x=t.length,P=n?n.row-e.row+1:0;for(c=n?P:Math.max(x,P),u=0;u<c&&!(n&&g.row>n.row&&P>x||!w.settings.allowInsertRow&&g.row>B.countRows()-1||g.row>=w.settings.maxRows);u++){var N=u-_,L=H(N).length,W=n?n.col-e.col+1:0;if(h=n?W:Math.max(L,W),g.col=e.col,D=B.getCellMeta(g.row,g.col),"CopyPaste.paste"!==o&&"Autofill.autofill"!==o||!D.skipRowOnPaste){for(k=0,d=0;d<h&&!(n&&g.col>n.col&&W>L||!w.settings.allowInsertColumn&&g.col>B.countCols()-1||g.col>=w.settings.maxCols);d++)if(D=B.getCellMeta(g.row,g.col),"CopyPaste.paste"!==o&&"Autofill.fill"!==o||!D.skipColumnOnPaste)if(D.readOnly)g.col++;else{var j=d-k,F=H(N,j),I=B.getDataAtCell(g.row,g.col),V={row:N,col:j};if("Autofill.fill"===o){var Y=B.runHooks("beforeAutofillInsidePopulate",V,s,t,a,{},O);Y&&(F=(0,p.isUndefined)(Y.value)?F:Y.value)}if(null!==F&&"object"===(void 0===F?"undefined":l(F)))if(null===I||"object"!==(void 0===I?"undefined":l(I)))M=!1;else{var z=(0,S.duckSchema)(I[0]||I),U=(0,S.duckSchema)(F[0]||F);(0,S.isObjectEquals)(z,U)?F=(0,S.deepClone)(F):M=!1}else null!==I&&"object"===(void 0===I?"undefined":l(I))&&(M=!1);M&&f.push([g.row,g.col,F]),M=!0,g.col++}else k++,g.col++,h++;g.row++}else _++,g.row++,c++}B.setDataAtCell(f,null,null,o||"populateFromArray")}}},this.selection=L={inProgress:!1,selectedHeader:{cols:!1,rows:!1},setSelectedHeaders:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];B.selection.selectedHeader.rows=e,B.selection.selectedHeader.cols=t,B.selection.selectedHeader.corner=n},begin:function(){B.selection.inProgress=!0},finish:function(){var e=B.getSelected();B.runHooks("afterSelectionEnd",e[0],e[1],e[2],e[3]),B.runHooks("afterSelectionEndByProp",e[0],B.colToProp(e[1]),e[2],B.colToProp(e[3])),B.selection.inProgress=!1},isInProgress:function(){return B.selection.inProgress},setRangeStart:function(e,t){B.runHooks("beforeSetRangeStart",e),w.selRange=new N.CellRange(e,e,e),L.setRangeEnd(e,null,t)},setRangeStartOnly:function(e){B.runHooks("beforeSetRangeStartOnly",e),w.selRange=new N.CellRange(e,e,e)},setRangeEnd:function(e,t,n){if(null!==w.selRange){var o,i=!1,r=!0,s=B.view.wt.wtTable.getFirstVisibleRow(),a=B.view.wt.wtTable.getFirstVisibleColumn(),l={row:null,col:null};B.runHooks("beforeSetRangeEnd",e),B.selection.begin(),l.row=e.row<0?s:e.row,l.col=e.col<0?a:e.col,w.selRange.to=new N.CellCoords(l.row,l.col),w.settings.multiSelect||(w.selRange.from=e),B.view.wt.selections.current.clear(),o=B.getCellMeta(w.selRange.highlight.row,w.selRange.highlight.col).disableVisualSelection,"string"==typeof o&&(o=[o]),(!1===o||Array.isArray(o)&&-1===o.indexOf("current"))&&B.view.wt.selections.current.add(w.selRange.highlight),B.view.wt.selections.area.clear(),(!1===o||Array.isArray(o)&&-1===o.indexOf("area"))&&L.isMultiple()&&(B.view.wt.selections.area.add(w.selRange.from),B.view.wt.selections.area.add(w.selRange.to)),(w.settings.currentHeaderClassName||w.settings.currentRowClassName||w.settings.currentColClassName)&&(B.view.wt.selections.highlight.clear(),B.view.wt.selections.highlight.add(w.selRange.from),B.view.wt.selections.highlight.add(w.selRange.to));var u=(0,S.createObjectPropListener)("value");B.runHooks("afterSelection",w.selRange.from.row,w.selRange.from.col,w.selRange.to.row,w.selRange.to.col,u),B.runHooks("afterSelectionByProp",w.selRange.from.row,C.colToProp(w.selRange.from.col),w.selRange.to.row,C.colToProp(w.selRange.to.col),u),(0===w.selRange.from.row&&w.selRange.to.row===B.countRows()-1&&B.countRows()>1||0===w.selRange.from.col&&w.selRange.to.col===B.countCols()-1&&B.countCols()>1)&&(i=!0),(e.row<0||e.col<0)&&(r=!1),u.isTouched()&&(t=!u.value),!1!==t&&!i&&r&&(w.selRange.from&&!L.isMultiple()?B.view.scrollViewport(w.selRange.from):B.view.scrollViewport(e)),L.selectedHeader.rows&&L.selectedHeader.cols?(0,d.addClass)(B.rootElement,["ht__selection--rows","ht__selection--columns"]):L.selectedHeader.rows?((0,d.removeClass)(B.rootElement,"ht__selection--columns"),(0,d.addClass)(B.rootElement,"ht__selection--rows")):L.selectedHeader.cols?((0,d.removeClass)(B.rootElement,"ht__selection--rows"),(0,d.addClass)(B.rootElement,"ht__selection--columns")):(0,d.removeClass)(B.rootElement,["ht__selection--rows","ht__selection--columns"]),L.refreshBorders(null,n)}},refreshBorders:function(e,t){t||j.destroyEditor(e),B.view.render(),L.isSelected()&&!t&&j.prepareEditor()},isMultiple:function(){var e=!(w.selRange.to.col===w.selRange.from.col&&w.selRange.to.row===w.selRange.from.row),t=B.runHooks("afterIsMultipleSelection",e);if(e)return t},transformStart:function(e,t,n,o){var i,r,s,a,l=new N.CellCoords(e,t),u=0,c=0;B.runHooks("modifyTransformStart",l),i=B.countRows(),r=B.countCols(),a=B.getSettings().fixedRowsBottom,w.selRange.highlight.row+e>i-1?n&&w.settings.minSpareRows>0&&!(a&&w.selRange.highlight.row>=i-a-1)?(B.alter("insert_row",i),i=B.countRows()):w.settings.autoWrapCol&&(l.row=1-i,l.col=w.selRange.highlight.col+l.col==r-1?1-r:1):w.settings.autoWrapCol&&w.selRange.highlight.row+l.row<0&&w.selRange.highlight.col+l.col>=0&&(l.row=i-1,l.col=w.selRange.highlight.col+l.col==0?r-1:-1),w.selRange.highlight.col+l.col>r-1?n&&w.settings.minSpareCols>0?(B.alter("insert_col",r),r=B.countCols()):w.settings.autoWrapRow&&(l.row=w.selRange.highlight.row+l.row==i-1?1-i:1,l.col=1-r):w.settings.autoWrapRow&&w.selRange.highlight.col+l.col<0&&w.selRange.highlight.row+l.row>=0&&(l.row=w.selRange.highlight.row+l.row==0?i-1:-1,l.col=r-1),s=new N.CellCoords(w.selRange.highlight.row+l.row,w.selRange.highlight.col+l.col),s.row<0?(u=-1,s.row=0):s.row>0&&s.row>=i&&(u=1,s.row=i-1),s.col<0?(c=-1,s.col=0):s.col>0&&s.col>=r&&(c=1,s.col=r-1),B.runHooks("afterModifyTransformStart",s,u,c),L.setRangeStart(s,o)},transformEnd:function(e,t){var n,o,i,r=new N.CellCoords(e,t),s=0,a=0;B.runHooks("modifyTransformEnd",r),n=B.countRows(),o=B.countCols(),i=new N.CellCoords(w.selRange.to.row+r.row,w.selRange.to.col+r.col),i.row<0?(s=-1,i.row=0):i.row>0&&i.row>=n&&(s=1,i.row=n-1),i.col<0?(a=-1,i.col=0):i.col>0&&i.col>=o&&(a=1,i.col=o-1),B.runHooks("afterModifyTransformEnd",i,s,a),L.setRangeEnd(i,!0)},isSelected:function(){return null!==w.selRange},inInSelection:function(e){return!!L.isSelected()&&w.selRange.includes(e)},deselect:function(){L.isSelected()&&(B.selection.inProgress=!1,w.selRange=null,B.view.wt.selections.current.clear(),B.view.wt.selections.area.clear(),(w.settings.currentHeaderClassName||w.settings.currentRowClassName||w.settings.currentColClassName)&&B.view.wt.selections.highlight.clear(),j.destroyEditor(),L.refreshBorders(),(0,d.removeClass)(B.rootElement,["ht__selection--rows","ht__selection--columns"]),B.runHooks("afterDeselect"))},selectAll:function(){w.settings.multiSelect&&(L.setSelectedHeaders(!0,!0,!0),L.setRangeStart(new N.CellCoords(0,0)),L.setRangeEnd(new N.CellCoords(B.countRows()-1,B.countCols()-1),!1))},empty:function(){if(L.isSelected()){var e,t,n=w.selRange.getTopLeftCorner(),o=w.selRange.getBottomRightCorner(),i=[];for(e=n.row;e<=o.row;e++)for(t=n.col;t<=o.col;t++)B.getCellMeta(e,t).readOnly||i.push([e,t,""]);B.setDataAtCell(i)}}},this.init=function(){M.setData(w.settings.data),B.runHooks("beforeInit"),(0,g.isMobileBrowser)()&&(0,d.addClass)(B.rootElement,"mobile"),this.updateSettings(w.settings,!0),this.view=new D.default(this),j=new y.default(B,w,L,C),this.forceFullRender=!0,B.runHooks("init"),this.view.render(),"object"===l(w.firstRun)&&(B.runHooks("afterChange",w.firstRun[0],w.firstRun[1]),w.firstRun=!1),B.runHooks("afterInit")},this.validateCell=function(e,t,n,o){function i(e){var o=t.visualCol,i=t.visualRow,r=B.getCell(i,o,!0);r&&"TH"!=r.nodeName&&B.view.wt.wtSettings.settings.cellRenderer(i,o,r),n(e)}var r=B.getCellValidator(t);(0,p.isRegExp)(r)&&(r=function(e){return function(t,n){n(e.test(t))}}(r)),(0,f.isFunction)(r)?(e=B.runHooks("beforeValidate",e,t.visualRow,t.prop,o),B._registerTimeout(setTimeout(function(){r.call(t,e,function(n){n=B.runHooks("afterValidate",n,e,t.visualRow,t.prop,o),t.valid=n,i(n),B.runHooks("postAfterValidate",n,e,t.visualRow,t.prop,o)})},0))):B._registerTimeout(setTimeout(function(){t.valid=!0,i(t.valid)},0))},this.setDataAtCell=function(e,t,n,i){var a,u,c,d=s(e,t,n),h=[];for(a=0,u=d.length;a<u;a++){if("object"!==l(d[a]))throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof d[a][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");c=C.colToProp(d[a][1]),h.push([d[a][0],c,M.getAtCell(U.toPhysicalRow(d[a][0]),d[a][1]),d[a][2]])}i||"object"!==(void 0===e?"undefined":l(e))||(i=t),B.runHooks("afterSetDataAtCell",h,i),o(h,i,function(){r(h,i)})},this.setDataAtRowProp=function(e,t,n,i){var a,u,c=s(e,t,n),d=[];for(a=0,u=c.length;a<u;a++)d.push([c[a][0],c[a][1],M.getAtCell(U.toPhysicalRow(c[a][0]),c[a][1]),c[a][2]]);i||"object"!==(void 0===e?"undefined":l(e))||(i=t),B.runHooks("afterSetDataAtRowProp",d,i),o(d,i,function(){r(d,i)})},this.listen=function(){var e=!document.activeElement||document.activeElement&&void 0===document.activeElement.nodeName;document.activeElement&&document.activeElement!==document.body&&!e?document.activeElement.blur():e&&document.body.focus(),V=B.guid},this.unlisten=function(){this.isListening()&&(V=null)},this.isListening=function(){return V===B.guid},this.destroyEditor=function(e){L.refreshBorders(e)},this.populateFromArray=function(e,t,n,o,i,r,s,a,u){var c;if("object"!==(void 0===n?"undefined":l(n))||"object"!==l(n[0]))throw new Error("populateFromArray parameter `input` must be an array of arrays");return c="number"==typeof o?new N.CellCoords(o,i):null,H.populateFromArray(new N.CellCoords(e,t),n,c,r,s,a,u)},this.spliceCol=function(e,t,n){var o;return(o=C).spliceCol.apply(o,arguments)},this.spliceRow=function(e,t,n){var o;return(o=C).spliceRow.apply(o,arguments)},this.getSelected=function(){if(L.isSelected())return[w.selRange.from.row,w.selRange.from.col,w.selRange.to.row,w.selRange.to.col]},this.getSelectedRange=function(){if(L.isSelected())return w.selRange},this.render=function(){B.view&&(B.renderCall=!0,B.forceFullRender=!0,L.refreshBorders(null,!0))},this.loadData=function(e){if(Array.isArray(w.settings.dataSchema)?B.dataType="array":(0,f.isFunction)(w.settings.dataSchema)?B.dataType="function":B.dataType="object",C&&C.destroy(),C=new v.default(B,w,Y),"object"===(void 0===e?"undefined":l(e))&&null!==e)e.push&&e.splice||(e=[e]);else{if(null!==e)throw new Error("loadData only accepts array of objects or array of arrays ("+(void 0===e?"undefined":l(e))+" given)");e=[];var t,n=0,o=0,i=C.getSchema();for(n=0,o=w.settings.startRows;n<o;n++)if("object"!==B.dataType&&"function"!==B.dataType||!w.settings.dataSchema)if("array"===B.dataType)t=(0,S.deepClone)(i[0]),e.push(t);else{t=[];for(var r=0,s=w.settings.startCols;r<s;r++)t.push(null);e.push(t)}else t=(0,S.deepClone)(i),e.push(t)}w.isPopulated=!1,Y.prototype.data=e,Array.isArray(e[0])&&(B.dataType="array"),C.dataSource=e,M.data=e,M.dataType=B.dataType,M.colToProp=C.colToProp.bind(C),M.propToCol=C.propToCol.bind(C),function(){w.cellSettings.length=0}(),H.adjustRowsAndCols(),B.runHooks("afterLoadData",w.firstRun),w.firstRun?w.firstRun=[null,"loadData"]:(B.runHooks("afterChange",null,"loadData"),B.render()),w.isPopulated=!0},this.getData=function(e,t,n,o){return(0,p.isUndefined)(e)?C.getAll():C.getRange(new N.CellCoords(e,t),new N.CellCoords(n,o),C.DESTINATION_RENDERER)},this.getCopyableText=function(e,t,n,o){return C.getCopyableText(new N.CellCoords(e,t),new N.CellCoords(n,o))},this.getCopyableData=function(e,t){return C.getCopyable(e,C.colToProp(t))},this.getSchema=function(){return C.getSchema()},this.updateSettings=function(e,t){var n=!1,o=void 0,i=void 0,r=void 0;if((0,p.isDefined)(e.rows))throw new Error('"rows" setting is no longer supported. do you mean startRows, minRows or maxRows?');if((0,p.isDefined)(e.cols))throw new Error('"cols" setting is no longer supported. do you mean startCols, minCols or maxCols?');for(o in e)"data"!==o&&(W.default.getSingleton().getRegistered().indexOf(o)>-1?((0,f.isFunction)(e[o])||Array.isArray(e[o]))&&(e[o].initialHook=!0,B.addHook(o,e[o])):!t&&(0,S.hasOwnProperty)(e,o)&&(Y.prototype[o]=e[o]));void 0===e.data&&void 0===w.settings.data?B.loadData(null):void 0!==e.data?B.loadData(e.data):void 0!==e.columns&&C.createMap(),r=B.countCols();var s=e.columns||Y.prototype.columns;if(s&&(0,f.isFunction)(s)&&(r=B.countSourceCols(),n=!0),void 0===e.cell&&void 0===e.cells&&void 0===e.columns||(w.cellSettings.length=0),r>0){var a=void 0,l=void 0;for(o=0,i=0;o<r;o++)n&&!s(o)||(w.columnSettings[i]=(0,h.columnFactory)(Y,w.columnsSettingConflicts),a=w.columnSettings[i].prototype,s&&(l=n?s(o):s[i])&&((0,S.extend)(a,l),(0,S.extend)(a,u(l))),i++)}if((0,p.isDefined)(e.cell))for(var c in e.cell)if((0,S.hasOwnProperty)(e.cell,c)){var g=e.cell[c];B.setCellMetaObject(g.row,g.col,g)}B.runHooks("afterCellMetaReset"),(0,p.isDefined)(e.className)&&(Y.prototype.className&&(0,d.removeClass)(B.rootElement,Y.prototype.className),e.className&&(0,d.addClass)(B.rootElement,e.className));var m=B.rootElement.style.height;""!==m&&(m=parseInt(B.rootElement.style.height,10));var v=e.height;if((0,f.isFunction)(v)&&(v=v()),t){B.rootElement.getAttribute("style")&&B.rootElement.setAttribute("data-initialstyle",B.rootElement.getAttribute("style"))}if(null===v){var y=B.rootElement.getAttribute("data-initialstyle");y&&(y.indexOf("height")>-1||y.indexOf("overflow")>-1)?B.rootElement.setAttribute("style",y):(B.rootElement.style.height="",B.rootElement.style.overflow="")}else void 0!==v&&(B.rootElement.style.height=v+"px",B.rootElement.style.overflow="hidden");if(void 0!==e.width){var b=e.width;(0,f.isFunction)(b)&&(b=b()),B.rootElement.style.width=b+"px"}t||(C.clearLengthCache(),B.view&&B.view.wt.wtViewport.resetHasOversizedColumnHeadersMarked(),B.runHooks("afterUpdateSettings")),H.adjustRowsAndCols(),B.view&&!w.firstRun&&(B.forceFullRender=!0,L.refreshBorders(null,!0)),t||!B.view||""!==m&&""!==v&&void 0!==v||m===v||B.view.wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){var e=B.getSelected();if(Y.prototype.getValue){if((0,f.isFunction)(Y.prototype.getValue))return Y.prototype.getValue.call(B);if(e)return B.getData()[e[0]][Y.prototype.getValue]}else if(e)return B.getDataAtCell(e[0],e[1])},this.getSettings=function(){return w.settings},this.clear=function(){L.selectAll(),L.empty()},this.alter=function(e,t,n,o,i){H.alter(e,t,n,o,i)},this.getCell=function(e,t,n){return B.view.getCellAtCoords(new N.CellCoords(e,t),n)},this.getCoords=function(e){return this.view.wt.wtTable.getCoords.call(this.view.wt.wtTable,e)},this.colToProp=function(e){return C.colToProp(e)},this.propToCol=function(e){return C.propToCol(e)},this.toVisualRow=function(e){return U.toVisualRow(e)},this.toVisualColumn=function(e){return U.toVisualColumn(e)},this.toPhysicalRow=function(e){return U.toPhysicalRow(e)},this.toPhysicalColumn=function(e){return U.toPhysicalColumn(e)},this.getDataAtCell=function(e,t){return C.get(e,C.colToProp(t))},this.getDataAtRowProp=function(e,t){return C.get(e,t)},this.getDataAtCol=function(e){var t=[];return t.concat.apply(t,i(C.getRange(new N.CellCoords(0,e),new N.CellCoords(w.settings.data.length-1,e),C.DESTINATION_RENDERER)))},this.getDataAtProp=function(e){var t,n=[];return t=C.getRange(new N.CellCoords(0,C.propToCol(e)),new N.CellCoords(w.settings.data.length-1,C.propToCol(e)),C.DESTINATION_RENDERER),n.concat.apply(n,i(t))},this.getSourceData=function(e,t,n,o){return void 0===e?M.getData():M.getByRange(new N.CellCoords(e,t),new N.CellCoords(n,o))},this.getSourceDataArray=function(e,t,n,o){return void 0===e?M.getData(!0):M.getByRange(new N.CellCoords(e,t),new N.CellCoords(n,o),!0)},this.getSourceDataAtCol=function(e){return M.getAtColumn(e)},this.getSourceDataAtRow=function(e){return M.getAtRow(e)},this.getSourceDataAtCell=function(e,t){return M.getAtCell(e,t)},this.getDataAtRow=function(e){return C.getRange(new N.CellCoords(e,0),new N.CellCoords(e,this.countCols()-1),C.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(e,t,n,o){var i=this,r=null,s=null;void 0===e&&(e=0,n=this.countRows(),t=0,o=this.countCols()),void 0===n&&(n=e),void 0===o&&(o=t);var a="mixed";return(0,k.rangeEach)(Math.min(e,n),Math.max(e,n),function(e){var n=!0;return(0,k.rangeEach)(Math.min(t,o),Math.max(t,o),function(t){var o=i.getCellMeta(e,t);return s=o.type,r?n=r===s:r=s,n}),a=n?s:"mixed",n}),a},this.removeCellMeta=function(e,t,n){void 0!=B.getCellMeta(e,t)[n]&&delete w.cellSettings[e][t][n]},this.spliceCellsMeta=function(e,t){for(var n,o=arguments.length,i=Array(o>2?o-2:0),r=2;r<o;r++)i[r-2]=arguments[r];(n=w.cellSettings).splice.apply(n,[e,t].concat(i))},this.setCellMetaObject=function(e,t,n){if("object"===(void 0===n?"undefined":l(n)))for(var o in n)if((0,S.hasOwnProperty)(n,o)){var i=n[o];this.setCellMeta(e,t,o,i)}},this.setCellMeta=function(e,t,n,o){var i=U.toPhysical(e,t),r=a(i,2);e=r[0],t=r[1],w.columnSettings[t]||(w.columnSettings[t]=(0,h.columnFactory)(Y,w.columnsSettingConflicts)),w.cellSettings[e]||(w.cellSettings[e]=[]),w.cellSettings[e][t]||(w.cellSettings[e][t]=new w.columnSettings[t]),w.cellSettings[e][t][n]=o,B.runHooks("afterSetCellMeta",e,t,n,o)},this.getCellsMeta=function(){return(0,T.arrayFlatten)(w.cellSettings)},this.getCellMeta=function(e,t){var n,o=C.colToProp(t),i=e,r=t,s=U.toPhysical(e,t),l=a(s,2);if(e=l[0],t=l[1],w.columnSettings[t]||(w.columnSettings[t]=(0,h.columnFactory)(Y,w.columnsSettingConflicts)),w.cellSettings[e]||(w.cellSettings[e]=[]),w.cellSettings[e][t]||(w.cellSettings[e][t]=new w.columnSettings[t]),n=w.cellSettings[e][t],n.row=e,n.col=t,n.visualRow=i,n.visualCol=r,n.prop=o,n.instance=B,B.runHooks("beforeGetCellMeta",e,t,n),(0,S.extend)(n,u(n)),n.cells){var c=n.cells.call(n,e,t,o);c&&((0,S.extend)(n,c),(0,S.extend)(n,u(c)))}return B.runHooks("afterGetCellMeta",e,t,n),n},this.getCellMetaAtRow=function(e){return w.cellSettings[e]},this.isColumnModificationAllowed=function(){return!("object"===B.dataType||B.getSettings().columns)};var G=(0,A.cellMethodLookupFactory)("renderer");this.getCellRenderer=function(e,t){return(0,R.getRenderer)(G.call(this,e,t))},this.getCellEditor=(0,A.cellMethodLookupFactory)("editor");var K=(0,A.cellMethodLookupFactory)("validator");this.getCellValidator=function(e,t){var n=K.call(this,e,t);return"string"==typeof n&&(n=(0,O.getValidator)(n)),n},this.validateCells=function(e){var t=new n;e&&(t.onQueueEmpty=e);for(var o=B.countRows()-1;o>=0;){for(var i=B.countCols()-1;i>=0;)t.addValidatorToQueue(),B.validateCell(B.getDataAtCell(o,i),B.getCellMeta(o,i),function(e){if("boolean"!=typeof e)throw new Error("Validation error: result is not boolean");!1===e&&(t.valid=!1),t.removeValidatorFormQueue()},"validateCells"),i--;o--}t.checkIfQueueIsEmpty()},this.getRowHeader=function(e){var t=w.settings.rowHeaders;return void 0!==e&&(e=B.runHooks("modifyRowHeader",e)),void 0===e?(t=[],(0,k.rangeEach)(B.countRows()-1,function(e){t.push(B.getRowHeader(e))})):Array.isArray(t)&&void 0!==t[e]?t=t[e]:(0,f.isFunction)(t)?t=t(e):t&&"string"!=typeof t&&"number"!=typeof t&&(t=e+1),t},this.hasRowHeaders=function(){return!!w.settings.rowHeaders},this.hasColHeaders=function(){if(void 0!==w.settings.colHeaders&&null!==w.settings.colHeaders)return!!w.settings.colHeaders;for(var e=0,t=B.countCols();e<t;e++)if(B.getColHeader(e))return!0;return!1},this.getColHeader=function(e){var t=w.settings.columns&&(0,f.isFunction)(w.settings.columns),n=w.settings.colHeaders;if(void 0===(e=B.runHooks("modifyColHeader",e))){for(var o=[],i=t?B.countSourceCols():B.countCols(),r=0;r<i;r++)o.push(B.getColHeader(r));n=o}else{var s=e;e=B.runHooks("modifyCol",e);var a=function(e){for(var t=[],n=B.countSourceCols(),o=0;o<n;o++)(0,f.isFunction)(B.getSettings().columns)&&B.getSettings().columns(o)&&t.push(o);return t[e]}(e);w.settings.columns&&(0,f.isFunction)(w.settings.columns)&&w.settings.columns(a)&&w.settings.columns(a).title?n=w.settings.columns(a).title:w.settings.columns&&w.settings.columns[e]&&w.settings.columns[e].title?n=w.settings.columns[e].title:Array.isArray(w.settings.colHeaders)&&void 0!==w.settings.colHeaders[e]?n=w.settings.colHeaders[e]:(0,f.isFunction)(w.settings.colHeaders)?n=w.settings.colHeaders(e):w.settings.colHeaders&&"string"!=typeof w.settings.colHeaders&&"number"!=typeof w.settings.colHeaders&&(n=(0,A.spreadsheetColumnLabel)(s))}return n},this._getColWidthFromSettings=function(e){var t=B.getCellMeta(0,e),n=t.width;if(void 0!==n&&n!==w.settings.width||(n=t.colWidths),void 0!==n&&null!==n){switch(void 0===n?"undefined":l(n)){case"object":n=n[e];break;case"function":n=n(e)}"string"==typeof n&&(n=parseInt(n,10))}return n},this.getColWidth=function(e){var t=B._getColWidthFromSettings(e);return t=B.runHooks("modifyColWidth",t,e),void 0===t&&(t=N.ViewportColumnsCalculator.DEFAULT_WIDTH),t},this._getRowHeightFromSettings=function(e){var t=w.settings.rowHeights;if(void 0!==t&&null!==t){switch(void 0===t?"undefined":l(t)){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getRowHeight=function(e){var t=B._getRowHeightFromSettings(e);return t=B.runHooks("modifyRowHeight",t,e)},this.countSourceRows=function(){return B.runHooks("modifySourceLength")||(B.getSourceData()?B.getSourceData().length:0)},this.countSourceCols=function(){var e=B.getSourceData()&&B.getSourceData()[0]?B.getSourceData()[0]:[];return(0,S.isObject)(e)?(0,S.deepObjectSize)(e):e.length||0},this.countRows=function(){return C.getLength()},this.countCols=function(){var e=this.getSettings().maxCols,t=!1,n=0;if("array"===B.dataType&&(t=w.settings.data&&w.settings.data[0]&&w.settings.data[0].length),t&&(n=w.settings.data[0].length),w.settings.columns){if((0,f.isFunction)(w.settings.columns))if("array"===B.dataType){for(var o=0,i=0;i<n;i++)w.settings.columns(i)&&o++;n=o}else"object"!==B.dataType&&"function"!==B.dataType||(n=C.colToPropCache.length);else n=w.settings.columns.length}else"object"!==B.dataType&&"function"!==B.dataType||(n=C.colToPropCache.length);return Math.min(e,n)},this.rowOffset=function(){return B.view.wt.wtTable.getFirstRenderedRow()},this.colOffset=function(){return B.view.wt.wtTable.getFirstRenderedColumn()},this.countRenderedRows=function(){return B.view.wt.drawn?B.view.wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return B.view.wt.drawn?B.view.wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return B.view.wt.drawn?B.view.wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return B.view.wt.drawn?B.view.wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(e){for(var t,n=B.countRows()-1,o=0;n>=0;){if(t=B.runHooks("modifyRow",n),B.isEmptyRow(t))o++;else if(e)break;n--}return o},this.countEmptyCols=function(e){if(B.countRows()<1)return 0;for(var t=B.countCols()-1,n=0;t>=0;){if(B.isEmptyCol(t))n++;else if(e)break;t--}return n},this.isEmptyRow=function(e){return w.settings.isEmptyRow.call(B,e)},this.isEmptyCol=function(e){return w.settings.isEmptyCol.call(B,e)},this.selectCell=function(e,t,n,o,i,r){var s;if(r=(0,p.isUndefined)(r)||!0===r,"number"!=typeof e||e<0||e>=B.countRows())return!1;if("number"!=typeof t||t<0||t>=B.countCols())return!1;if((0,p.isDefined)(n)){if("number"!=typeof n||n<0||n>=B.countRows())return!1;if("number"!=typeof o||o<0||o>=B.countCols())return!1}return s=new N.CellCoords(e,t),w.selRange=new N.CellRange(s,s,s),r&&B.listen(),(0,p.isUndefined)(n)?L.setRangeEnd(w.selRange.from,i):L.setRangeEnd(new N.CellCoords(n,o),i),B.selection.finish(),!0},this.selectCellByProp=function(e,t,n,o,i){var r;return arguments[1]=C.propToCol(arguments[1]),(0,p.isDefined)(arguments[3])&&(arguments[3]=C.propToCol(arguments[3])),(r=B).selectCell.apply(r,arguments)},this.deselectCell=function(){L.deselect()},this.scrollViewportTo=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(void 0!==e&&(e<0||e>=B.countRows()))return!1;if(void 0!==t&&(t<0||t>=B.countCols()))return!1;var i=!1;return void 0!==e&&void 0!==t&&(B.view.wt.wtOverlays.topOverlay.scrollTo(e,n),B.view.wt.wtOverlays.leftOverlay.scrollTo(t,o),i=!0),"number"==typeof e&&"number"!=typeof t&&(B.view.wt.wtOverlays.topOverlay.scrollTo(e,n),i=!0),"number"==typeof t&&"number"!=typeof e&&(B.view.wt.wtOverlays.leftOverlay.scrollTo(t,o),i=!0),i},this.destroy=function(){B._clearTimeouts(),B.view&&B.view.destroy(),M&&M.destroy(),M=null,(0,d.empty)(B.rootElement),z.destroy(),B.runHooks("afterDestroy"),W.default.getSingleton().destroy(B);for(var e in B)(0,S.hasOwnProperty)(B,e)&&((0,f.isFunction)(B[e])?B[e]=m:"guid"!==e&&(B[e]=null));C&&C.destroy(),C=null,w=null,H=null,L=null,j=null,B=null,Y=null},this.getActiveEditor=function(){return j.getActiveEditor()},this.getPlugin=function(e){return(0,E.getPlugin)(this,e)},this.getInstance=function(){return B},this.addHook=function(e,t){W.default.getSingleton().add(e,t,B)},this.hasHook=function(e){return W.default.getSingleton().has(e,B)},this.addHookOnce=function(e,t){W.default.getSingleton().once(e,t,B)},this.removeHook=function(e,t){W.default.getSingleton().remove(e,t,B)},this.runHooks=function(e,t,n,o,i,r,s){return W.default.getSingleton().run(B,e,t,n,o,i,r,s)},this.timeouts=[],this._registerTimeout=function(e){this.timeouts.push(e)},this._clearTimeouts=function(){for(var e=0,t=this.timeouts.length;e<t;e++)clearTimeout(this.timeouts[e])},W.default.getSingleton().run(B,"construct")}t.__esModule=!0;var a=function(){function e(e,t){var n=[],o=!0,i=!1,r=void 0;try{for(var s,a=e[Symbol.iterator]();!(o=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);o=!0);}catch(e){i=!0,r=e}finally{try{!o&&a.return&&a.return()}finally{if(i)throw r}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return void 0===e?"undefined":s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":s(e)};t.default=r;var u=n(49),c=o(u),d=n(0),h=n(63),f=n(38),p=n(28),g=n(20),m=n(304),v=o(m),w=n(306),y=o(w),C=n(6),b=o(C),S=n(2),T=n(7),E=n(39),R=n(3),O=n(19),_=n(29),k=n(18),M=n(326),D=o(M),H=n(305),x=o(H),A=n(62),P=n(258),N=n(30),L=n(21),W=o(L),j=n(82),F=o(j),I=n(61),V=null},function(e,t,n){function o(){}t.__esModule=!0;var i="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return void 0===e?"undefined":s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":s(e)},r=n(28),a=n(2);o.prototype={data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:void 0,colHeaders:null,colWidths:void 0,rowHeights:void 0,columns:void 0,cells:void 0,cell:[],comments:!1,customBorders:!1,minRows:0,minCols:0,maxRows:1/0,maxCols:1/0,minSpareRows:0,minSpareCols:0,allowInsertRow:!0,allowInsertColumn:!0,allowRemoveRow:!0,allowRemoveColumn:!0,multiSelect:!0,fillHandle:!0,fixedRowsTop:0,fixedRowsBottom:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!1,autoWrapCol:!1,persistentState:void 0,currentRowClassName:void 0,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",className:void 0,tableClassName:void 0,stretchH:"none",isEmptyRow:function(e){var t,n,o,s;for(t=0,n=this.countCols();t<n;t++)if(""!==(o=this.getDataAtCell(e,t))&&null!==o&&(0,r.isDefined)(o))return"object"===(void 0===o?"undefined":i(o))&&(s=this.getCellMeta(e,t),(0,a.isObjectEquals)(this.getSchema()[s.prop],o));return!0},isEmptyCol:function(e){var t,n,o;for(t=0,n=this.countRows();t<n;t++)if(""!==(o=this.getDataAtCell(t,e))&&null!==o&&(0,r.isDefined)(o))return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,allowEmpty:!0,invalidCellClassName:"htInvalid",placeholder:!1,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",renderer:void 0,commentedCellClassName:"htCommentCell",fragmentSelection:!1,readOnly:!1,skipColumnOnPaste:!1,search:!1,type:"text",copyable:!0,editor:void 0,autoComplete:void 0,visibleRows:10,trimDropdown:!0,debug:!1,wordWrap:!0,noWordWrapClassName:"htNoWrap",contextMenu:void 0,copyPaste:!0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,mergeCells:!1,viewportRowRenderingOffset:"auto",viewportColumnRenderingOffset:"auto",validator:void 0,disableVisualSelection:!1,sortIndicator:void 0,manualColumnFreeze:void 0,trimWhitespace:!0,settings:void 0,source:void 0,title:void 0,checkedTemplate:void 0,uncheckedTemplate:void 0,label:void 0,format:void 0,language:void 0,selectOptions:void 0,autoColumnSize:void 0,autoRowSize:void 0,dateFormat:void 0,correctFormat:!1,defaultDate:void 0,strict:void 0,allowHtml:!1,renderAllRows:void 0,preventOverflow:!1,bindRowsWithHeaders:void 0,collapsibleColumns:void 0,columnSummary:void 0,dropdownMenu:void 0,filters:void 0,formulas:void 0,ganttChart:void 0,headerTooltips:void 0,hiddenColumns:void 0,hiddenRows:void 0,nestedHeaders:void 0,trimRows:void 0,rowHeaderWidth:void 0,columnHeaderHeight:void 0,observeChanges:void 0,sortFunction:void 0,sortByRelevance:!0,filter:!0,filteringCaseSensitive:!1},t.default=o},function(e,t,n){function o(e){var t=new Date(e);return isNaN(new Date(e+"T00:00").getDate())?t:new Date(t.getTime()+6e4*t.getTimezoneOffset())}t.__esModule=!0,t.getNormalizedDate=o},function(e,t,n){var o=n(1);o(o.P,"Array",{copyWithin:n(332)}),n(32)("copyWithin")},function(e,t,n){var o=n(1);o(o.P,"Array",{fill:n(333)}),n(32)("fill")},function(e,t,n){var o=n(1),i=n(52)(6),r="findIndex",s=!0;r in[]&&Array(1)[r](function(){s=!1}),o(o.P+o.F*s,"Array",{findIndex:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n(32)(r)},function(e,t,n){var o=n(1),i=n(52)(5),r=!0;"find"in[]&&Array(1).find(function(){r=!1}),o(o.P+o.F*r,"Array",{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n(32)("find")},function(e,t,n){var o=n(23),i=n(1),r=n(36),s=n(269),a=n(265),l=n(17),u=n(67),c=n(280);i(i.S+i.F*!n(72)(function(e){Array.from(e)}),"Array",{from:function(e){var t,n,i,d,h=r(e),f="function"==typeof this?this:Array,p=arguments.length,g=p>1?arguments[1]:void 0,m=void 0!==g,v=0,w=c(h);if(m&&(g=o(g,p>2?arguments[2]:void 0,2)),void 0==w||f==Array&&a(w))for(t=l(h.length),n=new f(t);t>v;v++)u(n,v,m?g(h[v],v):h[v]);else for(d=w.call(h),n=new f;!(i=d.next()).done;v++)u(n,v,m?s(d,g,[i.value,v],!0):i.value);return n.length=v,n}})},function(e,t,n){var o=n(1),i=n(67);o(o.S+o.F*n(25)(function(){function e(){}return!(Array.of.call(e)instanceof e)}),"Array",{of:function(){for(var e=0,t=arguments.length,n=new("function"==typeof this?this:Array)(t);t>e;)i(n,e,arguments[e++]);return n.length=t,n}})},function(e,t,n){var o=n(12).f,i=n(35),r=n(15),s=Function.prototype,a=/^\s*function ([^ (]*)/,l=Object.isExtensible||function(){return!0};"name"in s||n(14)&&o(s,"name",{configurable:!0,get:function(){try{var e=this,t=(""+e).match(a)[1];return r(e,"name")||!l(e)||o(e,"name",i(5,t)),t}catch(e){return""}}})},function(e,t,n){var o=n(261);e.exports=n(53)("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=o.getEntry(this,e);return t&&t.v},set:function(e,t){return o.def(this,0===e?0:e,t)}},o,!0)},function(e,t,n){var o=n(1);o(o.S,"Number",{EPSILON:Math.pow(2,-52)})},function(e,t,n){var o=n(1),i=n(5).isFinite;o(o.S,"Number",{isFinite:function(e){return"number"==typeof e&&i(e)}})},function(e,t,n){var o=n(1);o(o.S,"Number",{isInteger:n(267)})},function(e,t,n){var o=n(1);o(o.S,"Number",{isNaN:function(e){return e!=e}})},function(e,t,n){var o=n(1),i=n(267),r=Math.abs;o(o.S,"Number",{isSafeInteger:function(e){return i(e)&&r(e)<=9007199254740991}})},function(e,t,n){var o=n(1);o(o.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(e,t,n){var o=n(1);o(o.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(e,t,n){var o=n(1);o(o.S+o.F,"Object",{assign:n(272)})},function(e,t,n){var o=n(1);o(o.S,"Object",{is:n(347)})},function(e,t,n){var o=n(1);o(o.S,"Object",{setPrototypeOf:n(275).set})},function(e,t,n){var o,i,r,s=n(56),a=n(5),l=n(23),u=n(260),c=n(1),d=n(9),h=n(66),f=n(51),p=n(55),g=n(348),m=n(79).set,v=n(342)(),w=a.TypeError,y=a.process,C=a.Promise,y=a.process,b="process"==u(y),S=function(){},T=!!function(){try{var e=C.resolve(1),t=(e.constructor={})[n(4)("species")]=function(e){e(S,S)};return(b||"function"==typeof PromiseRejectionEvent)&&e.then(S)instanceof t}catch(e){}}(),E=function(e,t){return e===t||e===C&&t===r},R=function(e){var t;return!(!d(e)||"function"!=typeof(t=e.then))&&t},O=function(e){return E(C,e)?new _(e):new i(e)},_=i=function(e){var t,n;this.promise=new e(function(e,o){if(void 0!==t||void 0!==n)throw w("Bad Promise constructor");t=e,n=o}),this.resolve=h(t),this.reject=h(n)},k=function(e){try{e()}catch(e){return{error:e}}},M=function(e,t){if(!e._n){e._n=!0;var n=e._c;v(function(){for(var o=e._v,i=1==e._s,r=0;n.length>r;)!function(t){var n,r,s=i?t.ok:t.fail,a=t.resolve,l=t.reject,u=t.domain;try{s?(i||(2==e._h&&x(e),e._h=1),!0===s?n=o:(u&&u.enter(),n=s(o),u&&u.exit()),n===t.promise?l(w("Promise-chain cycle")):(r=R(n))?r.call(n,a,l):a(n)):l(o)}catch(e){l(e)}}(n[r++]);e._c=[],e._n=!1,t&&!e._h&&D(e)})}},D=function(e){m.call(a,function(){var t,n,o,i=e._v;if(H(e)&&(t=k(function(){b?y.emit("unhandledRejection",i,e):(n=a.onunhandledrejection)?n({promise:e,reason:i}):(o=a.console)&&o.error&&o.error("Unhandled promise rejection",i)}),e._h=b||H(e)?2:1),e._a=void 0,t)throw t.error})},H=function e(t){if(1==t._h)return!1;for(var n,o=t._a||t._c,i=0;o.length>i;)if(n=o[i++],n.fail||!e(n.promise))return!1;return!0},x=function(e){m.call(a,function(){var t;b?y.emit("rejectionHandled",e):(t=a.onrejectionhandled)&&t({promise:e,reason:e._v})})},A=function(e){var t=this;t._d||(t._d=!0,t=t._w||t,t._v=e,t._s=2,t._a||(t._a=t._c.slice()),M(t,!0))},P=function e(t){var n,o=this;if(!o._d){o._d=!0,o=o._w||o;try{if(o===t)throw w("Promise can't be resolved itself");(n=R(t))?v(function(){var i={_w:o,_d:!1};try{n.call(t,l(e,i,1),l(A,i,1))}catch(e){A.call(i,e)}}):(o._v=t,o._s=1,M(o,!1))}catch(e){A.call({_w:o,_d:!1},e)}}};T||(C=function(e){f(this,C,"Promise","_h"),h(e),o.call(this);try{e(l(P,this,1),l(A,this,1))}catch(e){A.call(this,e)}},o=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1},o.prototype=n(58)(C.prototype,{then:function(e,t){var n=O(g(this,C));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=b?y.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&M(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),_=function(){var e=new o;this.promise=e,this.resolve=l(P,e,1),this.reject=l(A,e,1)}),c(c.G+c.W+c.F*!T,{Promise:C}),n(47)(C,"Promise"),n(276)("Promise"),r=n(43).Promise,c(c.S+c.F*!T,"Promise",{reject:function(e){var t=O(this);return(0,t.reject)(e),t.promise}}),c(c.S+c.F*(s||!T),"Promise",{resolve:function(e){if(e instanceof C&&E(e.constructor,this))return e;var t=O(this);return(0,t.resolve)(e),t.promise}}),c(c.S+c.F*!(T&&n(72)(function(e){C.all(e).catch(S)})),"Promise",{all:function(e){var t=this,n=O(t),o=n.resolve,i=n.reject,r=k(function(){var n=[],r=0,s=1;p(e,!1,function(e){var a=r++,l=!1;n.push(void 0),s++,t.resolve(e).then(function(e){l||(l=!0,n[a]=e,--s||o(n))},i)}),--s||o(n)});return r&&i(r.error),n.promise},race:function(e){var t=this,n=O(t),o=n.reject,i=k(function(){p(e,!1,function(e){t.resolve(e).then(n.resolve,o)})});return i&&o(i.error),n.promise}})},function(e,t,n){n(14)&&"g"!=/./g.flags&&n(12).f(RegExp.prototype,"flags",{configurable:!0,get:n(337)})},function(e,t,n){n(54)("match",1,function(e,t,n){return[function(n){var o=e(this),i=void 0==n?void 0:n[t];return void 0!==i?i.call(n,o):new RegExp(n)[t](String(o))},n]})},function(e,t,n){n(54)("replace",2,function(e,t,n){return[function(o,i){var r=e(this),s=void 0==o?void 0:o[t];return void 0!==s?s.call(o,r,i):n.call(String(r),o,i)},n]})},function(e,t,n){n(54)("search",1,function(e,t,n){return[function(n){var o=e(this),i=void 0==n?void 0:n[t];return void 0!==i?i.call(n,o):new RegExp(n)[t](String(o))},n]})},function(e,t,n){n(54)("split",2,function(e,t,o){var i=n(268),r=o,s=[].push,a="length";if("c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1)[a]||2!="ab".split(/(?:ab)*/)[a]||4!=".".split(/(.?)(.?)/)[a]||".".split(/()()/)[a]>1||"".split(/.?/)[a]){var l=void 0===/()??/.exec("")[1];o=function(e,t){var n=String(this);if(void 0===e&&0===t)return[];if(!i(e))return r.call(n,e,t);var o,u,c,d,h,f=[],p=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),g=0,m=void 0===t?4294967295:t>>>0,v=new RegExp(e.source,p+"g");for(l||(o=new RegExp("^"+v.source+"$(?!\\s)",p));(u=v.exec(n))&&!((c=u.index+u[0][a])>g&&(f.push(n.slice(g,u.index)),!l&&u[a]>1&&u[0].replace(o,function(){for(h=1;h<arguments[a]-2;h++)void 0===arguments[h]&&(u[h]=void 0)}),u[a]>1&&u.index<n[a]&&s.apply(f,u.slice(1)),d=u[0][a],g=c,f[a]>=m));)v.lastIndex===u.index&&v.lastIndex++;return g===n[a]?!d&&v.test("")||f.push(""):f.push(n.slice(g)),f[a]>m?f.slice(0,m):f}}else"0".split(void 0,0)[a]&&(o=function(e,t){return void 0===e&&0===t?[]:r.call(this,e,t)});return[function(n,i){var r=e(this),s=void 0==n?void 0:n[t];return void 0!==s?s.call(n,r,i):o.call(String(r),n,i)},o]})},function(e,t,n){var o=n(261);e.exports=n(53)("Set",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return o.def(this,e=0===e?0:e,e)}},o)},function(e,t,n){var o=n(1),i=n(349)(!1);o(o.P,"String",{codePointAt:function(e){return i(this,e)}})},function(e,t,n){var o=n(1),i=n(17),r=n(78),s="".endsWith;o(o.P+o.F*n(70)("endsWith"),"String",{endsWith:function(e){var t=r(this,e,"endsWith"),n=arguments.length>1?arguments[1]:void 0,o=i(t.length),a=void 0===n?o:Math.min(i(n),o),l=String(e);return s?s.call(t,l,a):t.slice(a-l.length,a)===l}})},function(e,t,n){var o=n(1),i=n(59),r=String.fromCharCode,s=String.fromCodePoint;o(o.S+o.F*(!!s&&1!=s.length),"String",{fromCodePoint:function(e){for(var t,n=[],o=arguments.length,s=0;o>s;){if(t=+arguments[s++],i(t,1114111)!==t)throw RangeError(t+" is not a valid code point");n.push(t<65536?r(t):r(55296+((t-=65536)>>10),t%1024+56320))}return n.join("")}})},function(e,t,n){var o=n(1),i=n(78);o(o.P+o.F*n(70)("includes"),"String",{includes:function(e){return!!~i(this,e,"includes").indexOf(e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){var o=n(1),i=n(16),r=n(17);o(o.S,"String",{raw:function(e){for(var t=i(e.raw),n=r(t.length),o=arguments.length,s=[],a=0;n>a;)s.push(String(t[a++])),a<o&&s.push(String(arguments[a]));return s.join("")}})},function(e,t,n){var o=n(1);o(o.P,"String",{repeat:n(278)})},function(e,t,n){var o=n(1),i=n(17),r=n(78),s="".startsWith;o(o.P+o.F*n(70)("startsWith"),"String",{startsWith:function(e){var t=r(this,e,"startsWith"),n=i(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),o=String(e);return s?s.call(t,o,n):t.slice(n,n+o.length)===o}})},function(e,t,n){var o=n(5),i=n(15),r=n(14),a=n(1),l=n(27),u=n(45).KEY,c=n(25),d=n(77),h=n(47),f=n(48),p=n(4),g=n(279),m=n(350),v=n(341),w=n(336),y=n(266),C=n(11),b=n(16),S=n(80),T=n(35),E=n(73),R=n(344),O=n(74),_=n(12),k=n(34),M=O.f,D=_.f,H=R.f,x=o.Symbol,A=o.JSON,P=A&&A.stringify,N=p("_hidden"),L=p("toPrimitive"),W={}.propertyIsEnumerable,j=d("symbol-registry"),F=d("symbols"),I=d("op-symbols"),V=Object.prototype,B="function"==typeof x,Y=o.QObject,z=!Y||!Y.prototype||!Y.prototype.findChild,U=r&&c(function(){return 7!=E(D({},"a",{get:function(){return D(this,"a",{value:7}).a}})).a})?function(e,t,n){var o=M(V,t);o&&delete V[t],D(e,t,n),o&&e!==V&&D(V,t,o)}:D,G=function(e){var t=F[e]=E(x.prototype);return t._k=e,t},K=B&&"symbol"==s(x.iterator)?function(e){return"symbol"==(void 0===e?"undefined":s(e))}:function(e){return e instanceof x},X=function(e,t,n){return e===V&&X(I,t,n),C(e),t=S(t,!0),C(n),i(F,t)?(n.enumerable?(i(e,N)&&e[N][t]&&(e[N][t]=!1),n=E(n,{enumerable:T(0,!1)})):(i(e,N)||D(e,N,T(1,{})),e[N][t]=!0),U(e,t,n)):D(e,t,n)},q=function(e,t){C(e);for(var n,o=w(t=b(t)),i=0,r=o.length;r>i;)X(e,n=o[i++],t[n]);return e},$=function(e,t){return void 0===t?E(e):q(E(e),t)},Z=function(e){var t=W.call(this,e=S(e,!0));return!(this===V&&i(F,e)&&!i(I,e))&&(!(t||!i(this,e)||!i(F,e)||i(this,N)&&this[N][e])||t)},Q=function(e,t){if(e=b(e),t=S(t,!0),e!==V||!i(F,t)||i(I,t)){var n=M(e,t);return!n||!i(F,t)||i(e,N)&&e[N][t]||(n.enumerable=!0),n}},J=function(e){for(var t,n=H(b(e)),o=[],r=0;n.length>r;)i(F,t=n[r++])||t==N||t==u||o.push(t);return o},ee=function(e){for(var t,n=e===V,o=H(n?I:b(e)),r=[],s=0;o.length>s;)!i(F,t=o[s++])||n&&!i(V,t)||r.push(F[t]);return r};B||(x=function(){if(this instanceof x)throw TypeError("Symbol is not a constructor!");var e=f(arguments.length>0?arguments[0]:void 0),t=function t(n){this===V&&t.call(I,n),i(this,N)&&i(this[N],e)&&(this[N][e]=!1),U(this,e,T(1,n))};return r&&z&&U(V,e,{configurable:!0,set:t}),G(e)},l(x.prototype,"toString",function(){return this._k}),O.f=Q,_.f=X,n(75).f=R.f=J,n(46).f=Z,n(57).f=ee,r&&!n(56)&&l(V,"propertyIsEnumerable",Z,!0),g.f=function(e){return G(p(e))}),a(a.G+a.W+a.F*!B,{Symbol:x});for(var te="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ne=0;te.length>ne;)p(te[ne++]);for(var te=k(p.store),ne=0;te.length>ne;)m(te[ne++]);a(a.S+a.F*!B,"Symbol",{for:function(e){return i(j,e+="")?j[e]:j[e]=x(e)},keyFor:function(e){if(K(e))return v(j,e);throw TypeError(e+" is not a symbol!")},useSetter:function(){z=!0},useSimple:function(){z=!1}}),a(a.S+a.F*!B,"Object",{create:$,defineProperty:X,defineProperties:q,getOwnPropertyDescriptor:Q,getOwnPropertyNames:J,getOwnPropertySymbols:ee}),A&&a(a.S+a.F*(!B||c(function(){var e=x();return"[null]"!=P([e])||"{}"!=P({a:e})||"{}"!=P(Object(e))})),"JSON",{stringify:function(e){if(void 0!==e&&!K(e)){for(var t,n,o=[e],i=1;arguments.length>i;)o.push(arguments[i++]);return t=o[1],"function"==typeof t&&(n=t),!n&&y(t)||(t=function(e,t){if(n&&(t=n.call(this,e,t)),!K(t))return t}),o[1]=t,P.apply(A,o)}}}),x.prototype[L]||n(26)(x.prototype,L,x.prototype.valueOf),h(x,"Symbol"),h(Math,"Math",!0),h(o.JSON,"JSON",!0)},function(e,t,n){var o,i=n(52)(0),r=n(27),s=n(45),a=n(272),l=n(262),u=n(9),c=s.getWeak,d=Object.isExtensible,h=l.ufstore,f={},p=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},g={get:function(e){if(u(e)){var t=c(e);return!0===t?h(this).get(e):t?t[this._i]:void 0}},set:function(e,t){return l.def(this,e,t)}},m=e.exports=n(53)("WeakMap",p,g,l,!0,!0);7!=(new m).set((Object.freeze||Object)(f),7).get(f)&&(o=l.getConstructor(p),a(o.prototype,g),s.NEED=!0,i(["delete","has","get","set"],function(e){var t=m.prototype,n=t[e];r(t,e,function(t,i){if(u(t)&&!d(t)){this._f||(this._f=new o);var r=this._f[e](t,i);return"set"==e?this:r}return n.call(this,t,i)})}))},function(e,t,n){var o=n(262);n(53)("WeakSet",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{add:function(e){return o.def(this,e,!0)}},o,!1,!0)},function(e,t,n){var o=n(1),i=n(259)(!0);o(o.P,"Array",{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n(32)("includes")},function(e,t,n){var o=n(1),i=n(274)(!0);o(o.S,"Object",{entries:function(e){return i(e)}})},function(e,t,n){var o=n(1),i=n(346),r=n(16),s=n(74),a=n(67);o(o.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,n=r(e),o=s.f,l=i(n),u={},c=0;l.length>c;)a(u,t=l[c++],o(n,t));return u}})},function(e,t,n){var o=n(1),i=n(274)(!1);o(o.S,"Object",{values:function(e){return i(e)}})},function(e,t,n){var o=n(1),i=n(277);o(o.P,"String",{padEnd:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0,!1)}})},function(e,t,n){var o=n(1),i=n(277);o(o.P,"String",{padStart:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0,!0)}})},function(e,t,n){for(var o=n(64),i=n(27),r=n(5),s=n(26),a=n(44),l=n(4),u=l("iterator"),c=l("toStringTag"),d=a.Array,h=["NodeList","DOMTokenList","MediaList","StyleSheetList","CSSRuleList"],f=0;f<5;f++){var p,g=h[f],m=r[g],v=m&&m.prototype;if(v){v[u]||s(v,u,d),v[c]||s(v,c,g),a[g]=d;for(p in o)v[p]||i(v,p,o[p],!0)}}},function(e,t,n){var o=n(1),i=n(79);o(o.G+o.B,{setImmediate:i.set,clearImmediate:i.clear})},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=n(0),a=n(10),l=n(2),u=n(20),c=n(6),d=o(c),h=n(41),f=o(h),p=n(22),g=(o(p),function(){function e(t,n){i(this,e),n&&(this.eventManager=new d.default(t),this.instance=t,this.wot=t,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.left=null,this.bottom=null,this.right=null,this.topStyle=null,this.leftStyle=null,this.bottomStyle=null,this.rightStyle=null,this.cornerDefaultStyle={width:"5px",height:"5px",borderWidth:"2px",borderStyle:"solid",borderColor:"#FFF"},this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}return r(e,[{key:"registerListeners",value:function(){var e=this;this.eventManager.addEventListener(document.body,"mousedown",function(){return e.onMouseDown()}),this.eventManager.addEventListener(document.body,"mouseup",function(){return e.onMouseUp()});for(var t=0,n=this.main.childNodes.length;t<n;t++)!function(t,n){e.eventManager.addEventListener(e.main.childNodes[t],"mouseenter",function(n){return e.onMouseEnter(n,e.main.childNodes[t])})}(t)}},{key:"onMouseDown",value:function(){this.mouseDown=!0}},{key:"onMouseUp",value:function(){this.mouseDown=!1}},{key:"onMouseEnter",value:function(e,t){function n(e){return e.clientY<Math.floor(r.top)||(e.clientY>Math.ceil(r.top+r.height)||(e.clientX<Math.floor(r.left)||(e.clientX>Math.ceil(r.left+r.width)||void 0)))}function o(e){n(e)&&(i.eventManager.removeEventListener(document.body,"mousemove",o),t.style.display="block")}if(this.mouseDown&&this.wot.getSetting("hideBorderOnMouseDownOver")){e.preventDefault(),(0,a.stopImmediatePropagation)(e);var i=this,r=t.getBoundingClientRect();t.style.display="none",this.eventManager.addEventListener(document.body,"mousemove",o)}}},{key:"createBorders",value:function(e){this.main=document.createElement("div");var t=["top","left","bottom","right","corner"],n=this.main.style;n.position="absolute",n.top=0,n.left=0;for(var o=0;o<5;o++){var i=t[o],r=document.createElement("div");r.className="wtBorder "+(this.settings.className||""),this.settings[i]&&this.settings[i].hide&&(r.className+=" hidden"),n=r.style,n.backgroundColor=this.settings[i]&&this.settings[i].color?this.settings[i].color:e.border.color,n.height=this.settings[i]&&this.settings[i].width?this.settings[i].width+"px":e.border.width+"px",n.width=this.settings[i]&&this.settings[i].width?this.settings[i].width+"px":e.border.width+"px",this.main.appendChild(r)}this.top=this.main.childNodes[0],this.left=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.right=this.main.childNodes[3],this.topStyle=this.top.style,this.leftStyle=this.left.style,this.bottomStyle=this.bottom.style,this.rightStyle=this.right.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),(0,u.isMobileBrowser)()&&this.createMultipleSelectorHandles(),this.disappear(),this.wot.wtTable.bordersHolder||(this.wot.wtTable.bordersHolder=document.createElement("div"),this.wot.wtTable.bordersHolder.className="htBorders",this.wot.wtTable.spreader.appendChild(this.wot.wtTable.bordersHolder)),this.wot.wtTable.bordersHolder.insertBefore(this.main,this.wot.wtTable.bordersHolder.firstChild)}},{key:"createMultipleSelectorHandles",value:function(){this.selectionHandles={topLeft:document.createElement("DIV"),topLeftHitArea:document.createElement("DIV"),bottomRight:document.createElement("DIV"),bottomRightHitArea:document.createElement("DIV")};this.selectionHandles.topLeft.className="topLeftSelectionHandle",this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea",this.selectionHandles.bottomRight.className="bottomRightSelectionHandle",this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style};var e={position:"absolute",height:"40px",width:"40px","border-radius":parseInt(40/1.5,10)+"px"};for(var t in e)(0,l.hasOwnProperty)(e,t)&&(this.selectionHandles.styles.bottomRightHitArea[t]=e[t],this.selectionHandles.styles.topLeftHitArea[t]=e[t]);var n={position:"absolute",height:"10px",width:"10px","border-radius":parseInt(10/1.5,10)+"px",background:"#F5F5FF",border:"1px solid #4285c8"};for(var o in n)(0,l.hasOwnProperty)(n,o)&&(this.selectionHandles.styles.bottomRight[o]=n[o],this.selectionHandles.styles.topLeft[o]=n[o]);this.main.appendChild(this.selectionHandles.topLeft),this.main.appendChild(this.selectionHandles.bottomRight),this.main.appendChild(this.selectionHandles.topLeftHitArea),this.main.appendChild(this.selectionHandles.bottomRightHitArea)}},{key:"isPartRange",value:function(e,t){return!(!this.wot.selections.area.cellRange||e==this.wot.selections.area.cellRange.to.row&&t==this.wot.selections.area.cellRange.to.col)}},{key:"updateMultipleSelectionHandlesPosition",value:function(e,t,n,o,i,r){var s=parseInt(this.selectionHandles.styles.topLeft.width,10),a=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10);this.selectionHandles.styles.topLeft.top=parseInt(n-s,10)+"px",this.selectionHandles.styles.topLeft.left=parseInt(o-s,10)+"px",this.selectionHandles.styles.topLeftHitArea.top=parseInt(n-a/4*3,10)+"px",this.selectionHandles.styles.topLeftHitArea.left=parseInt(o-a/4*3,10)+"px",this.selectionHandles.styles.bottomRight.top=parseInt(n+r,10)+"px",this.selectionHandles.styles.bottomRight.left=parseInt(o+i,10)+"px",this.selectionHandles.styles.bottomRightHitArea.top=parseInt(n+r-a/4,10)+"px",this.selectionHandles.styles.bottomRightHitArea.left=parseInt(o+i-a/4,10)+"px",this.settings.border.multipleSelectionHandlesVisible&&this.settings.border.multipleSelectionHandlesVisible()?(this.selectionHandles.styles.topLeft.display="block",this.selectionHandles.styles.topLeftHitArea.display="block",this.isPartRange(e,t)?(this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"):(this.selectionHandles.styles.bottomRight.display="block",this.selectionHandles.styles.bottomRightHitArea.display="block")):(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.topLeftHitArea.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"),e==this.wot.wtSettings.getSetting("fixedRowsTop")||t==this.wot.wtSettings.getSetting("fixedColumnsLeft")?(this.selectionHandles.styles.topLeft.zIndex="9999",this.selectionHandles.styles.topLeftHitArea.zIndex="9999"):(this.selectionHandles.styles.topLeft.zIndex="",this.selectionHandles.styles.topLeftHitArea.zIndex="")}},{key:"appear",value:function(e){if(!this.disabled){var t,n,o,i,r,a,l,c,d,h,p,g,m,v,w,y,C,b;b=this.wot.wtTable.getRenderedRowsCount();for(var S=0;S<b;S++){var T=this.wot.wtTable.rowFilter.renderedToSource(S);if(T>=e[0]&&T<=e[2]){m=T;break}}for(var E=b-1;E>=0;E--){var R=this.wot.wtTable.rowFilter.renderedToSource(E);if(R>=e[0]&&R<=e[2]){w=R;break}}b=this.wot.wtTable.getRenderedColumnsCount();for(var O=0;O<b;O++){var _=this.wot.wtTable.columnFilter.renderedToSource(O);if(_>=e[1]&&_<=e[3]){v=_;break}}for(var k=b-1;k>=0;k--){var M=this.wot.wtTable.columnFilter.renderedToSource(k);if(M>=e[1]&&M<=e[3]){y=M;break}}if(void 0===m||void 0===v)return void this.disappear();t=m!==w||v!==y,n=this.wot.wtTable.getCell(new f.default(m,v)),o=t?this.wot.wtTable.getCell(new f.default(w,y)):n,i=(0,s.offset)(n),r=t?(0,s.offset)(o):i,a=(0,s.offset)(this.wot.wtTable.TABLE),c=i.top,p=r.top+(0,s.outerHeight)(o)-c,h=i.left,g=r.left+(0,s.outerWidth)(o)-h,l=c-a.top-1,d=h-a.left-1;var D=(0,s.getComputedStyle)(n);parseInt(D.borderTopWidth,10)>0&&(l+=1,p=p>0?p-1:0),parseInt(D.borderLeftWidth,10)>0&&(d+=1,g=g>0?g-1:0),this.topStyle.top=l+"px",this.topStyle.left=d+"px",this.topStyle.width=g+"px",this.topStyle.display="block",this.leftStyle.top=l+"px",this.leftStyle.left=d+"px",this.leftStyle.height=p+"px",this.leftStyle.display="block";var H=Math.floor(this.settings.border.width/2);this.bottomStyle.top=l+p-H+"px",this.bottomStyle.left=d+"px",this.bottomStyle.width=g+"px",this.bottomStyle.display="block",this.rightStyle.top=l+"px",this.rightStyle.left=d+g-H+"px",this.rightStyle.height=p+1+"px",this.rightStyle.display="block",(0,u.isMobileBrowser)()||!this.hasSetting(this.settings.border.cornerVisible)||this.isPartRange(w,y)?this.cornerStyle.display="none":(this.cornerStyle.top=l+p-4+"px",this.cornerStyle.left=d+g-4+"px",this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none",C=(0,s.getTrimmingContainer)(this.wot.wtTable.TABLE),y===this.wot.getSetting("totalColumns")-1&&o.offsetLeft+(0,s.outerWidth)(o)+parseInt(this.cornerDefaultStyle.width,10)/2>=(0,s.innerWidth)(C)&&(this.cornerStyle.left=Math.floor(d+g-3-parseInt(this.cornerDefaultStyle.width,10)/2)+"px",this.cornerStyle.borderRightWidth=0),w===this.wot.getSetting("totalRows")-1&&o.offsetTop+(0,s.outerHeight)(o)+parseInt(this.cornerDefaultStyle.height,10)/2>=(0,s.innerHeight)(C)&&(this.cornerStyle.top=Math.floor(l+p-3-parseInt(this.cornerDefaultStyle.height,10)/2)+"px",this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"),(0,u.isMobileBrowser)()&&this.updateMultipleSelectionHandlesPosition(m,v,l,d,g,p)}}},{key:"disappear",value:function(){this.topStyle.display="none",this.leftStyle.display="none",this.bottomStyle.display="none",this.rightStyle.display="none",this.cornerStyle.display="none",(0,u.isMobileBrowser)()&&(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none")}},{key:"hasSetting",value:function(e){return"function"==typeof e?e():!!e}}]),e}());t.default=g},function(e,t,n){function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=new WeakMap,s=function(){function e(t,n,i,s,a,l,u){var c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:function(e){return e};o(this,e),r.set(this,{viewportWidth:t,scrollOffset:n,totalColumns:i,columnWidthFn:s,overrideFn:a,onlyFullyVisible:l,stretchingColumnWidthFn:c}),this.count=0,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=u,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],this.calculate()}return i(e,null,[{key:"DEFAULT_WIDTH",get:function(){return 50}}]),i(e,[{key:"calculate",value:function(){for(var e=0,t=!0,n=[],o=void 0,i=r.get(this),s=i.onlyFullyVisible,a=i.overrideFn,l=i.scrollOffset,u=i.totalColumns,c=i.viewportWidth,d=0;d<u;d++){o=this._getColumnWidth(d),e<=l&&!s&&(this.startColumn=d);var h=l>0?c+1:c;if(e>=l&&e+o<=l+h&&(null==this.startColumn&&(this.startColumn=d),this.endColumn=d),n.push(e),e+=o,s||(this.endColumn=d),e>=l+c){t=!1;break}}if(this.endColumn===u-1&&t)for(this.startColumn=this.endColumn;this.startColumn>0;){var f=n[this.endColumn]+o-n[this.startColumn-1];if((f<=c||!s)&&this.startColumn--,f>c)break}null!==this.startColumn&&a&&a(this),this.startPosition=n[this.startColumn],void 0==this.startPosition&&(this.startPosition=null),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}},{key:"refreshStretching",value:function(e){if("none"!==this.stretch){this.totalTargetWidth=e;for(var t=r.get(this),n=t.totalColumns,o=0,i=0;i<n;i++){var s=this._getColumnWidth(i),a=t.stretchingColumnWidthFn(void 0,i);"number"==typeof a?e-=a:o+=s}var l=e-o;if("all"===this.stretch&&l>0)this.stretchAllRatio=e/o,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if("last"===this.stretch&&e!==1/0){var u=this._getColumnWidth(n-1),c=l+u;this.stretchLastWidth=c>=0?c:u}}}},{key:"getStretchedColumnWidth",value:function(e,t){var n=null;return"all"===this.stretch&&0!==this.stretchAllRatio?n=this._getStretchedAllColumnWidth(e,t):"last"===this.stretch&&0!==this.stretchLastWidth&&(n=this._getStretchedLastColumnWidth(e)),n}},{key:"_getStretchedAllColumnWidth",value:function(e,t){var n=0,o=r.get(this),i=o.totalColumns;if(!this.stretchAllColumnsWidth[e]){var s=Math.round(t*this.stretchAllRatio),a=o.stretchingColumnWidthFn(s,e);this.stretchAllColumnsWidth[e]=void 0===a?s:isNaN(a)?this._getColumnWidth(e):a}if(this.stretchAllColumnsWidth.length===i&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(var l=0;l<this.stretchAllColumnsWidth.length;l++)n+=this.stretchAllColumnsWidth[l];n!==this.totalTargetWidth&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=this.totalTargetWidth-n)}return this.stretchAllColumnsWidth[e]}},{key:"_getStretchedLastColumnWidth",value:function(e){return e===r.get(this).totalColumns-1?this.stretchLastWidth:null}},{key:"_getColumnWidth",value:function(t){var n=r.get(this).columnWidthFn(t);return void 0===n&&(n=e.DEFAULT_WIDTH),n}}]),e}();t.default=s},function(e,t,n){function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=new WeakMap,s=function(){function e(t,n,i,s,a,l,u){o(this,e),r.set(this,{viewportHeight:t,scrollOffset:n,totalRows:i,rowHeightFn:s,overrideFn:a,onlyFullyVisible:l,horizontalScrollbarHeight:u}),this.count=0,this.startRow=null,this.endRow=null,this.startPosition=null,this.calculate()}return i(e,null,[{key:"DEFAULT_HEIGHT",get:function(){return 23}}]),i(e,[{key:"calculate",value:function(){for(var t=0,n=!0,o=[],i=r.get(this),s=i.onlyFullyVisible,a=i.overrideFn,l=i.rowHeightFn,u=i.scrollOffset,c=i.totalRows,d=i.viewportHeight,h=i.horizontalScrollbarHeight||0,f=void 0,p=0;p<c;p++)if(f=l(p),void 0===f&&(f=e.DEFAULT_HEIGHT),t<=u&&!s&&(this.startRow=p),t>=u&&t+f<=u+d-h&&(null===this.startRow&&(this.startRow=p),this.endRow=p),o.push(t),t+=f,s||(this.endRow=p),t>=u+d-h){n=!1;break}if(this.endRow===c-1&&n)for(this.startRow=this.endRow;this.startRow>0;){var g=o[this.endRow]+f-o[this.startRow-1];if((g<=d-h||!s)&&this.startRow--,g>=d-h)break}null!==this.startRow&&a&&a(this),this.startPosition=o[this.startRow],void 0==this.startPosition&&(this.startPosition=null),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}]),e}();t.default=s},function(e,t,n){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=n(0),a=n(2),l=n(29),u=n(246),c=o(u),d=n(249),h=o(d),f=n(250),p=o(f),g=n(251),m=o(g),v=n(252),w=o(v),y=n(254),C=o(y),b=function(){function e(t){i(this,e);var n=[];if(this.guid="wt_"+(0,l.randomString)(),t.cloneSource?(this.cloneSource=t.cloneSource,this.cloneOverlay=t.cloneOverlay,this.wtSettings=t.cloneSource.wtSettings,this.wtTable=new w.default(this,t.table,t.wtRootElement),this.wtScroll=new p.default(this),this.wtViewport=t.cloneSource.wtViewport,this.wtEvent=new c.default(this),this.selections=this.cloneSource.selections):(this.wtSettings=new m.default(this,t),this.wtTable=new w.default(this,t.table),this.wtScroll=new p.default(this),this.wtViewport=new C.default(this),this.wtEvent=new c.default(this),this.selections=this.getSetting("selections"),this.wtOverlays=new h.default(this),this.exportSettingsAsClassNames()),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var o=0,r=this.wtTable.THEAD.childNodes[0].childNodes.length;o<r;o++)n.push(this.wtTable.THEAD.childNodes[0].childNodes[o].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(e,t){(0,s.fastInnerText)(t,n[e])}])}this.drawn=!1,this.drawInterrupted=!1}return r(e,[{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,e||(0,s.isVisible)(this.wtTable.TABLE)?this.wtTable.draw(e):this.drawInterrupted=!0,this}},{key:"getCell",value:function(e){if(!(arguments.length>1&&void 0!==arguments[1]&&arguments[1]))return this.wtTable.getCell(e);var t=this.wtSettings.getSetting("totalRows"),n=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),i=this.wtSettings.getSetting("fixedColumnsLeft");if(e.row<n&&e.col<i)return this.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell(e);if(e.row<n)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<i&&e.row>=t-o){if(this.wtOverlays.bottomLeftCornerOverlay&&this.wtOverlays.bottomLeftCornerOverlay.clone)return this.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<i)return this.wtOverlays.leftOverlay.clone.wtTable.getCell(e);if(e.row<t&&e.row>t-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}},{key:"update",value:function(e,t){return this.wtSettings.update(e,t)}},{key:"scrollVertical",value:function(e){return this.wtOverlays.topOverlay.scrollTo(e),this.getSetting("onScrollVertically"),this}},{key:"scrollHorizontal",value:function(e){return this.wtOverlays.leftOverlay.scrollTo(e),this.getSetting("onScrollHorizontally"),this}},{key:"scrollViewport",value:function(e){return this.wtScroll.scrollViewport(e),this}},{key:"getViewport",value:function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}},{key:"getOverlayName",value:function(){return this.cloneOverlay?this.cloneOverlay.type:"master"}},{key:"isOverlayName",value:function(e){return!!this.cloneOverlay&&this.cloneOverlay.type===e}},{key:"exportSettingsAsClassNames",value:function(){var e=this,t={rowHeaders:["array"],columnHeaders:["array"]},n=[],o=[];(0,a.objectEach)(t,function(t,i){t.indexOf("array")>-1&&e.getSetting(i).length&&o.push("ht"+(0,l.toUpperCaseFirst)(i)),n.push("ht"+(0,l.toUpperCaseFirst)(i))}),(0,s.removeClass)(this.wtTable.wtRootElement.parentNode,n),(0,s.addClass)(this.wtTable.wtRootElement.parentNode,o)}},{key:"getSetting",value:function(e,t,n,o,i){return this.wtSettings.getSetting(e,t,n,o,i)}},{key:"hasSetting",value:function(e){return this.wtSettings.has(e)}},{key:"destroy",value:function(){this.wtOverlays.destroy(),this.wtEvent.destroy()}}]),e}();t.default=b},function(e,t,n){function o(e){var t=this,n=new l.default(e);this.instance=e;var o=[null,null];this.dblClickTimeout=[null,null];var a=function(e){var n=document.activeElement,s=(0,r.partial)(i.getParent,e.realTarget),a=e.realTarget;if(a!==n&&s(0)!==n&&s(1)!==n){var l=t.parentCell(a);(0,i.hasClass)(a,"corner")?t.instance.getSetting("onCellCornerMouseDown",e,a):l.TD&&t.instance.hasSetting("onCellMouseDown")&&t.instance.getSetting("onCellMouseDown",e,l.coords,l.TD,t.instance),2!==e.button&&l.TD&&(o[0]=l.TD,clearTimeout(t.dblClickTimeout[0]),t.dblClickTimeout[0]=setTimeout(function(){o[0]=null},1e3))}},u=function(e){t.instance.touchMoving=!0},c=function(e){n.addEventListener(this,"touchmove",u),t.checkIfTouchMove=setTimeout(function(){!0===t.instance.touchMoving&&(t.instance.touchMoving=void 0,n.removeEventListener("touchmove",u,!1)),a(e)},30)},d=function(e){var n,o,r;t.instance.hasSetting("onCellMouseOver")&&(n=t.instance.wtTable.TABLE,o=(0,i.closestDown)(e.realTarget,["TD","TH"],n),r=t.instance.cloneSource||t.instance,o&&o!==r.lastMouseOver&&(0,i.isChildOf)(o,n)&&(r.lastMouseOver=o,t.instance.getSetting("onCellMouseOver",e,t.instance.wtTable.getCoords(o),o,t.instance)))},h=function(e){var n=void 0,o=void 0,r=void 0;t.instance.hasSetting("onCellMouseOut")&&(n=t.instance.wtTable.TABLE,o=(0,i.closestDown)(e.realTarget,["TD","TH"],n),r=(0,i.closestDown)(e.relatedTarget,["TD","TH"],n),o&&o!==r&&(0,i.isChildOf)(o,n)&&t.instance.getSetting("onCellMouseOut",e,t.instance.wtTable.getCoords(o),o,t.instance))},f=function(e){if(2!==e.button){var n=t.parentCell(e.realTarget);n.TD===o[0]&&n.TD===o[1]?((0,i.hasClass)(e.realTarget,"corner")?t.instance.getSetting("onCellCornerDblClick",e,n.coords,n.TD,t.instance):t.instance.getSetting("onCellDblClick",e,n.coords,n.TD,t.instance),o[0]=null,o[1]=null):n.TD===o[0]?(t.instance.getSetting("onCellMouseUp",e,n.coords,n.TD,t.instance),o[1]=n.TD,clearTimeout(t.dblClickTimeout[1]),t.dblClickTimeout[1]=setTimeout(function(){o[1]=null},500)):n.TD&&t.instance.hasSetting("onCellMouseUp")&&t.instance.getSetting("onCellMouseUp",e,n.coords,n.TD,t.instance)}},p=function(e){clearTimeout(void 0),e.preventDefault(),f(e)};if(n.addEventListener(this.instance.wtTable.holder,"mousedown",a),n.addEventListener(this.instance.wtTable.TABLE,"mouseover",d),n.addEventListener(this.instance.wtTable.TABLE,"mouseout",h),n.addEventListener(this.instance.wtTable.holder,"mouseup",f),this.instance.wtTable.holder.parentNode.parentNode&&(0,s.isMobileBrowser)()&&!t.instance.wtTable.isWorkingOnClone()){var g="."+this.instance.wtTable.holder.parentNode.className.split(" ").join(".");n.addEventListener(this.instance.wtTable.holder,"touchstart",function(e){t.instance.touchApplied=!0,(0,i.isChildOf)(e.target,g)&&c.call(e.target,e)}),n.addEventListener(this.instance.wtTable.holder,"touchend",function(e){t.instance.touchApplied=!1,(0,i.isChildOf)(e.target,g)&&p.call(e.target,e)}),t.instance.momentumScrolling||(t.instance.momentumScrolling={}),n.addEventListener(this.instance.wtTable.holder,"scroll",function(e){clearTimeout(t.instance.momentumScrolling._timeout),t.instance.momentumScrolling.ongoing||t.instance.getSetting("onBeforeTouchScroll"),t.instance.momentumScrolling.ongoing=!0,t.instance.momentumScrolling._timeout=setTimeout(function(){t.instance.touchApplied||(t.instance.momentumScrolling.ongoing=!1,t.instance.getSetting("onAfterMomentumScroll"))},200)})}n.addEventListener(window,"resize",function(){"none"!==t.instance.getSetting("stretchH")&&t.instance.draw()}),this.destroy=function(){clearTimeout(this.dblClickTimeout[0]),clearTimeout(this.dblClickTimeout[1]),n.destroy()}}t.__esModule=!0;var i=n(0),r=n(38),s=n(20),a=n(6),l=function(e){return e&&e.__esModule?e:{default:e}}(a);o.prototype.parentCell=function(e){var t={},n=this.instance.wtTable.TABLE,o=(0,i.closestDown)(e,["TD","TH"],n);return o?(t.coords=this.instance.wtTable.getCoords(o),t.TD=o):(0,i.hasClass)(e,"wtBorder")&&(0,i.hasClass)(e,"current")?(t.coords=this.instance.selections.current.cellRange.highlight,t.TD=this.instance.wtTable.getCell(t.coords)):(0,i.hasClass)(e,"wtBorder")&&(0,i.hasClass)(e,"area")&&this.instance.selections.area.cellRange&&(t.coords=this.instance.selections.area.cellRange.to,t.TD=this.instance.wtTable.getCell(t.coords)),t},t.default=o},function(e,t,n){function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(){function e(t,n,i){o(this,e),this.offset=t,this.total=n,this.countTH=i}return i(e,[{key:"offsetted",value:function(e){return e+this.offset}},{key:"unOffsetted",value:function(e){return e-this.offset}},{key:"renderedToSource",value:function(e){return this.offsetted(e)}},{key:"sourceToRendered",value:function(e){return this.unOffsetted(e)}},{key:"offsettedTH",value:function(e){return e-this.countTH}},{key:"unOffsettedTH",value:function(e){return e+this.countTH}},{key:"visibleRowHeadedColumnToSourceColumn",value:function(e){return this.renderedToSource(this.offsettedTH(e))}},{key:"sourceColumnToVisibleRowHeadedColumn",value:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}}]),e}();t.default=r},function(e,t,n){function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=function(){function e(t,n,i){o(this,e),this.offset=t,this.total=n,this.countTH=i}return i(e,[{key:"offsetted",value:function(e){return e+this.offset}},{key:"unOffsetted",value:function(e){return e-this.offset}},{key:"renderedToSource",value:function(e){return this.offsetted(e)}},{key:"sourceToRendered",value:function(e){return this.unOffsetted(e)}},{key:"offsettedTH",value:function(e){return e-this.countTH}},{key:"unOffsettedTH",value:function(e){return e+this.countTH}},{key:"visibleColHeadedRowToSourceRow",value:function(e){return this.renderedToSource(this.offsettedTH(e))}},{key:"sourceRowToVisibleColHeadedRow",value:function(e){return this.unOffsettedTH(this.sourceToRendered(e))}}]),e}();t.default=r},function(e,t,n){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=n(0),a=n(7),l=n(13),u=n(20),c=n(6),d=o(c),h=n(22),f=o(h),p=function(){function e(t){i(this,e),this.wot=t,this.instance=this.wot,this.eventManager=new d.default(this.wot),this.wot.update("scrollbarWidth",(0,s.getScrollbarWidth)()),this.wot.update("scrollbarHeight",(0,s.getScrollbarWidth)()),this.scrollableElement=(0,s.getScrollableElement)(this.wot.wtTable.TABLE),this.prepareOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.overlayScrollPositions={master:{top:0,left:0},top:{top:null,left:0},bottom:{top:null,left:0},left:{top:0,left:null}},this.pendingScrollCallbacks={master:{top:0,left:0},top:{left:0},bottom:{left:0},left:{top:0}},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.delegatedScrollCallback=!1,this.registeredListeners=[],this.registerListeners()}return r(e,[{key:"prepareOverlays",value:function(){var e=!1;return this.topOverlay?e=this.topOverlay.updateStateOfRendering()||e:this.topOverlay=f.default.createOverlay(f.default.CLONE_TOP,this.wot),f.default.hasOverlay(f.default.CLONE_BOTTOM)||(this.bottomOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),f.default.hasOverlay(f.default.CLONE_BOTTOM_LEFT_CORNER)||(this.bottomLeftCornerOverlay={needFullRender:!1,updateStateOfRendering:function(){return!1}}),this.bottomOverlay?e=this.bottomOverlay.updateStateOfRendering()||e:this.bottomOverlay=f.default.createOverlay(f.default.CLONE_BOTTOM,this.wot),this.leftOverlay?e=this.leftOverlay.updateStateOfRendering()||e:this.leftOverlay=f.default.createOverlay(f.default.CLONE_LEFT,this.wot),this.topOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.topLeftCornerOverlay?e=this.topLeftCornerOverlay.updateStateOfRendering()||e:this.topLeftCornerOverlay=f.default.createOverlay(f.default.CLONE_TOP_LEFT_CORNER,this.wot)),this.bottomOverlay.needFullRender&&this.leftOverlay.needFullRender&&(this.bottomLeftCornerOverlay?e=this.bottomLeftCornerOverlay.updateStateOfRendering()||e:this.bottomLeftCornerOverlay=f.default.createOverlay(f.default.CLONE_BOTTOM_LEFT_CORNER,this.wot)),this.wot.getSetting("debug")&&!this.debug&&(this.debug=f.default.createOverlay(f.default.CLONE_DEBUG,this.wot)),e}},{key:"refreshAll",value:function(){if(this.wot.drawn){if(!this.wot.wtTable.holder.parentNode)return void this.destroy();this.wot.draw(!0),this.verticalScrolling&&this.leftOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}},{key:"registerListeners",value:function(){var e=this,t=this.topOverlay.mainTableScrollableElement,n=this.leftOverlay.mainTableScrollableElement,o=[];for(o.push([document.documentElement,"keydown",function(t){return e.onKeyDown(t)}]),o.push([document.documentElement,"keyup",function(){return e.onKeyUp()}]),o.push([document,"visibilitychange",function(){return e.onKeyUp()}]),o.push([t,"scroll",function(t){return e.onTableScroll(t)}]),t!==n&&o.push([n,"scroll",function(t){return e.onTableScroll(t)}]),this.topOverlay.needFullRender&&(o.push([this.topOverlay.clone.wtTable.holder,"scroll",function(t){return e.onTableScroll(t)}]),o.push([this.topOverlay.clone.wtTable.holder,"wheel",function(t){return e.onTableScroll(t)}])),this.bottomOverlay.needFullRender&&(o.push([this.bottomOverlay.clone.wtTable.holder,"scroll",function(t){return e.onTableScroll(t)}]),o.push([this.bottomOverlay.clone.wtTable.holder,"wheel",function(t){return e.onTableScroll(t)}])),this.leftOverlay.needFullRender&&(o.push([this.leftOverlay.clone.wtTable.holder,"scroll",function(t){return e.onTableScroll(t)}]),o.push([this.leftOverlay.clone.wtTable.holder,"wheel",function(t){return e.onTableScroll(t)}])),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.needFullRender&&o.push([this.topLeftCornerOverlay.clone.wtTable.holder,"wheel",function(t){return e.onTableScroll(t)}]),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.needFullRender&&o.push([this.bottomLeftCornerOverlay.clone.wtTable.holder,"wheel",function(t){return e.onTableScroll(t)}]),this.topOverlay.trimmingContainer!==window&&this.leftOverlay.trimmingContainer!==window&&o.push([window,"wheel",function(t){var n=void 0,o=t.wheelDeltaY||t.deltaY,i=t.wheelDeltaX||t.deltaX;e.topOverlay.clone.wtTable.holder.contains(t.realTarget)?n="top":e.bottomOverlay.clone&&e.bottomOverlay.clone.wtTable.holder.contains(t.realTarget)?n="bottom":e.leftOverlay.clone.wtTable.holder.contains(t.realTarget)?n="left":e.topLeftCornerOverlay&&e.topLeftCornerOverlay.clone&&e.topLeftCornerOverlay.clone.wtTable.holder.contains(t.realTarget)?n="topLeft":e.bottomLeftCornerOverlay&&e.bottomLeftCornerOverlay.clone&&e.bottomLeftCornerOverlay.clone.wtTable.holder.contains(t.realTarget)&&(n="bottomLeft"),("top"==n&&0!==o||"left"==n&&0!==i||"bottom"==n&&0!==o||("topLeft"===n||"bottomLeft"===n)&&(0!==o||0!==i))&&t.preventDefault()}]);o.length;){var i=o.pop();this.eventManager.addEventListener(i[0],i[1],i[2]),this.registeredListeners.push(i)}}},{key:"deregisterListeners",value:function(){for(;this.registeredListeners.length;){var e=this.registeredListeners.pop();this.eventManager.removeEventListener(e[0],e[1],e[2])}}},{key:"onTableScroll",value:function(e){if(!(0,u.isMobileBrowser)()){var t=this.leftOverlay.mainTableScrollableElement,n=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(n!==window&&o!==window&&!e.target.contains(n)||t!==window&&o!==window&&!e.target.contains(t))||("scroll"===e.type?this.syncScrollPositions(e):this.translateMouseWheelToScroll(e))}}},{key:"onKeyDown",value:function(e){this.keyPressed=(0,l.isKey)(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}},{key:"onKeyUp",value:function(){this.keyPressed=!1}},{key:"translateMouseWheelToScroll",value:function(e){var t=this.topOverlay.clone.wtTable.holder,n=this.bottomOverlay.clone?this.bottomOverlay.clone.wtTable.holder:null,o=this.leftOverlay.clone.wtTable.holder,i=this.topLeftCornerOverlay&&this.topLeftCornerOverlay.clone?this.topLeftCornerOverlay.clone.wtTable.holder:null,r=this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone?this.bottomLeftCornerOverlay.clone.wtTable.holder:null,s=e.wheelDeltaY||-1*e.deltaY,a=e.wheelDeltaX||-1*e.deltaX,l=null,u={type:"wheel"},c=e.target,d=null;for(1===e.deltaMode&&(s*=120,a*=120);c!=document&&null!=c;){if(c.className.indexOf("wtHolder")>-1){l=c;break}c=c.parentNode}return u.target=l,l===i||l===r?(this.syncScrollPositions(u,-.2*a,"x"),this.syncScrollPositions(u,-.2*s,"y")):(l===t||l===n?d=s:l===o&&(d=a),this.syncScrollPositions(u,-.2*d)),!1}},{key:"syncScrollPositions",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!this.destroyed){if(0===arguments.length)return void this.syncScrollWithMaster();var o=this.leftOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,r=e.target,a=0,l=!1,u=void 0,c=void 0,d=void 0,h=void 0,f=void 0,p=!1,g=this.wot.getSetting("preventOverflow");this.topOverlay.needFullRender&&(u=this.topOverlay.clone.wtTable.holder),this.bottomOverlay.needFullRender&&(f=this.bottomOverlay.clone.wtTable.holder),this.leftOverlay.needFullRender&&(c=this.leftOverlay.clone.wtTable.holder),this.leftOverlay.needFullRender&&this.topOverlay.needFullRender&&(d=this.topLeftCornerOverlay.clone.wtTable.holder),this.leftOverlay.needFullRender&&this.bottomOverlay.needFullRender&&(h=this.bottomLeftCornerOverlay.clone.wtTable.holder),r===document&&(r=window),r===o||r===i?(a=g?(0,s.getScrollLeft)(this.scrollableElement):(0,s.getScrollLeft)(r),this.horizontalScrolling=!0,this.overlayScrollPositions.master.left=a,l=!0,this.pendingScrollCallbacks.master.left>0?this.pendingScrollCallbacks.master.left--:(u&&u.scrollLeft!==a&&(null==t&&this.pendingScrollCallbacks.top.left++,u.scrollLeft=a,p=o!==window),f&&f.scrollLeft!==a&&(null==t&&this.pendingScrollCallbacks.bottom.left++,f.scrollLeft=a,p=o!==window)),a=(0,s.getScrollTop)(r),this.verticalScrolling=!0,this.overlayScrollPositions.master.top=a,l=!0,this.pendingScrollCallbacks.master.top>0?this.pendingScrollCallbacks.master.top--:c&&c.scrollTop!==a&&(null==t&&this.pendingScrollCallbacks.left.top++,c.scrollTop=a,p=i!==window)):r===f?(a=(0,s.getScrollLeft)(r),this.horizontalScrolling=!0,this.overlayScrollPositions.bottom.left=a,l=!0,this.pendingScrollCallbacks.bottom.left>0?this.pendingScrollCallbacks.bottom.left--:(null==t&&this.pendingScrollCallbacks.master.left++,o.scrollLeft=a,u&&u.scrollLeft!==a&&(null==t&&this.pendingScrollCallbacks.top.left++,u.scrollLeft=a,p=i!==window)),null!==t&&(l=!0,i.scrollTop+=t)):r===u?(a=(0,s.getScrollLeft)(r),this.horizontalScrolling=!0,this.overlayScrollPositions.top.left=a,l=!0,this.pendingScrollCallbacks.top.left>0?this.pendingScrollCallbacks.top.left--:(null==t&&this.pendingScrollCallbacks.master.left++,o.scrollLeft=a),null!==t&&(l=!0,i.scrollTop+=t),f&&f.scrollLeft!==a&&(null==t&&this.pendingScrollCallbacks.bottom.left++,f.scrollLeft=a,p=i!==window)):r===c?(a=(0,s.getScrollTop)(r),this.overlayScrollPositions.left.top!==a&&(this.verticalScrolling=!0,this.overlayScrollPositions.left.top=a,l=!0,this.pendingScrollCallbacks.left.top>0?this.pendingScrollCallbacks.left.top--:(null==t&&this.pendingScrollCallbacks.master.top++,i.scrollTop=a)),null!==t&&(l=!0,i.scrollLeft+=t)):r!==d&&r!==h||null!==t&&(l=!0,"x"===n?i.scrollLeft+=t:"y"===n&&(i.scrollTop+=t)),!this.keyPressed&&l&&"scroll"===e.type&&(this.delegatedScrollCallback?this.delegatedScrollCallback=!1:this.refreshAll(),p&&(this.delegatedScrollCallback=!0))}}},{key:"syncScrollWithMaster",value:function(){var e=this.topOverlay.mainTableScrollableElement,t=e.scrollLeft,n=e.scrollTop;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.leftOverlay.needFullRender&&(this.leftOverlay.clone.wtTable.holder.scrollTop=n)}},{key:"updateMainScrollableElements",value:function(){this.deregisterListeners(),this.leftOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement(),this.scrollableElement=(0,s.getScrollableElement)(this.wot.wtTable.TABLE),this.registerListeners()}},{key:"destroy",value:function(){this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.leftOverlay.destroy(),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.destroy(),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.destroy(),this.debug&&this.debug.destroy(),this.destroyed=!0}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted){var t=this.wot.wtTable.wtRootElement.parentNode||this.wot.wtTable.wtRootElement,n=t.clientWidth,o=t.clientHeight;n===this.spreaderLastSize.width&&o===this.spreaderLastSize.height||(this.spreaderLastSize.width=n,this.spreaderLastSize.height=o,this.adjustElementsSize())}this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.leftOverlay.refresh(e),this.topOverlay.refresh(e),this.topLeftCornerOverlay&&this.topLeftCornerOverlay.refresh(e),this.bottomLeftCornerOverlay&&this.bottomLeftCornerOverlay.clone&&this.bottomLeftCornerOverlay.refresh(e),this.debug&&this.debug.refresh(e)}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.wot.getSetting("totalColumns"),n=this.wot.getSetting("totalRows"),o=this.wot.wtViewport.getRowHeaderWidth(),i=this.wot.wtViewport.getColumnHeaderHeight(),r=this.wot.wtTable.hider.style;r.width=o+this.leftOverlay.sumCellSizes(0,t)+"px",r.height=i+this.topOverlay.sumCellSizes(0,n)+1+"px",this.topOverlay.adjustElementsSize(e),this.leftOverlay.adjustElementsSize(e),this.bottomOverlay.clone&&this.bottomOverlay.adjustElementsSize(e)}},{key:"applyToDOM",value:function(){this.topOverlay.areElementSizesAdjusted&&this.leftOverlay.areElementSizesAdjusted||this.adjustElementsSize(),this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.leftOverlay.applyToDOM()}},{key:"getParentOverlay",value:function(e){if(!e)return null;var t=[this.topOverlay,this.leftOverlay,this.bottomOverlay,this.topLeftCornerOverlay,this.bottomLeftCornerOverlay],n=null;return(0,a.arrayEach)(t,function(t,o){t&&t.clone&&t.clone.wtTable.TABLE.contains(e)&&(n=t.clone)}),n}}]),e}();t.default=p},function(e,t,n){function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(0),s=n(18),a=function(){function e(t){o(this,e),this.wot=t,this.instance=t}return i(e,[{key:"scrollViewport",value:function(e){if(this.wot.drawn){var t=this._getVariables(),n=t.topOverlay,o=t.leftOverlay,i=t.totalRows,r=t.totalColumns,s=t.fixedRowsTop,a=t.fixedRowsBottom,l=t.fixedColumnsLeft;if(e.row<0||e.row>Math.max(i-1,0))throw new Error("row "+e.row+" does not exist");if(e.col<0||e.col>Math.max(r-1,0))throw new Error("column "+e.col+" does not exist");e.row>=s&&e.row<this.getFirstVisibleRow()?n.scrollTo(e.row):e.row>this.getLastVisibleRow()&&e.row<i-a&&n.scrollTo(e.row,!0),e.col>=l&&e.col<this.getFirstVisibleColumn()?o.scrollTo(e.col):e.col>this.getLastVisibleColumn()&&o.scrollTo(e.col,!0)}}},{key:"getFirstVisibleRow",value:function(){var e=this._getVariables(),t=e.topOverlay,n=e.wtTable,o=e.wtViewport,i=e.totalRows,a=e.fixedRowsTop,l=n.getFirstVisibleRow();if(t.mainTableScrollableElement===window){var u=(0,r.offset)(n.wtRootElement),c=(0,r.innerHeight)(n.hider),d=(0,r.innerHeight)(window),h=(0,r.getScrollTop)(window);if(u.top+c-d<=h){var f=o.getColumnHeaderHeight();f+=t.sumCellSizes(0,a),(0,s.rangeEachReverse)(i,1,function(e){if(f+=t.sumCellSizes(e-1,e),u.top+c-f<=h)return l=e,!1})}}return l}},{key:"getLastVisibleRow",value:function(){var e=this._getVariables(),t=e.topOverlay,n=e.wtTable,o=e.wtViewport,i=e.totalRows,a=n.getLastVisibleRow();if(t.mainTableScrollableElement===window){var l=(0,r.offset)(n.wtRootElement),u=(0,r.innerHeight)(window),c=(0,r.getScrollTop)(window);if(l.top>c){var d=o.getColumnHeaderHeight();(0,s.rangeEach)(1,i,function(e){if(d+=t.sumCellSizes(e-1,e),l.top+d-c>=u)return a=e-2,!1})}}return a}},{key:"getFirstVisibleColumn",value:function(){var e=this._getVariables(),t=e.leftOverlay,n=e.wtTable,o=e.wtViewport,i=e.totalColumns,a=(e.fixedColumnsLeft,n.getFirstVisibleColumn());if(t.mainTableScrollableElement===window){var l=(0,r.offset)(n.wtRootElement),u=(0,r.innerWidth)(n.hider),c=(0,r.innerWidth)(window),d=(0,r.getScrollLeft)(window);if(l.left+u-c<=d){var h=o.getRowHeaderWidth();(0,s.rangeEachReverse)(i,1,function(e){if(h+=t.sumCellSizes(e-1,e),l.left+u-h<=d)return a=e,!1})}}return a}},{key:"getLastVisibleColumn",value:function(){var e=this._getVariables(),t=e.leftOverlay,n=e.wtTable,o=e.wtViewport,i=e.totalColumns,a=n.getLastVisibleColumn();if(t.mainTableScrollableElement===window){var l=(0,r.offset)(n.wtRootElement),u=(0,r.innerWidth)(window),c=(0,r.getScrollLeft)(window);if(l.left>c){var d=o.getRowHeaderWidth();(0,s.rangeEach)(1,i,function(e){if(d+=t.sumCellSizes(e-1,e),l.left+d-c>=u)return a=e-2,!1})}}return a}},{key:"_getVariables",value:function(){var e=this.wot;return{topOverlay:e.wtOverlays.topOverlay,leftOverlay:e.wtOverlays.leftOverlay,wtTable:e.wtTable,wtViewport:e.wtViewport,totalRows:e.getSetting("totalRows"),totalColumns:e.getSetting("totalColumns"),fixedRowsTop:e.getSetting("fixedRowsTop"),fixedRowsBottom:e.getSetting("fixedRowsBottom"),fixedColumnsLeft:e.getSetting("fixedColumnsLeft")}}}]),e}();t.default=a},function(e,t,n){function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(0),s=n(2),a=function(){function e(t,n){var i=this;o(this,e),this.wot=t,this.instance=t,this.defaults={table:void 0,debug:!1,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow:function(){return!1},data:void 0,freezeOverlays:!1,fixedColumnsLeft:0,fixedRowsTop:0,fixedRowsBottom:0,minSpareRows:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(e,t,n){var o=i.getSetting("data",e,t);(0,r.fastInnerText)(n,void 0===o||null===o?"":o)},columnWidth:function(e){},rowHeight:function(e){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:function(e){return e},onModifyRowHeaderWidth:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null},this.settings={};for(var a in this.defaults)if((0,s.hasOwnProperty)(this.defaults,a))if(void 0!==n[a])this.settings[a]=n[a];else{if(void 0===this.defaults[a])throw new Error('A required setting "'+a+'" was not provided');this.settings[a]=this.defaults[a]}}return i(e,[{key:"update",value:function(e,t){if(void 0===t)for(var n in e)(0,s.hasOwnProperty)(e,n)&&(this.settings[n]=e[n]);else this.settings[e]=t;return this.wot}},{key:"getSetting",value:function(e,t,n,o,i){return"function"==typeof this.settings[e]?this.settings[e](t,n,o,i):void 0!==t&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}},{key:"has",value:function(e){return!!this.settings[e]}}]),e}();t.default=a},function(e,t,n){function o(e){return e&&e.__esModule?e:{default:e}}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var a="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return void 0===e?"undefined":s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":s(e)},l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=n(0),c=n(38),d=n(41),h=o(d),f=n(65),p=(o(f),n(247)),g=o(p),m=n(248),v=o(m),w=n(253),y=o(w),C=n(22),b=o(C),S=function(){function e(t,n){var o=this;r(this,e),this.wot=t,this.instance=this.wot,this.TABLE=n,this.TBODY=null,this.THEAD=null,this.COLGROUP=null,this.tableOffset=0,this.holderOffset=0,(0,u.removeTextNodes)(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.colgroupChildrenLength=this.COLGROUP.childNodes.length,this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0,this.tbodyChildrenLength=this.TBODY.childNodes.length,this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;var i=this.wot.wtSettings.settings.rowHeaderWidth;this.wot.wtSettings.settings.rowHeaderWidth=function(){return o._modifyRowHeaderWidth(i)}}return l(e,[{key:"fixTableDomTree",value:function(){this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=document.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=document.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=document.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD)),this.wot.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length&&this.THEAD.appendChild(document.createElement("TR"))}},{key:"createSpreader",value:function(e){var t=e.parentNode,n=void 0;return t&&1===t.nodeType&&(0,u.hasClass)(t,"wtHolder")||(n=document.createElement("div"),n.className="wtSpreader",t&&t.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",n}},{key:"createHider",value:function(e){var t=e.parentNode,n=void 0;return t&&1===t.nodeType&&(0,u.hasClass)(t,"wtHolder")||(n=document.createElement("div"),n.className="wtHider",t&&t.insertBefore(n,e),n.appendChild(e)),n}},{key:"createHolder",value:function(e){var t=e.parentNode,n=void 0;return t&&1===t.nodeType&&(0,u.hasClass)(t,"wtHolder")||(n=document.createElement("div"),n.style.position="relative",n.className="wtHolder",t&&t.insertBefore(n,e),this.isWorkingOnClone()||(n.parentNode.className+="ht_master handsontable"),n.appendChild(e)),n}},{key:"alignOverlaysWithTrimmingContainer",value:function(){var e=(0,u.getTrimmingContainer)(this.wtRootElement);if(!this.isWorkingOnClone())if(this.holder.parentNode.style.position="relative",e===window){var t=this.wot.getSetting("preventOverflow");t||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible")}else this.holder.style.width=(0,u.getStyle)(e,"width"),this.holder.style.height=(0,u.getStyle)(e,"height"),this.holder.style.overflow=""}},{key:"isWorkingOnClone",value:function(){return!!this.wot.cloneSource}},{key:"draw",value:function(e){var t=this.wot,n=t.wtOverlays,o=t.wtViewport,i=this.instance.getSetting("totalRows"),r=this.wot.getSetting("rowHeaders").length,s=this.wot.getSetting("columnHeaders").length,a=!1;if(!this.isWorkingOnClone()&&(this.holderOffset=(0,u.offset)(this.holder),e=o.createRenderCalculators(e),r&&!this.wot.getSetting("fixedColumnsLeft"))){var l=n.leftOverlay.getScrollPosition(),c=this.correctHeaderWidth;this.correctHeaderWidth=l>0,c!==this.correctHeaderWidth&&(e=!1)}if(this.isWorkingOnClone()||(a=n.prepareOverlays()),e)this.isWorkingOnClone()||o.createVisibleCalculators(),n&&n.refresh(!0);else{this.isWorkingOnClone()?this.tableOffset=this.wot.cloneSource.wtTable.tableOffset:this.tableOffset=(0,u.offset)(this.TABLE);var d=void 0;d=b.default.isOverlayTypeOf(this.wot.cloneOverlay,b.default.CLONE_DEBUG)||b.default.isOverlayTypeOf(this.wot.cloneOverlay,b.default.CLONE_TOP)||b.default.isOverlayTypeOf(this.wot.cloneOverlay,b.default.CLONE_TOP_LEFT_CORNER)?0:b.default.isOverlayTypeOf(this.instance.cloneOverlay,b.default.CLONE_BOTTOM)||b.default.isOverlayTypeOf(this.instance.cloneOverlay,b.default.CLONE_BOTTOM_LEFT_CORNER)?Math.max(i-this.wot.getSetting("fixedRowsBottom"),0):o.rowsRenderCalculator.startRow;var h=void 0;h=b.default.isOverlayTypeOf(this.wot.cloneOverlay,b.default.CLONE_DEBUG)||b.default.isOverlayTypeOf(this.wot.cloneOverlay,b.default.CLONE_LEFT)||b.default.isOverlayTypeOf(this.wot.cloneOverlay,b.default.CLONE_TOP_LEFT_CORNER)||b.default.isOverlayTypeOf(this.wot.cloneOverlay,b.default.CLONE_BOTTOM_LEFT_CORNER)?0:o.columnsRenderCalculator.startColumn,this.rowFilter=new v.default(d,i,s),this.columnFilter=new g.default(h,this.wot.getSetting("totalColumns"),r),this.alignOverlaysWithTrimmingContainer(),this._doDraw()}return this.refreshSelections(e),this.isWorkingOnClone()||(n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&n.bottomOverlay.resetFixedPosition(),n.leftOverlay.resetFixedPosition(),n.topLeftCornerOverlay&&n.topLeftCornerOverlay.resetFixedPosition(),n.bottomLeftCornerOverlay&&n.bottomLeftCornerOverlay.clone&&n.bottomLeftCornerOverlay.resetFixedPosition()),a&&n.syncScrollWithMaster(),this.wot.drawn=!0,this}},{key:"_doDraw",value:function(){new y.default(this).render()}},{key:"removeClassFromCells",value:function(e){for(var t=this.TABLE.querySelectorAll("."+e),n=0,o=t.length;n<o;n++)(0,u.removeClass)(t[n],e)}},{key:"refreshSelections",value:function(e){if(this.wot.selections){var t=this.wot.selections.length;if(e)for(var n=0;n<t;n++)this.wot.selections[n].settings.className&&this.removeClassFromCells(this.wot.selections[n].settings.className),this.wot.selections[n].settings.highlightHeaderClassName&&this.removeClassFromCells(this.wot.selections[n].settings.highlightHeaderClassName),this.wot.selections[n].settings.highlightRowClassName&&this.removeClassFromCells(this.wot.selections[n].settings.highlightRowClassName),this.wot.selections[n].settings.highlightColumnClassName&&this.removeClassFromCells(this.wot.selections[n].settings.highlightColumnClassName);for(var o=0;o<t;o++)this.wot.selections[o].draw(this.wot,e)}}},{key:"getCell",value:function(e){if(this.isRowBeforeRenderedRows(e.row))return-1;if(this.isRowAfterRenderedRows(e.row))return-2;var t=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e.row)];return t?t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e.col)]:void 0}},{key:"getColumnHeader",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.THEAD.childNodes[t];if(n)return n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}},{key:"getRowHeader",value:function(e){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return null;var t=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];return t?t.childNodes[0]:void 0}},{key:"getCoords",value:function(e){if("TD"!==e.nodeName&&"TH"!==e.nodeName&&(e=(0,u.closest)(e,["TD","TH"])),null===e)return null;var t=e.parentNode,n=t.parentNode,o=(0,u.index)(t),i=e.cellIndex;return(0,u.overlayContainsElement)(b.default.CLONE_TOP_LEFT_CORNER,e)||(0,u.overlayContainsElement)(b.default.CLONE_TOP,e)?"THEAD"===n.nodeName&&(o-=n.childNodes.length):o=n===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter.renderedToSource(o),i=(0,u.overlayContainsElement)(b.default.CLONE_TOP_LEFT_CORNER,e)||(0,u.overlayContainsElement)(b.default.CLONE_LEFT,e)?this.columnFilter.offsettedTH(i):this.columnFilter.visibleRowHeadedColumnToSourceColumn(i),new h.default(o,i)}},{key:"getTrForRow",value:function(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}},{key:"getFirstRenderedRow",value:function(){return this.wot.wtViewport.rowsRenderCalculator.startRow}},{key:"getFirstVisibleRow",value:function(){return this.wot.wtViewport.rowsVisibleCalculator.startRow}},{key:"getFirstRenderedColumn",value:function(){return this.wot.wtViewport.columnsRenderCalculator.startColumn}},{key:"getFirstVisibleColumn",value:function(){return this.wot.wtViewport.columnsVisibleCalculator.startColumn}},{key:"getLastRenderedRow",value:function(){return this.wot.wtViewport.rowsRenderCalculator.endRow}},{key:"getLastVisibleRow",value:function(){return this.wot.wtViewport.rowsVisibleCalculator.endRow}},{key:"getLastRenderedColumn",value:function(){return this.wot.wtViewport.columnsRenderCalculator.endColumn}},{key:"getLastVisibleColumn",value:function(){return this.wot.wtViewport.columnsVisibleCalculator.endColumn}},{key:"isRowBeforeRenderedRows",value:function(e){return this.rowFilter&&this.rowFilter.sourceToRendered(e)<0&&e>=0}},{key:"isRowAfterViewport",value:function(e){return this.rowFilter&&this.rowFilter.sourceToRendered(e)>this.getLastVisibleRow()}},{key:"isRowAfterRenderedRows",value:function(e){return this.rowFilter&&this.rowFilter.sourceToRendered(e)>this.getLastRenderedRow()}},{key:"isColumnBeforeViewport",value:function(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}},{key:"isColumnAfterViewport",value:function(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)>this.getLastVisibleColumn()}},{key:"isLastRowFullyVisible",value:function(){return this.getLastVisibleRow()===this.getLastRenderedRow()}},{key:"isLastColumnFullyVisible",value:function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}},{key:"getRenderedColumnsCount",value:function(){var e=this.wot.wtViewport.columnsRenderCalculator.count,t=this.wot.getSetting("totalColumns");if(this.wot.isOverlayName(b.default.CLONE_DEBUG))e=t;else if(this.wot.isOverlayName(b.default.CLONE_LEFT)||this.wot.isOverlayName(b.default.CLONE_TOP_LEFT_CORNER)||this.wot.isOverlayName(b.default.CLONE_BOTTOM_LEFT_CORNER))return Math.min(this.wot.getSetting("fixedColumnsLeft"),t);return e}},{key:"getRenderedRowsCount",value:function(){var e=this.wot.wtViewport.rowsRenderCalculator.count,t=this.wot.getSetting("totalRows");return this.wot.isOverlayName(b.default.CLONE_DEBUG)?e=t:this.wot.isOverlayName(b.default.CLONE_TOP)||this.wot.isOverlayName(b.default.CLONE_TOP_LEFT_CORNER)?e=Math.min(this.wot.getSetting("fixedRowsTop"),t):(this.wot.isOverlayName(b.default.CLONE_BOTTOM)||this.wot.isOverlayName(b.default.CLONE_BOTTOM_LEFT_CORNER))&&(e=Math.min(this.wot.getSetting("fixedRowsBottom"),t)),e}},{key:"getVisibleRowsCount",value:function(){return this.wot.wtViewport.rowsVisibleCalculator.count}},{key:"allRowsInViewport",value:function(){return this.wot.getSetting("totalRows")==this.getVisibleRowsCount()}},{key:"getRowHeight",value:function(e){var t=this.wot.wtSettings.settings.rowHeight(e),n=this.wot.wtViewport.oversizedRows[e];return void 0!==n&&(t=void 0===t?n:Math.max(t,n)),t}},{key:"getColumnHeaderHeight",value:function(e){var t=this.wot.wtSettings.settings.defaultRowHeight,n=this.wot.wtViewport.oversizedColumnHeaders[e];return void 0!==n&&(t=t?Math.max(t,n):n),t}},{key:"getVisibleColumnsCount",value:function(){return this.wot.wtViewport.columnsVisibleCalculator.count}},{key:"allColumnsInViewport",value:function(){return this.wot.getSetting("totalColumns")==this.getVisibleColumnsCount()}},{key:"getColumnWidth",value:function(e){var t=this.wot.wtSettings.settings.columnWidth;return"function"==typeof t?t=t(e):"object"===(void 0===t?"undefined":a(t))&&(t=t[e]),t||this.wot.wtSettings.settings.defaultColumnWidth}},{key:"getStretchedColumnWidth",value:function(e){var t=this.getColumnWidth(e),n=null==t?this.instance.wtSettings.settings.defaultColumnWidth:t,o=this.wot.wtViewport.columnsRenderCalculator;if(o){var i=o.getStretchedColumnWidth(e,n);i&&(n=i)}return n}},{key:"_modifyRowHeaderWidth",value:function(e){var t=(0,c.isFunction)(e)?e():null;return Array.isArray(t)?(t=[].concat(i(t)),t[t.length-1]=this._correctRowHeaderWidth(t[t.length-1])):t=this._correctRowHeaderWidth(t),t}},{key:"_correctRowHeaderWidth",value:function(e){return"number"!=typeof e&&(e=this.wot.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&e++,e}}]),e}();t.default=S},function(e,t,n){function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){var n=document.createElement("TH");return t.insertBefore(n,e),t.removeChild(e),n}function r(e,t){var n=document.createElement("TD");return t.insertBefore(n,e),t.removeChild(e),n}t.__esModule=!0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n(0),l=n(22),u=function(e){return e&&e.__esModule?e:{default:e}}(l),c=!1,d=function(){function e(t){o(this,e),this.wtTable=t,this.wot=t.instance,this.instance=t.instance,this.rowFilter=t.rowFilter,this.columnFilter=t.columnFilter,this.TABLE=t.TABLE,this.THEAD=t.THEAD,this.TBODY=t.TBODY,this.COLGROUP=t.COLGROUP,this.rowHeaders=[],this.rowHeaderCount=0,this.columnHeaders=[],this.columnHeaderCount=0,this.fixedRowsTop=0,this.fixedRowsBottom=0}return s(e,[{key:"render",value:function(){if(!this.wtTable.isWorkingOnClone()){var e={};if(this.wot.getSetting("beforeDraw",!0,e),!0===e.skipRender)return}this.rowHeaders=this.wot.getSetting("rowHeaders"),this.rowHeaderCount=this.rowHeaders.length,this.fixedRowsTop=this.wot.getSetting("fixedRowsTop"),this.fixedRowsBottom=this.wot.getSetting("fixedRowsBottom"),this.columnHeaders=this.wot.getSetting("columnHeaders"),this.columnHeaderCount=this.columnHeaders.length;var t=this.wtTable.getRenderedColumnsCount(),n=this.wtTable.getRenderedRowsCount(),o=this.wot.getSetting("totalColumns"),i=this.wot.getSetting("totalRows"),r=void 0,s=!1;if((u.default.isOverlayTypeOf(this.wot.cloneOverlay,u.default.CLONE_BOTTOM)||u.default.isOverlayTypeOf(this.wot.cloneOverlay,u.default.CLONE_BOTTOM_LEFT_CORNER))&&(this.columnHeaders=[],this.columnHeaderCount=0),o>=0&&(this.adjustAvailableNodes(),s=!0,this.renderColumnHeaders(),this.renderRows(i,n,t),this.wtTable.isWorkingOnClone()||(r=this.wot.wtViewport.getWorkspaceWidth(),this.wot.wtViewport.containerWidth=null),this.adjustColumnWidths(t),this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights()),s||this.adjustAvailableNodes(),this.removeRedundantRows(n),this.wtTable.isWorkingOnClone()&&!this.wot.isOverlayName(u.default.CLONE_BOTTOM)||this.markOversizedRows(),this.wtTable.isWorkingOnClone())this.wot.isOverlayName(u.default.CLONE_BOTTOM)&&this.wot.cloneSource.wtOverlays.adjustElementsSize();else{this.wot.wtViewport.createVisibleCalculators(),this.wot.wtOverlays.refresh(!1),this.wot.wtOverlays.applyToDOM();var l=(0,a.outerWidth)(this.wtTable.hider),c=(0,a.outerWidth)(this.wtTable.TABLE);if(0!==l&&c!==l&&this.adjustColumnWidths(t),r!==this.wot.wtViewport.getWorkspaceWidth()){this.wot.wtViewport.containerWidth=null;var d=this.wtTable.getFirstRenderedColumn(),h=this.wtTable.getLastRenderedColumn(),f=this.wot.getSetting("defaultColumnWidth"),p=this.wot.getSetting("rowHeaderWidth");if(null!=(p=this.instance.getSetting("onModifyRowHeaderWidth",p)))for(var g=0;g<this.rowHeaderCount;g++){var m=Array.isArray(p)?p[g]:p;m=null==m?f:m,this.COLGROUP.childNodes[g].style.width=m+"px"}for(var v=d;v<h;v++){var w=this.wtTable.getStretchedColumnWidth(v),y=this.columnFilter.sourceToRendered(v);this.COLGROUP.childNodes[y+this.rowHeaderCount].style.width=w+"px"}}this.wot.getSetting("onDraw",!0)}}},{key:"removeRedundantRows",value:function(e){for(;this.wtTable.tbodyChildrenLength>e;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--}},{key:"renderRows",value:function(e,t,n){for(var o=void 0,i=0,r=this.rowFilter.renderedToSource(i),s=this.wtTable.isWorkingOnClone();r<e&&r>=0&&(!c&&i>1e3&&(c=!0,console.warn('Performance tip: Handsontable rendered more than 1000 visible rows. Consider limiting the number of rendered rows by specifying the table height and/or turning off the "renderAllRows" option.')),void 0===t||i!==t);){if(o=this.getOrCreateTrForRow(i,o),this.renderRowHeaders(r,o),this.adjustColumns(o,n+this.rowHeaderCount),this.renderCells(r,o,n),s&&!this.wot.isOverlayName(u.default.CLONE_BOTTOM)||this.resetOversizedRow(r),o.firstChild){var a=this.wot.wtTable.getRowHeight(r);a?(a--,o.firstChild.style.height=a+"px"):o.firstChild.style.height=""}i++,r=this.rowFilter.renderedToSource(i)}}},{key:"resetOversizedRow",value:function(e){this.wot.getSetting("externalRowCalculator")||this.wot.wtViewport.oversizedRows&&this.wot.wtViewport.oversizedRows[e]&&(this.wot.wtViewport.oversizedRows[e]=void 0)}},{key:"markOversizedRows",value:function(){if(!this.wot.getSetting("externalRowCalculator")){var e=this.instance.wtTable.TBODY.childNodes.length,t=e*this.instance.wtSettings.settings.defaultRowHeight,n=(0,a.innerHeight)(this.instance.wtTable.TBODY)-1,o=void 0,i=void 0,r=void 0,s=void 0,l=void 0;this.instance.getSetting("totalRows");if(t!==n||this.instance.getSetting("fixedRowsBottom"))for(;e;)e--,r=this.instance.wtTable.rowFilter.renderedToSource(e),o=this.instance.wtTable.getRowHeight(r),s=this.instance.wtTable.getTrForRow(r),l=s.querySelector("th"),i=l?(0,a.innerHeight)(l):(0,a.innerHeight)(s)-1,(!o&&this.instance.wtSettings.settings.defaultRowHeight<i||o<i)&&(this.instance.wtViewport.oversizedRows[r]=++i)}}},{key:"markOversizedColumnHeaders",value:function(){var e=this.wot.getOverlayName();if(this.columnHeaderCount&&!this.wot.wtViewport.hasOversizedColumnHeadersMarked[e]&&!this.wtTable.isWorkingOnClone()){for(var t=this.wtTable.getRenderedColumnsCount(),n=0;n<this.columnHeaderCount;n++)for(var o=-1*this.rowHeaderCount;o<t;o++)this.markIfOversizedColumnHeader(o);this.wot.wtViewport.hasOversizedColumnHeadersMarked[e]=!0}}},{key:"adjustColumnHeaderHeights",value:function(){for(var e=this.wot.getSetting("columnHeaders"),t=this.wot.wtTable.THEAD.childNodes,n=this.wot.wtViewport.oversizedColumnHeaders,o=0,i=e.length;o<i;o++)if(n[o]){if(!t[o]||0===t[o].childNodes.length)return;t[o].childNodes[0].style.height=n[o]+"px"}}},{key:"markIfOversizedColumnHeader",value:function(e){for(var t=this.wot.wtTable.columnFilter.renderedToSource(e),n=this.columnHeaderCount,o=this.wot.wtSettings.settings.defaultRowHeight,i=void 0,r=void 0,s=void 0,l=this.wot.getSetting("columnHeaderHeight")||[];n;)n--,i=this.wot.wtTable.getColumnHeaderHeight(n),(r=this.wot.wtTable.getColumnHeader(t,n))&&(s=(0,a.innerHeight)(r),(!i&&o<s||i<s)&&(this.wot.wtViewport.oversizedColumnHeaders[n]=s),Array.isArray(l)?null!=l[n]&&(this.wot.wtViewport.oversizedColumnHeaders[n]=l[n]):isNaN(l)||(this.wot.wtViewport.oversizedColumnHeaders[n]=l),this.wot.wtViewport.oversizedColumnHeaders[n]<(l[n]||l)&&(this.wot.wtViewport.oversizedColumnHeaders[n]=l[n]||l))}},{key:"renderCells",value:function(e,t,n){for(var o=void 0,i=void 0,s=0;s<n;s++)i=this.columnFilter.renderedToSource(s),o=0===s?t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)]:o.nextSibling,"TH"==o.nodeName&&(o=r(o,t)),(0,a.hasClass)(o,"hide")||(o.className=""),o.removeAttribute("style"),this.wot.wtSettings.settings.cellRenderer(e,i,o);return o}},{key:"adjustColumnWidths",value:function(e){var t=0,n=this.wot.cloneSource?this.wot.cloneSource:this.wot,o=n.wtTable.holder,i=this.wot.getSetting("defaultColumnWidth"),r=this.wot.getSetting("rowHeaderWidth");if(o.offsetHeight<o.scrollHeight&&(t=(0,a.getScrollbarWidth)()),this.wot.wtViewport.columnsRenderCalculator.refreshStretching(this.wot.wtViewport.getViewportWidth()-t),null!=(r=this.instance.getSetting("onModifyRowHeaderWidth",r)))for(var s=0;s<this.rowHeaderCount;s++){var l=Array.isArray(r)?r[s]:r;l=null==l?i:l,this.COLGROUP.childNodes[s].style.width=l+"px"}for(var u=0;u<e;u++){var c=this.wtTable.getStretchedColumnWidth(this.columnFilter.renderedToSource(u));this.COLGROUP.childNodes[u+this.rowHeaderCount].style.width=c+"px"}}},{key:"appendToTbody",value:function(e){this.TBODY.appendChild(e),this.wtTable.tbodyChildrenLength++}},{key:"getOrCreateTrForRow",value:function(e,t){var n=void 0;return e>=this.wtTable.tbodyChildrenLength?(n=this.createRow(),this.appendToTbody(n)):n=0===e?this.TBODY.firstChild:t.nextSibling,n.className&&n.removeAttribute("class"),n}},{key:"createRow",value:function(){for(var e=document.createElement("TR"),t=0;t<this.rowHeaderCount;t++)e.appendChild(document.createElement("TH"));return e}},{key:"renderRowHeader",value:function(e,t,n){n.className="",n.removeAttribute("style"),this.rowHeaders[t](e,n,t)}},{key:"renderRowHeaders",value:function(e,t){for(var n=t.firstChild,o=0;o<this.rowHeaderCount;o++)n?"TD"==n.nodeName&&(n=i(n,t)):(n=document.createElement("TH"),t.appendChild(n)),this.renderRowHeader(e,o,n),n=n.nextSibling}},{key:"adjustAvailableNodes",value:function(){this.adjustColGroups(),this.adjustThead()}},{key:"renderColumnHeaders",value:function(){if(this.columnHeaderCount)for(var e=this.wtTable.getRenderedColumnsCount(),t=0;t<this.columnHeaderCount;t++)for(var n=this.getTrForColumnHeaders(t),o=-1*this.rowHeaderCount;o<e;o++){var i=this.columnFilter.renderedToSource(o);this.renderColumnHeader(t,i,n.childNodes[o+this.rowHeaderCount])}}},{key:"adjustColGroups",value:function(){for(var e=this.wtTable.getRenderedColumnsCount();this.wtTable.colgroupChildrenLength<e+this.rowHeaderCount;)this.COLGROUP.appendChild(document.createElement("COL")),this.wtTable.colgroupChildrenLength++;for(;this.wtTable.colgroupChildrenLength>e+this.rowHeaderCount;)this.COLGROUP.removeChild(this.COLGROUP.lastChild),this.wtTable.colgroupChildrenLength--;this.rowHeaderCount&&(0,a.addClass)(this.COLGROUP.childNodes[0],"rowHeader")}},{key:"adjustThead",value:function(){var e=this.wtTable.getRenderedColumnsCount(),t=this.THEAD.firstChild;if(this.columnHeaders.length){for(var n=0,o=this.columnHeaders.length;n<o;n++){for(t=this.THEAD.childNodes[n],t||(t=document.createElement("TR"),this.THEAD.appendChild(t)),this.theadChildrenLength=t.childNodes.length;this.theadChildrenLength<e+this.rowHeaderCount;)t.appendChild(document.createElement("TH")),this.theadChildrenLength++;for(;this.theadChildrenLength>e+this.rowHeaderCount;)t.removeChild(t.lastChild),this.theadChildrenLength--}var i=this.THEAD.childNodes.length;if(i>this.columnHeaders.length)for(var r=this.columnHeaders.length;r<i;r++)this.THEAD.removeChild(this.THEAD.lastChild)}else t&&(0,a.empty)(t)}},{key:"getTrForColumnHeaders",value:function(e){return this.THEAD.childNodes[e]}},{key:"renderColumnHeader",value:function(e,t,n){return n.className="",n.removeAttribute("style"),this.columnHeaders[e](t,n,e)}},{key:"adjustColumns",value:function(e,t){for(var n=e.childNodes.length;n<t;){var o=document.createElement("TD");e.appendChild(o),n++}for(;n>t;)e.removeChild(e.lastChild),n--}},{key:"removeRedundantColumns",value:function(e){for(;this.wtTable.tbodyChildrenLength>e;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--}}]),e}();t.default=d},function(e,t,n){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=n(0),a=n(2),l=n(6),u=o(l),c=n(243),d=o(c),h=n(244),f=o(h),p=function(){function e(t){var n=this;i(this,e),this.wot=t,this.instance=this.wot,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.eventManager=new u.default(this.wot),this.eventManager.addEventListener(window,"resize",function(){n.clientHeight=n.getWorkspaceHeight()})}return r(e,[{key:"getWorkspaceHeight",value:function(){var e=this.instance.wtOverlays.topOverlay.trimmingContainer,t=void 0,n=0;return e===window?n=document.documentElement.clientHeight:(t=(0,s.outerHeight)(e),n=t>0&&e.clientHeight>0?e.clientHeight:1/0),n}},{key:"getWorkspaceWidth",value:function(){var e=void 0,t=this.wot.getSetting("totalColumns"),n=this.instance.wtOverlays.leftOverlay.trimmingContainer,o=void 0,i=this.wot.getSetting("stretchH"),r=document.documentElement.offsetWidth;return this.wot.getSetting("preventOverflow")?(0,s.outerWidth)(this.instance.wtTable.wtRootElement):(e=this.wot.getSetting("freezeOverlays")?Math.min(r-this.getWorkspaceOffset().left,r):Math.min(this.getContainerFillWidth(),r-this.getWorkspaceOffset().left,r),n===window&&t>0&&this.sumColumnWidths(0,t-1)>e?document.documentElement.clientWidth:n===window||"scroll"!=(o=(0,s.getStyle)(this.instance.wtOverlays.leftOverlay.trimmingContainer,"overflow"))&&"hidden"!=o&&"auto"!=o?"none"!==i&&i?e:Math.max(e,(0,s.outerWidth)(this.instance.wtTable.TABLE)):Math.max(e,n.clientWidth))}},{key:"hasVerticalScroll",value:function(){return this.getWorkspaceActualHeight()>this.getWorkspaceHeight()}},{key:"hasHorizontalScroll",value:function(){return this.getWorkspaceActualWidth()>this.getWorkspaceWidth()}},{key:"sumColumnWidths",value:function(e,t){for(var n=0;e<t;)n+=this.wot.wtTable.getColumnWidth(e),e++;return n}},{key:"getContainerFillWidth",value:function(){if(this.containerWidth)return this.containerWidth;var e=this.instance.wtTable.holder,t=void 0,n=void 0;return n=document.createElement("div"),n.style.width="100%",n.style.height="1px",e.appendChild(n),t=n.offsetWidth,this.containerWidth=t,e.removeChild(n),t}},{key:"getWorkspaceOffset",value:function(){return(0,s.offset)(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualHeight",value:function(){return(0,s.outerHeight)(this.wot.wtTable.TABLE)}},{key:"getWorkspaceActualWidth",value:function(){return(0,s.outerWidth)(this.wot.wtTable.TABLE)||(0,s.outerWidth)(this.wot.wtTable.TBODY)||(0,s.outerWidth)(this.wot.wtTable.THEAD)}},{key:"getColumnHeaderHeight",value:function(){return isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=(0,s.outerHeight)(this.wot.wtTable.THEAD)),this.columnHeaderHeight}},{key:"getViewportHeight",value:function(){var e=this.getWorkspaceHeight(),t=void 0;return e===1/0?e:(t=this.getColumnHeaderHeight(),t>0&&(e-=t),e)}},{key:"getRowHeaderWidth",value:function(){var e=this.instance.getSetting("rowHeaderWidth"),t=this.instance.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(var n=0,o=t.length;n<o;n++)this.rowHeaderWidth+=e[n]||e}if(this.wot.cloneSource)return this.wot.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth))if(t.length){var i=this.instance.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var r=0,a=t.length;r<a;r++)i?(this.rowHeaderWidth+=(0,s.outerWidth)(i),i=i.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.instance.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}},{key:"getViewportWidth",value:function(){var e=this.getWorkspaceWidth(),t=void 0;return e===1/0?e:(t=this.getRowHeaderWidth(),t>0?e-t:e)}},{key:"createRowsCalculator",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=void 0,o=void 0,i=void 0,r=void 0,a=void 0,l=void 0,u=void 0;return this.rowHeaderWidth=NaN,n=this.wot.wtSettings.settings.renderAllRows?1/0:this.getViewportHeight(),o=this.wot.wtOverlays.topOverlay.getScrollPosition()-this.wot.wtOverlays.topOverlay.getTableParentOffset(),o<0&&(o=0),i=this.wot.getSetting("fixedRowsTop"),a=this.wot.getSetting("fixedRowsBottom"),u=this.wot.getSetting("totalRows"),i&&(l=this.wot.wtOverlays.topOverlay.sumCellSizes(0,i),o+=l,n-=l),a&&this.wot.wtOverlays.bottomOverlay.clone&&(l=this.wot.wtOverlays.bottomOverlay.sumCellSizes(u-a,u),n-=l),r=this.wot.wtTable.holder.clientHeight===this.wot.wtTable.holder.offsetHeight?0:(0,s.getScrollbarWidth)(),new f.default(n,o,this.wot.getSetting("totalRows"),function(t){return e.wot.wtTable.getRowHeight(t)},t?null:this.wot.wtSettings.settings.viewportRowCalculatorOverride,t,r)}},{key:"createColumnsCalculator",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.getViewportWidth(),o=void 0,i=void 0;if(this.columnHeaderHeight=NaN,o=this.wot.wtOverlays.leftOverlay.getScrollPosition()-this.wot.wtOverlays.leftOverlay.getTableParentOffset(),o<0&&(o=0),i=this.wot.getSetting("fixedColumnsLeft")){var r=this.wot.wtOverlays.leftOverlay.sumCellSizes(0,i);o+=r,n-=r}return this.wot.wtTable.holder.clientWidth!==this.wot.wtTable.holder.offsetWidth&&(n-=(0,s.getScrollbarWidth)()),new d.default(n,o,this.wot.getSetting("totalColumns"),function(t){return e.wot.wtTable.getColumnWidth(t)},t?null:this.wot.wtSettings.settings.viewportColumnCalculatorOverride,t,this.wot.getSetting("stretchH"),function(t,n){return e.wot.getSetting("onBeforeStretchingColumnWidth",t,n)})}},{key:"createRenderCalculators",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e){var t=this.createRowsCalculator(!0),n=this.createColumnsCalculator(!0);this.areAllProposedVisibleRowsAlreadyRendered(t)&&this.areAllProposedVisibleColumnsAlreadyRendered(n)||(e=!1)}return e||(this.rowsRenderCalculator=this.createRowsCalculator(),this.columnsRenderCalculator=this.createColumnsCalculator()),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,e}},{key:"createVisibleCalculators",value:function(){this.rowsVisibleCalculator=this.createRowsCalculator(!0),this.columnsVisibleCalculator=this.createColumnsCalculator(!0)}},{key:"areAllProposedVisibleRowsAlreadyRendered",value:function(e){return!!this.rowsVisibleCalculator&&(!(e.startRow<this.rowsRenderCalculator.startRow||e.startRow===this.rowsRenderCalculator.startRow&&e.startRow>0)&&!(e.endRow>this.rowsRenderCalculator.endRow||e.endRow===this.rowsRenderCalculator.endRow&&e.endRow<this.wot.getSetting("totalRows")-1))}},{key:"areAllProposedVisibleColumnsAlreadyRendered",value:function(e){return!!this.columnsVisibleCalculator&&(!(e.startColumn<this.columnsRenderCalculator.startColumn||e.startColumn===this.columnsRenderCalculator.startColumn&&e.startColumn>0)&&!(e.endColumn>this.columnsRenderCalculator.endColumn||e.endColumn===this.columnsRenderCalculator.endColumn&&e.endColumn<this.wot.getSetting("totalColumns")-1))}},{key:"resetHasOversizedColumnHeadersMarked",value:function(){(0,a.objectEach)(this.hasOversizedColumnHeadersMarked,function(e,t,n){n[t]=void 0})}}]),e}();t.default=p},function(e,t,n){function o(e){h=!1;var t=this.getActiveEditor();if((0,i.isPrintableChar)(e.keyCode)||e.keyCode===i.KEY_CODES.BACKSPACE||e.keyCode===i.KEY_CODES.DELETE||e.keyCode===i.KEY_CODES.INSERT){var n=0;if(e.keyCode===i.KEY_CODES.C&&(e.ctrlKey||e.metaKey))return;t.isOpened()||(n+=10),t.htEditor&&t.instance._registerTimeout(setTimeout(function(){t.queryChoices(t.TEXTAREA.value),h=!0},n))}}t.__esModule=!0;var i=n(13),r=n(28),s=n(29),a=n(7),l=n(0),u=n(256),c=function(e){return e&&e.__esModule?e:{default:e}}(u),d=c.default.prototype.extend();d.prototype.init=function(){c.default.prototype.init.apply(this,arguments),this.query=null,this.strippedChoices=[],this.rawChoices=[]},d.prototype.getValue=function(){var e=this,t=this.rawChoices.find(function(t){return e.stripValueIfNeeded(t)===e.TEXTAREA.value});return(0,r.isDefined)(t)?t:this.TEXTAREA.value},d.prototype.createElements=function(){c.default.prototype.createElements.apply(this,arguments),(0,l.addClass)(this.htContainer,"autocompleteEditor"),(0,l.addClass)(this.htContainer,-1===window.navigator.platform.indexOf("Mac")?"":"htMacScroll")};var h=!1;d.prototype.prepare=function(){this.instance.addHook("beforeKeyDown",o),c.default.prototype.prepare.apply(this,arguments)},d.prototype.open=function(){this.TEXTAREA_PARENT.style.overflow="auto",c.default.prototype.open.apply(this,arguments),this.TEXTAREA_PARENT.style.overflow="";var e=this.htEditor.getInstance(),t=this,n=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown;this.TEXTAREA.style.visibility="visible",this.focus(),e.updateSettings({colWidths:n?[(0,l.outerWidth)(this.TEXTAREA)-2]:void 0,width:n?(0,l.outerWidth)(this.TEXTAREA)+(0,l.getScrollbarWidth)()+2:void 0,afterRenderer:function(e,n,o,i,s,a){var l=t.cellProperties,u=l.filteringCaseSensitive,c=l.allowHtml,d=void 0,h=void 0;s=(0,r.stringify)(s),s&&!c&&-1!==(d=!0===u?s.indexOf(this.query):s.toLowerCase().indexOf(t.query.toLowerCase()))&&(h=s.substr(d,t.query.length),s=s.replace(h,"<strong>"+h+"</strong>")),e.innerHTML=s},autoColumnSize:!0,modifyColWidth:function(e,t){var o=this.getPlugin("autoColumnSize").widths;return o[t]&&(e=o[t]),n?e:e+15}}),this.htEditor.view.wt.wtTable.holder.parentNode.style["padding-right"]=(0,l.getScrollbarWidth)()+2+"px",h&&(h=!1),t.instance._registerTimeout(setTimeout(function(){t.queryChoices(t.TEXTAREA.value)},0))},d.prototype.close=function(){c.default.prototype.close.apply(this,arguments)},d.prototype.queryChoices=function(e){var t=this;this.query=e;var n=this.cellProperties.source;"function"==typeof n?n.call(this.cellProperties,e,function(e){t.rawChoices=e,t.updateChoicesList(t.stripValuesIfNeeded(e))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])},d.prototype.updateChoicesList=function(e){var t=(0,l.getCaretPosition)(this.TEXTAREA),n=(0,l.getSelectionEndPosition)(this.TEXTAREA),o=this.cellProperties.sortByRelevance,i=this.cellProperties.filter,r=null,s=null;o&&(r=d.sortByRelevance(this.stripValueIfNeeded(this.getValue()),e,this.cellProperties.filteringCaseSensitive));var u=Array.isArray(r)?r.length:0;if(!1===i)u&&(s=r[0]);else{for(var c=[],h=0,f=e.length;h<f&&!(o&&u<=h);h++)u?c.push(e[r[h]]):c.push(e[h]);s=0,e=c}this.strippedChoices=e,this.htEditor.loadData((0,a.pivot)([e])),this.updateDropdownHeight(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(s),this.instance.listen(),this.TEXTAREA.focus(),(0,l.setCaretPosition)(this.TEXTAREA,t,t===n?void 0:n)},d.prototype.flipDropdownIfNeeded=function(){var e=(0,l.offset)(this.TEXTAREA),t=(0,l.outerHeight)(this.TEXTAREA),n=this.getDropdownHeight(),o=(0,l.getTrimmingContainer)(this.instance.view.wt.wtTable.TABLE),i=o.scrollTop,r=(0,l.outerHeight)(this.instance.view.wt.wtTable.THEAD),s={row:0,col:0};o!==window&&(s=(0,l.offset)(o));var a=e.top-s.top-r+i,u=o.scrollHeight-a-r-t,c=n>u&&a>u;return c?this.flipDropdown(n):this.unflipDropdown(),this.limitDropdownIfNeeded(c?a:u,n),c},d.prototype.limitDropdownIfNeeded=function(e,t){if(t>e){var n=0,o=0,i=0,r=null;do{i=this.htEditor.getRowHeight(o)||this.htEditor.view.wt.wtSettings.settings.defaultRowHeight,n+=i,o++}while(n<e);r=n-i,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=parseInt(this.htEditor.rootElement.style.top,10)+t-r+"px"),this.setDropdownHeight(n-i)}},d.prototype.flipDropdown=function(e){var t=this.htEditor.rootElement.style;t.position="absolute",t.top=-e+"px",this.htEditor.flipped=!0},d.prototype.unflipDropdown=function(){var e=this.htEditor.rootElement.style;"absolute"===e.position&&(e.position="",e.top=""),this.htEditor.flipped=void 0},d.prototype.updateDropdownHeight=function(){var e=this.htEditor.getColWidth(0)+(0,l.getScrollbarWidth)()+2,t=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:t?void 0:e}),this.htEditor.view.wt.wtTable.alignOverlaysWithTrimmingContainer()},d.prototype.setDropdownHeight=function(e){this.htEditor.updateSettings({height:e})},d.prototype.finishEditing=function(e){e||this.instance.removeHook("beforeKeyDown",o),c.default.prototype.finishEditing.apply(this,arguments)},d.prototype.highlightBestMatchingChoice=function(e){"number"==typeof e?this.htEditor.selectCell(e,0):this.htEditor.deselectCell()},d.sortByRelevance=function(e,t,n){var o=[],i=void 0,a=e.length,l=void 0,u=void 0,c=[],d=void 0,h=t.length;if(0===a){for(d=0;d<h;d++)c.push(d);return c}for(d=0;d<h;d++)i=(0,s.stripTags)((0,r.stringify)(t[d])),-1!==(l=n?i.indexOf(e):i.toLowerCase().indexOf(e.toLowerCase()))&&(u=i.length-l-a,o.push({baseIndex:d,index:l,charsLeft:u,value:i}));for(o.sort(function(e,t){if(-1===t.index)return-1;if(-1===e.index)return 1;if(e.index<t.index)return-1;if(t.index<e.index)return 1;if(e.index===t.index){if(e.charsLeft<t.charsLeft)return-1;if(e.charsLeft>t.charsLeft)return 1}return 0}),d=0,h=o.length;d<h;d++)c.push(o[d].baseIndex);return c},d.prototype.getDropdownHeight=function(){var e=this.htEditor.getInstance().getRowHeight(0)||23,t=this.cellProperties.visibleRows;return this.strippedChoices.length>=t?t*e:this.strippedChoices.length*e+8},d.prototype.stripValueIfNeeded=function(e){return this.stripValuesIfNeeded([e])[0]},d.prototype.stripValuesIfNeeded=function(e){var t=this.cellProperties.allowHtml,n=(0,a.arrayMap)(e,function(e){return(0,r.stringify)(e)});return(0,a.arrayMap)(n,function(e){return t?e:(0,s.stripTags)(e)})},d.prototype.allowKeyEventPropagation=function(e){var t={row:this.htEditor.getSelectedRange()?this.htEditor.getSelectedRange().from.row:-1},n=!1;return e===i.KEY_CODES.ARROW_DOWN&&t.row>0&&t.row<this.htEditor.countRows()-1&&(n=!0),e===i.KEY_CODES.ARROW_UP&&t.row>-1&&(n=!0),n},d.prototype.discardEditor=function(e){c.default.prototype.discardEditor.apply(this,arguments),this.instance.view.render()},t.default=d},function(e,t,n){t.__esModule=!0;var o=n(13),i=n(2),r=n(0),s=n(10),a=n(42),l=function(e){return e&&e.__esModule?e:{default:e}}(a),u=l.default.prototype.extend();u.prototype.createElements=function(){l.default.prototype.createElements.apply(this,arguments);var e=document.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()},u.prototype.prepare=function(e,t,n,o,r,s){l.default.prototype.prepare.apply(this,arguments);var a=this,u={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,afterOnCellMouseDown:function(e,t){var n=this.getSourceData(t.row,t.col);void 0!==n&&a.setValue(n),a.instance.destroyEditor()}};this.cellProperties.handsontable&&(0,i.extend)(u,s.handsontable),this.htOptions=u};var c=function(e){if(!(0,s.isImmediatePropagationStopped)(e)){var t,n,i=this.getActiveEditor(),r=i.htEditor.getInstance();if(e.keyCode==o.KEY_CODES.ARROW_DOWN)if(r.getSelected()||r.flipped){if(r.getSelected())if(r.flipped)t=r.getSelected()[0]+1;else if(!r.flipped){n=r.getSelected()[0];var a=r.countRows()-1;t=Math.min(a,n+1)}}else t=0;else e.keyCode==o.KEY_CODES.ARROW_UP&&(!r.getSelected()&&r.flipped?t=r.countRows()-1:r.getSelected()&&(r.flipped?(n=r.getSelected()[0],t=Math.max(0,n-1)):(n=r.getSelected()[0],t=n-1)));void 0!==t&&(t<0||r.flipped&&t>r.countRows()-1?r.deselectCell():r.selectCell(t,0),r.getData().length&&(e.preventDefault(),(0,s.stopImmediatePropagation)(e),i.instance.listen(),i.TEXTAREA.focus()))}};u.prototype.open=function(){this.instance.addHook("beforeKeyDown",c),l.default.prototype.open.apply(this,arguments),this.htEditor&&this.htEditor.destroy(),this.htEditor=new this.instance.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.cellProperties.strict?(this.htEditor.selectCell(0,0),this.TEXTAREA.style.visibility="hidden"):(this.htEditor.deselectCell(),this.TEXTAREA.style.visibility="visible"),(0,r.setCaretPosition)(this.TEXTAREA,0,this.TEXTAREA.value.length)},u.prototype.close=function(){this.instance.removeHook("beforeKeyDown",c),this.instance.listen(),l.default.prototype.close.apply(this,arguments)},u.prototype.focus=function(){this.instance.listen(),l.default.prototype.focus.apply(this,arguments)},u.prototype.beginEditing=function(e){var t=this.instance.getSettings().onBeginEditing;t&&!1===t()||l.default.prototype.beginEditing.apply(this,arguments)},u.prototype.finishEditing=function(e,t){if(this.htEditor&&this.htEditor.isListening()&&this.instance.listen(),this.htEditor&&this.htEditor.getSelected()){var n=this.htEditor.getInstance().getValue();void 0!==n&&this.setValue(n)}return l.default.prototype.finishEditing.apply(this,arguments)},u.prototype.assignHooks=function(){var e=this;this.instance.addHook("afterDestroy",function(){e.htEditor&&e.htEditor.destroy()})},t.default=u},function(e,t,n){function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(2),s=n(7),a=n(258),l=n(39),u=new WeakMap,c=null,d=function(){function e(t){var n=this;o(this,e),(0,r.defineGetter)(this,"hot",t,{writable:!1}),(0,r.defineGetter)(this,"t",(0,a.getTranslator)(t),{writable:!1}),u.set(this,{hooks:{}}),c=null,this.pluginName=null,this.pluginsInitializedCallbacks=[],this.isPluginsReady=!1,this.enabled=!1,this.initialized=!1,this.hot.addHook("afterPluginsInitialized",function(){return n.onAfterPluginsInitialized()}),this.hot.addHook("afterUpdateSettings",function(){return n.onUpdateSettings()}),this.hot.addHook("beforeInit",function(){return n.init()})}return i(e,[{key:"init",value:function(){this.pluginName=(0,l.getPluginName)(this.hot,this),this.isEnabled&&this.isEnabled()&&this.enablePlugin(),c||(c=(0,l.getRegistredPluginNames)(this.hot)),c.indexOf(this.pluginName)>=0&&c.splice(c.indexOf(this.pluginName),1),c.length||this.hot.runHooks("afterPluginsInitialized"),this.initialized=!0}},{key:"enablePlugin",value:function(){this.enabled=!0}},{key:"disablePlugin",value:function(){this.eventManager&&this.eventManager.clear(),this.clearHooks(),this.enabled=!1}},{key:"addHook",value:function(e,t){u.get(this).hooks[e]=u.get(this).hooks[e]||[];var n=u.get(this).hooks[e];this.hot.addHook(e,t),n.push(t),u.get(this).hooks[e]=n}},{key:"removeHooks",value:function(e){var t=this;(0,s.arrayEach)(u.get(this).hooks[e]||[],function(n){t.hot.removeHook(e,n)})}},{key:"clearHooks",value:function(){var e=this,t=u.get(this).hooks;(0,r.objectEach)(t,function(t,n){return e.removeHooks(n)}),t.length=0}},{key:"callOnPluginsReady",value:function(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}},{key:"onAfterPluginsInitialized",value:function(){(0,s.arrayEach)(this.pluginsInitializedCallbacks,function(e){return e()}),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}},{key:"onUpdateSettings",value:function(){this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&this.updatePlugin())}},{key:"updatePlugin",value:function(){}},{key:"destroy",value:function(){var e=this;this.eventManager&&this.eventManager.destroy(),this.clearHooks(),(0,r.objectEach)(this,function(t,n){"hot"!==n&&"t"!==n&&(e[n]=null)}),delete this.t,delete this.hot}}]),e}();t.default=d},function(e,t,n){function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){d.set(e,t)}function r(e){var t=void 0;if(!(e instanceof l.default)){if(!d.has(e))throw Error("Record translator was not registered for this object identity");e=d.get(e)}return h.has(e)?t=h.get(e):(t=new c(e),h.set(e,t)),t}t.__esModule=!0,t.RecordTranslator=void 0;var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();t.registerIdentity=i,t.getTranslator=r;var a=n(81),l=function(e){return e&&e.__esModule?e:{default:e}}(a),u=n(2),c=function(){function e(t){o(this,e),this.hot=t}return s(e,[{key:"toVisualRow",value:function(e){return this.hot.runHooks("unmodifyRow",e)}},{key:"toVisualColumn",value:function(e){return this.hot.runHooks("unmodifyCol",e)}},{key:"toVisual",value:function(e,t){return(0,u.isObject)(e)?{row:this.toVisualRow(e.row),column:this.toVisualColumn(e.column)}:[this.toVisualRow(e),this.toVisualColumn(t)]}},{key:"toPhysicalRow",value:function(e){return this.hot.runHooks("modifyRow",e)}},{key:"toPhysicalColumn",value:function(e){return this.hot.runHooks("modifyCol",e)}},{key:"toPhysical",value:function(e,t){return(0,u.isObject)(e)?{row:this.toPhysicalRow(e.row),column:this.toPhysicalColumn(e.column)}:[this.toPhysicalRow(e),this.toPhysicalColumn(t)]}}]),e}();t.RecordTranslator=c;var d=new WeakMap,h=new WeakMap},function(e,t,n){var o=n(16),i=n(17),r=n(59);e.exports=function(e){return function(t,n,s){var a,l=o(t),u=i(l.length),c=r(s,u);if(e&&n!=n){for(;u>c;)if((a=l[c++])!=a)return!0}else for(;u>c;c++)if((e||c in l)&&l[c]===n)return e||c||0;return!e&&-1}}},function(e,t,n){var o=n(33),i=n(4)("toStringTag"),r="Arguments"==o(function(){return arguments}()),s=function(e,t){try{return e[t]}catch(e){}};e.exports=function(e){var t,n,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=s(t=Object(e),i))?n:r?o(t):"Object"==(a=o(t))&&"function"==typeof t.callee?"Arguments":a}},function(e,t,n){var o=n(12).f,i=n(73),r=n(58),s=n(23),a=n(51),l=n(24),u=n(55),c=n(270),d=n(271),h=n(276),f=n(14),p=n(45).fastKey,g=f?"_s":"size",m=function(e,t){var n,o=p(t);if("F"!==o)return e._i[o];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,c){var d=e(function(e,o){a(e,d,t,"_i"),e._i=i(null),e._f=void 0,e._l=void 0,e[g]=0,void 0!=o&&u(o,n,e[c],e)});return r(d.prototype,{clear:function(){for(var e=this,t=e._i,n=e._f;n;n=n.n)n.r=!0,n.p&&(n.p=n.p.n=void 0),delete t[n.i];e._f=e._l=void 0,e[g]=0},delete:function(e){var t=this,n=m(t,e);if(n){var o=n.n,i=n.p;delete t._i[n.i],n.r=!0,i&&(i.n=o),o&&(o.p=i),t._f==n&&(t._f=o),t._l==n&&(t._l=i),t[g]--}return!!n},forEach:function(e){a(this,d,"forEach");for(var t,n=s(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.n:this._f;)for(n(t.v,t.k,this);t&&t.r;)t=t.p},has:function(e){return!!m(this,e)}}),f&&o(d.prototype,"size",{get:function(){return l(this[g])}}),d},def:function(e,t,n){var o,i,r=m(e,t);return r?r.v=n:(e._l=r={i:i=p(t,!0),k:t,v:n,p:o=e._l,n:void 0,r:!1},e._f||(e._f=r),o&&(o.n=r),e[g]++,"F"!==i&&(e._i[i]=r)),e},getEntry:m,setStrong:function(e,t,n){c(e,t,function(e,t){this._t=e,this._k=t,this._l=void 0},function(){for(var e=this,t=e._k,n=e._l;n&&n.r;)n=n.p;return e._t&&(e._l=n=n?n.n:e._t._f)?"keys"==t?d(0,n.k):"values"==t?d(0,n.v):d(0,[n.k,n.v]):(e._t=void 0,d(1))},n?"entries":"values",!n,!0),h(t)}}},function(e,t,n){var o=n(58),i=n(45).getWeak,r=n(11),s=n(9),a=n(51),l=n(55),u=n(52),c=n(15),d=u(5),h=u(6),f=0,p=function(e){return e._l||(e._l=new g)},g=function(){this.a=[]},m=function(e,t){return d(e.a,function(e){return e[0]===t})};g.prototype={get:function(e){var t=m(this,e);if(t)return t[1]},has:function(e){return!!m(this,e)},set:function(e,t){var n=m(this,e);n?n[1]=t:this.a.push([e,t])},delete:function(e){var t=h(this.a,function(t){return t[0]===e});return~t&&this.a.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,n,r){var u=e(function(e,o){a(e,u,t,"_i"),e._i=f++,e._l=void 0,void 0!=o&&l(o,n,e[r],e)});return o(u.prototype,{delete:function(e){if(!s(e))return!1;var t=i(e);return!0===t?p(this).delete(e):t&&c(t,this._i)&&delete t[this._i]},has:function(e){if(!s(e))return!1;var t=i(e);return!0===t?p(this).has(e):t&&c(t,this._i)}}),u},def:function(e,t,n){var o=i(r(t),!0);return!0===o?p(e).set(t,n):o[e._i]=n,e},ufstore:p}},function(e,t,n){e.exports=n(5).document&&document.documentElement},function(e,t,n){e.exports=!n(14)&&!n(25)(function(){return 7!=Object.defineProperty(n(68)("div"),"a",{get:function(){return 7}}).a})},function(e,t,n){var o=n(44),i=n(4)("iterator"),r=Array.prototype;e.exports=function(e){return void 0!==e&&(o.Array===e||r[i]===e)}},function(e,t,n){var o=n(33);e.exports=Array.isArray||function(e){return"Array"==o(e)}},function(e,t,n){var o=n(9),i=Math.floor;e.exports=function(e){return!o(e)&&isFinite(e)&&i(e)===e}},function(e,t,n){var o=n(9),i=n(33),r=n(4)("match");e.exports=function(e){var t;return o(e)&&(void 0!==(t=e[r])?!!t:"RegExp"==i(e))}},function(e,t,n){var o=n(11);e.exports=function(e,t,n,i){try{return i?t(o(n)[0],n[1]):t(n)}catch(t){var r=e.return;throw void 0!==r&&o(r.call(e)),t}}},function(e,t,n){var o=n(56),i=n(1),r=n(27),s=n(26),a=n(15),l=n(44),u=n(340),c=n(47),d=n(345),h=n(4)("iterator"),f=!([].keys&&"next"in[].keys()),p=function(){return this};e.exports=function(e,t,n,g,m,v,w){u(n,t,g);var y,C,b,S=function(e){if(!f&&e in O)return O[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},T=t+" Iterator",E="values"==m,R=!1,O=e.prototype,_=O[h]||O["@@iterator"]||m&&O[m],k=_||S(m),M=m?E?S("entries"):k:void 0,D="Array"==t?O.entries||_:_;if(D&&(b=d(D.call(new e)))!==Object.prototype&&(c(b,T,!0),o||a(b,h)||s(b,h,p)),E&&_&&"values"!==_.name&&(R=!0,k=function(){return _.call(this)}),o&&!w||!f&&!R&&O[h]||s(O,h,k),l[t]=k,l[T]=p,m)if(y={values:E?k:S("values"),keys:v?k:S("keys"),entries:M},w)for(C in y)C in O||r(O,C,y[C]);else i(i.P+i.F*(f||R),t,y);return y}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){var o=n(34),i=n(57),r=n(46),s=n(36),a=n(71),l=Object.assign;e.exports=!l||n(25)(function(){var e={},t={},n=Symbol(),o="abcdefghijklmnopqrst";return e[n]=7,o.split("").forEach(function(e){t[e]=e}),7!=l({},e)[n]||Object.keys(l({},t)).join("")!=o})?function(e,t){for(var n=s(e),l=arguments.length,u=1,c=i.f,d=r.f;l>u;)for(var h,f=a(arguments[u++]),p=c?o(f).concat(c(f)):o(f),g=p.length,m=0;g>m;)d.call(f,h=p[m++])&&(n[h]=f[h]);return n}:l},function(e,t,n){var o=n(15),i=n(16),r=n(259)(!1),s=n(76)("IE_PROTO");e.exports=function(e,t){var n,a=i(e),l=0,u=[];for(n in a)n!=s&&o(a,n)&&u.push(n);for(;t.length>l;)o(a,n=t[l++])&&(~r(u,n)||u.push(n));return u}},function(e,t,n){var o=n(34),i=n(16),r=n(46).f;e.exports=function(e){return function(t){for(var n,s=i(t),a=o(s),l=a.length,u=0,c=[];l>u;)r.call(s,n=a[u++])&&c.push(e?[n,s[n]]:s[n]);return c}}},function(e,t,n){var o=n(9),i=n(11),r=function(e,t){if(i(e),!o(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,o){try{o=n(23)(Function.call,n(74).f(Object.prototype,"__proto__").set,2),o(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return r(e,n),t?e.__proto__=n:o(e,n),e}}({},!1):void 0),check:r}},function(e,t,n){var o=n(5),i=n(12),r=n(14),s=n(4)("species");e.exports=function(e){var t=o[e];r&&t&&!t[s]&&i.f(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,n){var o=n(17),i=n(278),r=n(24);e.exports=function(e,t,n,s){var a=String(r(e)),l=a.length,u=void 0===n?" ":String(n),c=o(t);if(c<=l||""==u)return a;var d=c-l,h=i.call(u,Math.ceil(d/u.length));return h.length>d&&(h=h.slice(0,d)),s?h+a:a+h}},function(e,t,n){var o=n(60),i=n(24);e.exports=function(e){var t=String(i(this)),n="",r=o(e);if(r<0||r==1/0)throw RangeError("Count can't be negative");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n}},function(e,t,n){t.f=n(4)},function(e,t,n){var o=n(260),i=n(4)("iterator"),r=n(44);e.exports=n(43).getIteratorMethod=function(e){if(void 0!=e)return e[i]||e["@@iterator"]||r[o(e)]}},function(e,t,n){function o(e){var t="undefined"!=typeof window&&window.jQuery;t&&(t.fn.handsontable=function(t){var n=this.first(),o=n.data("handsontable");if("string"!=typeof t){var i=t||{};return o?o.updateSettings(i):(o=new e.Core(n[0],i),n.data("handsontable",o),o.init()),n}var r=[],s=void 0;if(arguments.length>1)for(var a=1,l=arguments.length;a<l;a++)r.push(arguments[a]);if(o){if(void 0===o[t])throw new Error("Handsontable do not provide action: "+t);s=o[t].apply(o,r),"destroy"===t&&n.removeData()}return s})}t.__esModule=!0,t.default=o},function(e,t,n){function o(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0,t.Base=t.UndoRedo=t.TouchScroll=t.DragToScroll=void 0;var i=n(316),r=o(i),s=n(317),a=o(s),l=n(318),u=o(l),c=n(257),d=o(c);t.DragToScroll=r.default,t.TouchScroll=a.default,t.UndoRedo=u.default,t.Base=d.default},function(e,t,n){function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(0),s=n(7),a=function(){function e(t){o(this,e),this.hot=t,this.container=null,this.injected=!1,this.rows=[],this.columns=[],this.samples=null,this.settings={useHeaders:!0}}return i(e,[{key:"addRow",value:function(e,t){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={row:e};this.rows.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"addColumnHeadersRow",value:function(e){if(null!=this.hot.getColHeader(0)){var t={row:-1};this.rows.push(t),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.table.tHead.appendChild(this.createColumnHeadersRow()),this.container.container.appendChild(this.table.fragment),t.table=this.table.table}}},{key:"addColumn",value:function(e,t){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));var n={col:e};this.columns.push(n),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(e)&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}},{key:"getHeights",value:function(e){this.injected||this.injectTable(),(0,s.arrayEach)(this.rows,function(t){e(t.row,(0,r.outerHeight)(t.table)-1)})}},{key:"getWidths",value:function(e){this.injected||this.injectTable(),(0,s.arrayEach)(this.columns,function(t){e(t.col,(0,r.outerWidth)(t.table))})}},{key:"setSettings",value:function(e){this.settings=e}},{key:"setSetting",value:function(e,t){this.settings||(this.settings={}),this.settings[e]=t}},{key:"getSettings",value:function(){return this.settings}},{key:"getSetting",value:function(e){return this.settings?this.settings[e]:null}},{key:"createColGroupsCol",value:function(){var e=this,t=document,n=t.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1)),this.samples.forEach(function(t){(0,s.arrayEach)(t.strings,function(t){n.appendChild(e.createColElement(t.col))})}),n}},{key:"createRow",value:function(e){var t=this,n=document,o=n.createDocumentFragment(),i=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),o.appendChild(i)),this.samples.forEach(function(i){(0,s.arrayEach)(i.strings,function(i){var r=i.col,s=t.hot.getCellMeta(e,r);s.col=r,s.row=e;var a=t.hot.getCellRenderer(s),l=n.createElement("td");a(t.hot,l,e,r,t.hot.colToProp(r),i.value,s),o.appendChild(l)})}),o}},{key:"createColumnHeadersRow",value:function(){var e=this,t=document,n=t.createDocumentFragment();if(this.hot.hasRowHeaders()){var o=t.createElement("th");this.hot.view.appendColHeader(-1,o),n.appendChild(o)}return this.samples.forEach(function(o){(0,s.arrayEach)(o.strings,function(o){var i=o.col,r=t.createElement("th");e.hot.view.appendColHeader(i,r),n.appendChild(r)})}),n}},{key:"createCol",value:function(e){var t=this,n=document,o=n.createDocumentFragment();return this.samples.forEach(function(i){(0,s.arrayEach)(i.strings,function(i){var r=i.row,s=t.hot.getCellMeta(r,e);s.col=e,s.row=r;var a=t.hot.getCellRenderer(s),l=n.createElement("td"),u=n.createElement("tr");a(t.hot,l,r,e,t.hot.colToProp(e),i.value,s),u.appendChild(l),o.appendChild(u)})}),o}},{key:"clean",value:function(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}},{key:"injectTable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}},{key:"removeTable",value:function(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}},{key:"createColElement",value:function(e){var t=document,n=t.createElement("col");return n.style.width=this.hot.view.wt.wtTable.getStretchedColumnWidth(e)+"px",n}},{key:"createTable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=document,n=t.createDocumentFragment(),o=t.createElement("table"),i=t.createElement("thead"),s=t.createElement("tbody"),a=t.createElement("colgroup"),l=t.createElement("tr"),u=t.createElement("th");return this.isVertical()&&o.appendChild(a),this.isHorizontal()&&(l.appendChild(u),i.appendChild(l),o.style.tableLayout="auto",o.style.width="auto"),o.appendChild(i),this.isVertical()&&s.appendChild(l),o.appendChild(s),(0,r.addClass)(o,e),n.appendChild(o),{fragment:n,table:o,tHead:i,tBody:s,colGroup:a,tr:l,th:u}}},{key:"createContainer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=document,n=t.createDocumentFragment(),o=t.createElement("div");return e="htGhostTable htAutoSize "+e.trim(),(0,r.addClass)(o,e),n.appendChild(o),{fragment:n,container:o}}},{key:"isVertical",value:function(){return!(!this.rows.length||this.columns.length)}},{key:"isHorizontal",value:function(){return!(!this.columns.length||this.rows.length)}}]),e}();t.default=a},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){!function(e){function n(e){return e.split('"').length-1}var o={parse:function(e){var t,o,i,r,s,a,l,u=[],c=0;for(i=e.split("\n"),i.length>1&&""===i[i.length-1]&&i.pop(),t=0,o=i.length;t<o;t+=1){for(i[t]=i[t].split("\t"),r=0,s=i[t].length;r<s;r+=1)u[c]||(u[c]=[]),a&&0===r?(l=u[c].length-1,u[c][l]=u[c][l]+"\n"+i[t][0],a&&1&n(i[t][0])&&(a=!1,u[c][l]=u[c][l].substring(0,u[c][l].length-1).replace(/""/g,'"'))):r===s-1&&0===i[t][r].indexOf('"')&&1&n(i[t][r])?(u[c].push(i[t][r].substring(1).replace(/""/g,'"')),a=!0):(u[c].push(i[t][r].replace(/""/g,'"')),a=!1);a||(c+=1)}return u},stringify:function(e){var t,n,o,i,r,s="";for(t=0,n=e.length;t<n;t+=1){for(i=e[t].length,o=0;o<i;o+=1)o>0&&(s+="\t"),r=e[t][o],"string"==typeof r?r.indexOf("\n")>-1?s+='"'+r.replace(/"/g,'""')+'"':s+=r:s+=null===r||void 0===r?"":r;t!==n-1&&(s+="\n")}return s}};t.parse=o.parse,t.stringify=o.stringify}(window)},function(e,t,n){function o(){function e(e){return e.currentStyle||document.defaultView.getComputedStyle(e)}var t,n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},o=document.body,i=document.createTextNode(""),r=document.createElement("SPAN"),s=function(e,t,n){window.attachEvent?e.attachEvent("on"+t,n):e.addEventListener(t,n,!1)},a=function(e,t,n){window.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent("on"+t,n)},l=function(s){var a,l;s?/^[a-zA-Z \.,\\\/\|0-9]$/.test(s)||(s="."):s="",void 0!==i.textContent?i.textContent=t.value+s:i.data=t.value+s,r.style.fontSize=e(t).fontSize,r.style.fontFamily=e(t).fontFamily,r.style.whiteSpace="pre",o.appendChild(r),a=r.clientWidth+2,o.removeChild(r),t.style.height=n.minHeight+"px",n.minWidth>a?t.style.width=n.minWidth+"px":a>n.maxWidth?t.style.width=n.maxWidth+"px":t.style.width=a+"px",l=t.scrollHeight?t.scrollHeight-1:0,n.minHeight>l?t.style.height=n.minHeight+"px":n.maxHeight<l?(t.style.height=n.maxHeight+"px",t.style.overflowY="visible"):t.style.height=l+"px"},u=function(){window.setTimeout(l,0)},c=function(e){if(e&&e.minHeight)if("inherit"==e.minHeight)n.minHeight=t.clientHeight;else{var o=parseInt(e.minHeight);isNaN(o)||(n.minHeight=o)}if(e&&e.maxHeight)if("inherit"==e.maxHeight)n.maxHeight=t.clientHeight;else{var s=parseInt(e.maxHeight);isNaN(s)||(n.maxHeight=s)}if(e&&e.minWidth)if("inherit"==e.minWidth)n.minWidth=t.clientWidth;else{var a=parseInt(e.minWidth);isNaN(a)||(n.minWidth=a)}if(e&&e.maxWidth)if("inherit"==e.maxWidth)n.maxWidth=t.clientWidth;else{var l=parseInt(e.maxWidth);isNaN(l)||(n.maxWidth=l)}r.firstChild||(r.className="autoResize",r.style.display="inline-block",r.appendChild(i))},d=function(e,o,i){t=e,c(o),"TEXTAREA"==t.nodeName&&(t.style.resize="none",t.style.overflowY="",t.style.height=n.minHeight+"px",t.style.minWidth=n.minWidth+"px",t.style.maxWidth=n.maxWidth+"px",t.style.overflowY="hidden"),i&&(s(t,"change",l),s(t,"cut",u),s(t,"paste",u),s(t,"drop",u),s(t,"keydown",u),s(t,"focus",l)),l()};return{init:function(e,t,n){d(e,t,n)},unObserve:function(){a(t,"change",l),a(t,"cut",u),a(t,"paste",u),a(t,"drop",u),a(t,"keydown",u),a(t,"focus",l)},resize:l}}e.exports=o},function(e,t,n){function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":s(t))&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=n(0),l=n(22),u=function(e){return e&&e.__esModule?e:{default:e}}(l),c=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.clone=n.makeClone(u.default.CLONE_DEBUG),n.clone.wtTable.holder.style.opacity=.4,n.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000",(0,a.addClass)(n.clone.wtTable.holder.parentNode,"wtDebugVisible"),n}return r(t,e),t}(u.default);u.default.registerOverlay(u.default.CLONE_DEBUG,c),t.default=c},function(e,t,n){function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":s(t))&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(0),u=n(22),c=function(e){return e&&e.__esModule?e:{default:e}}(u),d=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.clone=n.makeClone(c.default.CLONE_LEFT),n}return r(t,e),a(t,[{key:"shouldBeRendered",value:function(){return!(!this.wot.getSetting("fixedColumnsLeft")&&!this.wot.getSetting("rowHeaders").length)}},{key:"resetFixedPosition",value:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode,t=0,n=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==window||n&&"horizontal"===n)t=this.getScrollPosition(),(0,l.resetCssTransform)(e);else{var o=this.wot.wtTable.hider.getBoundingClientRect(),i=Math.ceil(o.left),r=Math.ceil(o.right),s=void 0,a=void 0;a=this.wot.wtTable.hider.style.top,a=""===a?0:a,s=i<0&&r-e.offsetWidth>0?-i:0,t=s,s+="px",(0,l.setOverlayPosition)(e,s,a)}this.adjustHeaderBordersPosition(t),this.adjustElementsSize()}}},{key:"setScrollPosition",value:function(e){this.mainTableScrollableElement===window?window.scrollTo(e,(0,l.getWindowScrollTop)()):this.mainTableScrollableElement.scrollLeft=e}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollVertically")}},{key:"sumCellSizes",value:function(e,t){for(var n=0,o=this.wot.wtSettings.defaultColumnWidth;e<t;)n+=this.wot.wtTable.getStretchedColumnWidth(e)||o,e++;return n}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),e||(this.areElementSizesAdjusted=!0))}},{key:"adjustRootElementSize",value:function(){var e=this.wot.wtTable.holder,t=e.clientHeight===e.offsetHeight?0:(0,l.getScrollbarWidth)(),n=this.clone.wtTable.holder.parentNode,o=n.style,i=this.wot.getSetting("preventOverflow"),r=void 0;if(this.trimmingContainer!==window||"vertical"===i){var s=this.wot.wtViewport.getWorkspaceHeight()-t;s=Math.min(s,(0,l.innerHeight)(this.wot.wtTable.wtRootElement)),o.height=s+"px"}else o.height="";this.clone.wtTable.holder.style.height=o.height,r=(0,l.outerWidth)(this.clone.wtTable.TABLE),o.width=(0===r?r:r+4)+"px"}},{key:"adjustRootChildrenSize",value:function(){var e=(0,l.getScrollbarWidth)();this.clone.wtTable.hider.style.height=this.hider.style.height,this.clone.wtTable.holder.style.height=this.clone.wtTable.holder.parentNode.style.height,0===e&&(e=30),this.clone.wtTable.holder.style.width=parseInt(this.clone.wtTable.holder.parentNode.style.width,10)+e+"px"}},{key:"applyToDOM",value:function(){var e=this.wot.getSetting("totalColumns");if(this.areElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style.left=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px";else{if(0!==e)throw new Error("Incorrect value of the columnsRenderCalculator");this.spreader.style.left="0"}this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px":this.clone.wtTable.spreader.style.top=""}},{key:"scrollTo",value:function(e,t){var n=this.getTableParentOffset(),o=this.wot.cloneSource?this.wot.cloneSource:this.wot,i=o.wtTable.holder,r=0;t&&i.offsetWidth!==i.clientWidth&&(r=(0,l.getScrollbarWidth)()),t?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportWidth()):n+=this.sumCellSizes(this.wot.getSetting("fixedColumnsLeft"),e),n+=r,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){var e=this.wot.getSetting("preventOverflow"),t=0;return e||this.trimmingContainer!==window||(t=this.wot.wtTable.holderOffset.left),t}},{key:"getScrollPosition",value:function(){return(0,l.getScrollLeft)(this.mainTableScrollableElement)}},{key:"adjustHeaderBordersPosition",value:function(e){var t=this.wot.wtTable.holder.parentNode,n=this.wot.getSetting("rowHeaders"),o=this.wot.getSetting("fixedColumnsLeft");if(this.wot.getSetting("totalRows")?(0,l.removeClass)(t,"emptyRows"):(0,l.addClass)(t,"emptyRows"),o&&!n.length)(0,l.addClass)(t,"innerBorderLeft");else if(!o&&n.length){var i=(0,l.hasClass)(t,"innerBorderLeft");e?(0,l.addClass)(t,"innerBorderLeft"):(0,l.removeClass)(t,"innerBorderLeft"),(!i&&e||i&&!e)&&this.wot.wtOverlays.adjustElementsSize()}}}]),t}(c.default);c.default.registerOverlay(c.default.CLONE_LEFT,d),t.default=d},function(e,t,n){function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":s(t))&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(0),u=n(22),c=function(e){return e&&e.__esModule?e:{default:e}}(u),d=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.clone=n.makeClone(c.default.CLONE_TOP),n}return r(t,e),a(t,[{key:"shouldBeRendered",value:function(){return!(!this.wot.getSetting("fixedRowsTop")&&!this.wot.getSetting("columnHeaders").length)}},{key:"resetFixedPosition",value:function(){if(this.needFullRender&&this.wot.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode,t=0,n=this.wot.getSetting("preventOverflow");if(this.trimmingContainer!==window||n&&"vertical"===n)t=this.getScrollPosition(),(0,l.resetCssTransform)(e);else{var o=this.wot.wtTable.hider.getBoundingClientRect(),i=Math.ceil(o.top),r=Math.ceil(o.bottom),s=void 0,a=void 0;s=this.wot.wtTable.hider.style.left,s=""===s?0:s,a=i<0&&r-e.offsetHeight>0?-i:0,t=a,a+="px",(0,l.setOverlayPosition)(e,s,a)}this.adjustHeaderBordersPosition(t),this.adjustElementsSize()}}},{key:"setScrollPosition",value:function(e){this.mainTableScrollableElement===window?window.scrollTo((0,l.getWindowScrollLeft)(),e):this.mainTableScrollableElement.scrollTop=e}},{key:"onScroll",value:function(){this.wot.getSetting("onScrollHorizontally")}},{key:"sumCellSizes",value:function(e,t){for(var n=0,o=this.wot.wtSettings.settings.defaultRowHeight;e<t;){var i=this.wot.wtTable.getRowHeight(e);n+=void 0===i?o:i,e++}return n}},{key:"adjustElementsSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateTrimmingContainer(),(this.needFullRender||e)&&(this.adjustRootElementSize(),this.adjustRootChildrenSize(),e||(this.areElementSizesAdjusted=!0))}},{key:"adjustRootElementSize",value:function(){var e=this.wot.wtTable.holder,t=e.clientWidth===e.offsetWidth?0:(0,l.getScrollbarWidth)(),n=this.clone.wtTable.holder.parentNode,o=n.style,i=this.wot.getSetting("preventOverflow"),r=void 0;if(this.trimmingContainer!==window||"horizontal"===i){var s=this.wot.wtViewport.getWorkspaceWidth()-t;s=Math.min(s,(0,l.innerWidth)(this.wot.wtTable.wtRootElement)),o.width=s+"px"}else o.width="";this.clone.wtTable.holder.style.width=o.width,r=(0,l.outerHeight)(this.clone.wtTable.TABLE),o.height=(0===r?r:r+4)+"px"}},{key:"adjustRootChildrenSize",value:function(){var e=(0,l.getScrollbarWidth)();this.clone.wtTable.hider.style.width=this.hider.style.width,this.clone.wtTable.holder.style.width=this.clone.wtTable.holder.parentNode.style.width,0===e&&(e=30),this.clone.wtTable.holder.style.height=parseInt(this.clone.wtTable.holder.parentNode.style.height,10)+e+"px"}},{key:"applyToDOM",value:function(){var e=this.wot.getSetting("totalRows");if(this.areElementSizesAdjusted||this.adjustElementsSize(),"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=this.wot.wtViewport.rowsRenderCalculator.startPosition+"px";else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.top="0"}this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}},{key:"syncOverlayOffset",value:function(){"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.left=this.wot.wtViewport.columnsRenderCalculator.startPosition+"px":this.clone.wtTable.spreader.style.left=""}},{key:"scrollTo",value:function(e,t){var n=this.getTableParentOffset(),o=this.wot.cloneSource?this.wot.cloneSource:this.wot,i=o.wtTable.holder,r=0;if(t&&i.offsetHeight!==i.clientHeight&&(r=(0,l.getScrollbarWidth)()),t){var s=this.wot.getSetting("fixedRowsBottom"),a=(this.wot.getSetting("fixedRowsTop"),this.wot.getSetting("totalRows"));n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight()-this.sumCellSizes(a-s,a),n+=1}else n+=this.sumCellSizes(this.wot.getSetting("fixedRowsTop"),e);n+=r,this.setScrollPosition(n)}},{key:"getTableParentOffset",value:function(){return this.mainTableScrollableElement===window?this.wot.wtTable.holderOffset.top:0}},{key:"getScrollPosition",value:function(){return(0,l.getScrollTop)(this.mainTableScrollableElement)}},{key:"redrawSelectionBorders",value:function(e){if(e&&e.cellRange){var t=e.getBorder(this.wot);if(t){var n=e.getCorners();t.disappear(),t.appear(n)}}}},{key:"redrawAllSelectionsBorders",value:function(){var e=this.wot.selections;this.redrawSelectionBorders(e.current),this.redrawSelectionBorders(e.area),this.redrawSelectionBorders(e.fill),this.wot.wtTable.wot.wtOverlays.leftOverlay.refresh()}},{key:"adjustHeaderBordersPosition",value:function(e){var t=this.wot.wtTable.holder.parentNode;if(this.wot.getSetting("totalColumns")?(0,l.removeClass)(t,"emptyColumns"):(0,l.addClass)(t,"emptyColumns"),0===this.wot.getSetting("fixedRowsTop")&&this.wot.getSetting("columnHeaders").length>0){var n=(0,l.hasClass)(t,"innerBorderTop");e||0===this.wot.getSetting("totalRows")?(0,l.addClass)(t,"innerBorderTop"):(0,l.removeClass)(t,"innerBorderTop"),(!n&&e||n&&!e)&&(this.wot.wtOverlays.adjustElementsSize(),this.redrawAllSelectionsBorders())}if(0===this.wot.getSetting("rowHeaders").length){var o=this.clone.wtTable.THEAD.querySelectorAll("th:nth-of-type(2)");if(o)for(var i=0;i<o.length;i++)o[i].style["border-left-width"]=0}}}]),t}(c.default);c.default.registerOverlay(c.default.CLONE_TOP,d),t.default=d},function(e,t,n){function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":s(t))&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(0),u=n(22),c=function(e){return e&&e.__esModule?e:{default:e}}(u),d=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.clone=n.makeClone(c.default.CLONE_TOP_LEFT_CORNER),n}return r(t,e),a(t,[{key:"shouldBeRendered",value:function(){return!(!this.wot.getSetting("fixedRowsTop")&&!this.wot.getSetting("columnHeaders").length||!this.wot.getSetting("fixedColumnsLeft")&&!this.wot.getSetting("rowHeaders").length)}},{key:"resetFixedPosition",value:function(){if(this.updateTrimmingContainer(),this.wot.wtTable.holder.parentNode){var e=this.clone.wtTable.holder.parentNode,t=(0,l.outerHeight)(this.clone.wtTable.TABLE),n=(0,l.outerWidth)(this.clone.wtTable.TABLE),o=this.wot.getSetting("preventOverflow");if(this.trimmingContainer===window){var i=this.wot.wtTable.hider.getBoundingClientRect(),r=Math.ceil(i.top),s=Math.ceil(i.left),a=Math.ceil(i.bottom),u=Math.ceil(i.right),c="0",d="0";o&&"vertical"!==o||s<0&&u-e.offsetWidth>0&&(c=-s+"px"),o&&"horizontal"!==o||r<0&&a-e.offsetHeight>0&&(d=-r+"px"),(0,l.setOverlayPosition)(e,c,d)}else(0,l.resetCssTransform)(e);e.style.height=(0===t?t:t+4)+"px",e.style.width=(0===n?n:n+4)+"px"}}}]),t}(c.default);c.default.registerOverlay(c.default.CLONE_TOP_LEFT_CORNER,d),t.default=d},function(e,t,n){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var r="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return void 0===e?"undefined":s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":s(e)},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(0),u=n(242),c=o(u),d=n(41),h=o(d),f=n(65),p=o(f),g=function(){function e(t,n){i(this,e),this.settings=t,this.cellRange=n||null,this.instanceBorders={}}return a(e,[{key:"getBorder",value:function(e){if(this.instanceBorders[e.guid])return this.instanceBorders[e.guid];this.instanceBorders[e.guid]=new c.default(e,this.settings)}},{key:"isEmpty",value:function(){return null===this.cellRange}},{key:"add",value:function(e){this.isEmpty()?this.cellRange=new p.default(e,e,e):this.cellRange.expand(e)}},{key:"replace",value:function(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}},{key:"clear",value:function(){this.cellRange=null}},{key:"getCorners",value:function(){var e=this.cellRange.getTopLeftCorner(),t=this.cellRange.getBottomRightCorner();return[e.row,e.col,t.row,t.col]}},{key:"addClassAtCoords",value:function(e,t,n,o){var i=e.wtTable.getCell(new h.default(t,n));"object"===(void 0===i?"undefined":r(i))&&(0,l.addClass)(i,o)}},{key:"draw",value:function(e){if(this.isEmpty()){if(this.settings.border){var t=this.getBorder(e);t&&t.disappear()}}else{for(var n=e.wtTable.getRenderedRowsCount(),o=e.wtTable.getRenderedColumnsCount(),i=this.getCorners(),r=void 0,s=void 0,a=void 0,u=0;u<o;u++)if((s=e.wtTable.columnFilter.renderedToSource(u))>=i[1]&&s<=i[3]&&(a=e.wtTable.getColumnHeader(s))){var c=[];this.settings.highlightHeaderClassName&&c.push(this.settings.highlightHeaderClassName),this.settings.highlightColumnClassName&&c.push(this.settings.highlightColumnClassName),(0,l.addClass)(a,c)}for(var d=0;d<n;d++){if((r=e.wtTable.rowFilter.renderedToSource(d))>=i[0]&&r<=i[2]&&(a=e.wtTable.getRowHeader(r))){var h=[];this.settings.highlightHeaderClassName&&h.push(this.settings.highlightHeaderClassName),this.settings.highlightRowClassName&&h.push(this.settings.highlightRowClassName),(0,l.addClass)(a,h)}for(var f=0;f<o;f++)s=e.wtTable.columnFilter.renderedToSource(f),r>=i[0]&&r<=i[2]&&s>=i[1]&&s<=i[3]?this.settings.className&&this.addClassAtCoords(e,r,s,this.settings.className):r>=i[0]&&r<=i[2]?this.settings.highlightRowClassName&&this.addClassAtCoords(e,r,s,this.settings.highlightRowClassName):s>=i[1]&&s<=i[3]&&this.settings.highlightColumnClassName&&this.addClassAtCoords(e,r,s,this.settings.highlightColumnClassName)}if(e.getSetting("onBeforeDrawBorders",i,this.settings.className),this.settings.border){var p=this.getBorder(e);p&&p.appear(i)}}}}]),e}();t.default=g},function(e,t,n){t.__esModule=!0;var o=n(8),i=n(3),r=n(19);t.default={editor:(0,o.getEditor)("autocomplete"),renderer:(0,i.getRenderer)("autocomplete"),validator:(0,r.getValidator)("autocomplete")}},function(e,t,n){t.__esModule=!0;var o=n(8),i=n(3);t.default={editor:(0,o.getEditor)("checkbox"),renderer:(0,i.getRenderer)("checkbox")}},function(e,t,n){t.__esModule=!0;var o=n(8),i=n(3),r=n(19);t.default={editor:(0,o.getEditor)("date"),renderer:(0,i.getRenderer)("autocomplete"),validator:(0,r.getValidator)("date")}},function(e,t,n){t.__esModule=!0;var o=n(8),i=n(3),r=n(19);t.default={editor:(0,o.getEditor)("dropdown"),renderer:(0,i.getRenderer)("autocomplete"),validator:(0,r.getValidator)("autocomplete")}},function(e,t,n){t.__esModule=!0;var o=n(8),i=n(3);t.default={editor:(0,o.getEditor)("handsontable"),renderer:(0,i.getRenderer)("autocomplete")}},function(e,t,n){t.__esModule=!0;var o=n(8),i=n(3),r=n(19);t.default={editor:(0,o.getEditor)("numeric"),renderer:(0,i.getRenderer)("numeric"),validator:(0,r.getValidator)("numeric"),dataType:"number"}},function(e,t,n){t.__esModule=!0;var o=n(8),i=n(3);n(19);t.default={editor:(0,o.getEditor)("password"),renderer:(0,i.getRenderer)("password"),copyable:!1}},function(e,t,n){t.__esModule=!0;var o=n(20),i=n(8),r=n(3);t.default={editor:(0,o.isMobileBrowser)()?(0,i.getEditor)("mobile"):(0,i.getEditor)("text"),renderer:(0,r.getRenderer)("text")}},function(e,t,n){t.__esModule=!0;var o=n(8),i=n(3),r=n(19);t.default={editor:(0,o.getEditor)("text"),renderer:(0,i.getRenderer)("text"),validator:(0,r.getValidator)("time")}},function(e,t,n){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n){var o=this;this.instance=e,this.priv=t,this.GridSettings=n,this.dataSource=this.instance.getSettings().data,this.cachedLength=null,this.skipCache=!1,this.latestSourceRowsCount=0,this.dataSource&&this.dataSource[0]?this.duckSchema=this.recursiveDuckSchema(this.dataSource[0]):this.duckSchema={},this.createMap(),this.interval=p.default.create(function(){return o.clearLengthCache()},"15fps"),this.instance.addHook("skipLengthCache",function(e){return o.onSkipLengthCache(e)}),this.onSkipLengthCache(500)}t.__esModule=!0;var r="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return void 0===e?"undefined":s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":s(e)},a=n(288),l=o(a),u=n(62),c=n(63),d=n(2),h=n(7),f=n(327),p=o(f),g=n(18),m=n(315),v=o(m),w=n(21);o(w);i.prototype.DESTINATION_RENDERER=1,i.prototype.DESTINATION_CLIPBOARD_GENERATOR=2,i.prototype.recursiveDuckSchema=function(e){return(0,d.duckSchema)(e)},i.prototype.recursiveDuckColumns=function(e,t,n){var o,i;if(void 0===t&&(t=0,n=""),"object"===(void 0===e?"undefined":r(e))&&!Array.isArray(e))for(i in e)(0,d.hasOwnProperty)(e,i)&&(null===e[i]?(o=n+i,this.colToPropCache.push(o),this.propToColCache.set(o,t),t++):t=this.recursiveDuckColumns(e[i],t,i+"."));return t},i.prototype.createMap=function(){var e=void 0,t=this.getSchema();if(void 0===t)throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");this.colToPropCache=[],this.propToColCache=new v.default;var n=this.instance.getSettings().columns;if(n){var o=this.instance.getSettings().maxCols,i=Math.min(o,n.length),r=0,s=!1,a=(0,d.deepObjectSize)(t);for("function"==typeof n&&(i=a>0?a:this.instance.countSourceCols(),s=!0),e=0;e<i;e++){var l=s?n(e):n[e];if((0,d.isObject)(l)){if(void 0!==l.data){var u=s?r:e;this.colToPropCache[u]=l.data,this.propToColCache.set(l.data,u)}r++}}}else this.recursiveDuckColumns(t)},i.prototype.colToProp=function(e){return e=this.instance.runHooks("modifyCol",e),!isNaN(e)&&this.colToPropCache&&void 0!==this.colToPropCache[e]?this.colToPropCache[e]:e},i.prototype.propToCol=function(e){var t;return t=void 0===this.propToColCache.get(e)?e:this.propToColCache.get(e),t=this.instance.runHooks("unmodifyCol",t)},i.prototype.getSchema=function(){var e=this.instance.getSettings().dataSchema;return e?"function"==typeof e?e():e:this.duckSchema},i.prototype.createRow=function(e,t,n){var o,i,r=this.instance.countCols(),s=0;t||(t=1),("number"!=typeof e||e>=this.instance.countSourceRows())&&(e=this.instance.countSourceRows()),this.instance.runHooks("beforeCreateRow",e,t,n),i=e;for(var a=this.instance.getSettings().maxRows;s<t&&this.instance.countSourceRows()<a;)"array"===this.instance.dataType?this.instance.getSettings().dataSchema?o=(0,d.deepClone)(this.getSchema()):(o=[],(0,g.rangeEach)(r-1,function(){return o.push(null)})):"function"===this.instance.dataType?o=this.instance.getSettings().dataSchema(e):(o={},(0,d.deepExtend)(o,this.getSchema())),e===this.instance.countSourceRows()?this.dataSource.push(o):this.spliceData(e,0,o),s++,i++;return this.instance.runHooks("afterCreateRow",e,s,n),this.instance.forceFullRender=!0,s},i.prototype.createCol=function(e,t,n){if(!this.instance.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var o,i,r=this.instance.countSourceRows(),s=this.dataSource,a=0;t||(t=1),("number"!=typeof e||e>=this.instance.countCols())&&(e=this.instance.countCols()),this.instance.runHooks("beforeCreateCol",e,t,n),i=e;for(var l=this.instance.getSettings().maxCols;a<t&&this.instance.countCols()<l;){if(o=(0,c.columnFactory)(this.GridSettings,this.priv.columnsSettingConflicts),"number"!=typeof e||e>=this.instance.countCols()){if(r>0)for(var u=0;u<r;u++)void 0===s[u]&&(s[u]=[]),s[u].push(null);else s.push([null]);this.priv.columnSettings.push(o)}else{for(var d=0;d<r;d++)s[d].splice(i,0,null);this.priv.columnSettings.splice(i,0,o)}a++,i++}return this.instance.runHooks("afterCreateCol",e,a,n),this.instance.forceFullRender=!0,a},i.prototype.removeRow=function(e,t,n){t||(t=1),"number"!=typeof e&&(e=-t),t=this.instance.runHooks("modifyRemovedAmount",t,e),e=(this.instance.countSourceRows()+e)%this.instance.countSourceRows();var o=this.visualRowsToPhysical(e,t);if(!1!==this.instance.runHooks("beforeRemoveRow",e,t,o,n)){var i=this.dataSource,r=void 0;r=this.filterData(e,t),r&&(i.length=0,Array.prototype.push.apply(i,r)),this.instance.runHooks("afterRemoveRow",e,t,o,n),this.instance.forceFullRender=!0}},i.prototype.removeCol=function(e,t,n){if("object"===this.instance.dataType||this.instance.getSettings().columns)throw new Error("cannot remove column with object data source or columns option specified");t||(t=1),"number"!=typeof e&&(e=-t),e=(this.instance.countCols()+e)%this.instance.countCols();var o=this.visualColumnsToPhysical(e,t),i=o.slice(0).sort(function(e,t){return t-e});if(!1!==this.instance.runHooks("beforeRemoveCol",e,t,o,n)){for(var r=!0,s=i.length,a=this.dataSource,l=0;l<s;l++)r&&o[0]!==o[l]-l&&(r=!1);if(r)for(var u=0,c=this.instance.countSourceRows();u<c;u++)a[u].splice(o[0],t);else{for(var d=0,h=this.instance.countSourceRows();d<h;d++)for(var f=0;f<s;f++)a[d].splice(i[f],1);for(var p=0;p<s;p++)this.priv.columnSettings.splice(o[p],1)}this.instance.runHooks("afterRemoveCol",e,t,o,n),this.instance.forceFullRender=!0}},i.prototype.spliceCol=function(e,t,n){var o=arguments.length>=4?[].slice.call(arguments,3):[],i=this.instance.getDataAtCol(e),r=i.slice(t,t+n),s=i.slice(t+n);(0,h.extendArray)(o,s);for(var a=0;a<n;)o.push(null),a++;return(0,h.to2dArray)(o),this.instance.populateFromArray(t,e,o,null,null,"spliceCol"),r},i.prototype.spliceRow=function(e,t,n){var o=arguments.length>=4?[].slice.call(arguments,3):[],i=this.instance.getSourceDataAtRow(e),r=i.slice(t,t+n),s=i.slice(t+n);(0,h.extendArray)(o,s);for(var a=0;a<n;)o.push(null),a++;return this.instance.populateFromArray(e,t,[o],null,null,"spliceRow"),r},i.prototype.spliceData=function(e,t,n){!1!==this.instance.runHooks("beforeDataSplice",e,t,n)&&this.dataSource.splice(e,t,n)},i.prototype.filterData=function(e,t){var n=this.visualRowsToPhysical(e,t);if(!1!==this.instance.runHooks("beforeDataFilter",e,t,n))return this.dataSource.filter(function(e,t){return-1==n.indexOf(t)})},i.prototype.get=function(e,t){e=this.instance.runHooks("modifyRow",e);var n=this.dataSource[e],o=this.instance.runHooks("modifyRowData",e);n=isNaN(o)?o:n;var i=null;if(n&&n.hasOwnProperty&&(0,d.hasOwnProperty)(n,t))i=n[t];else if("string"==typeof t&&t.indexOf(".")>-1){var r=t.split("."),s=n;if(!s)return null;for(var a=0,l=r.length;a<l;a++)if(void 0===(s=s[r[a]]))return null;i=s}else"function"==typeof t&&(i=t(this.dataSource.slice(e,e+1)[0]));if(this.instance.hasHook("modifyData")){var u=(0,d.createObjectPropListener)(i);this.instance.runHooks("modifyData",e,this.propToCol(t),u,"get"),u.isTouched()&&(i=u.value)}return i};var y=(0,u.cellMethodLookupFactory)("copyable",!1);i.prototype.getCopyable=function(e,t){return y.call(this.instance,e,this.propToCol(t))?this.get(e,t):""},i.prototype.set=function(e,t,n,o){e=this.instance.runHooks("modifyRow",e,o||"datamapGet");var i=this.dataSource[e],r=this.instance.runHooks("modifyRowData",e);if(i=isNaN(r)?r:i,this.instance.hasHook("modifyData")){var s=(0,d.createObjectPropListener)(n);this.instance.runHooks("modifyData",e,this.propToCol(t),s,"set"),s.isTouched()&&(n=s.value)}if(i&&i.hasOwnProperty&&(0,d.hasOwnProperty)(i,t))i[t]=n;else if("string"==typeof t&&t.indexOf(".")>-1){var a=t.split("."),l=i,u=0,c=void 0;for(u=0,c=a.length-1;u<c;u++)void 0===l[a[u]]&&(l[a[u]]={}),l=l[a[u]];l[a[u]]=n}else"function"==typeof t?t(this.dataSource.slice(e,e+1)[0],n):i[t]=n},i.prototype.visualRowsToPhysical=function(e,t){for(var n,o=this.instance.countSourceRows(),i=(o+e)%o,r=[],s=t;i<o&&s;)n=this.instance.runHooks("modifyRow",i),r.push(n),s--,i++;return r},i.prototype.visualColumnsToPhysical=function(e,t){for(var n=this.instance.countCols(),o=(n+e)%n,i=[],r=t;o<n&&r;){var s=this.instance.runHooks("modifyCol",o);i.push(s),r--,o++}return i},i.prototype.clear=function(){for(var e=0;e<this.instance.countSourceRows();e++)for(var t=0;t<this.instance.countCols();t++)this.set(e,this.colToProp(t),"")},i.prototype.clearLengthCache=function(){this.cachedLength=null},i.prototype.getLength=function(){var e=this,t=void 0,n=this.instance.getSettings().maxRows;t=n<0||0===n?0:n||1/0;var o=this.instance.countSourceRows();if(this.instance.hasHook("modifyRow")){var i=this.skipCache;this.interval.start(),o!==this.latestSourceRowsCount&&(i=!0),this.latestSourceRowsCount=o,null===this.cachedLength||i?((0,g.rangeEach)(o-1,function(t){null===(t=e.instance.runHooks("modifyRow",t))&&--o}),this.cachedLength=o):o=this.cachedLength}else this.interval.stop();return Math.min(o,t)},i.prototype.getAll=function(){var e={row:0,col:0},t={row:Math.max(this.instance.countSourceRows()-1,0),col:Math.max(this.instance.countCols()-1,0)};return e.row-t.row!=0||this.instance.countSourceRows()?this.getRange(e,t,i.prototype.DESTINATION_RENDERER):[]},i.prototype.getRange=function(e,t,n){var o,i,r,s,a,l=[],u=this.instance.getSettings().maxRows,c=this.instance.getSettings().maxCols;if(0===u||0===c)return[];var d=n===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get;for(i=Math.min(Math.max(u-1,0),Math.max(e.row,t.row)),s=Math.min(Math.max(c-1,0),Math.max(e.col,t.col)),o=Math.min(e.row,t.row);o<=i;o++){a=[];var h=this.instance.runHooks("modifyRow",o);for(r=Math.min(e.col,t.col);r<=s&&null!==h;r++)a.push(d.call(this,o,this.colToProp(r)));null!==h&&l.push(a)}return l},i.prototype.getText=function(e,t){return l.default.stringify(this.getRange(e,t,this.DESTINATION_RENDERER))},i.prototype.getCopyableText=function(e,t){return l.default.stringify(this.getRange(e,t,this.DESTINATION_CLIPBOARD_GENERATOR))},i.prototype.onSkipLengthCache=function(e){var t=this;this.skipCache=!0,setTimeout(function(){t.skipCache=!1},e)},i.prototype.destroy=function(){this.interval.stop(),this.interval=null,this.instance=null,this.priv=null,this.GridSettings=null,this.dataSource=null,this.cachedLength=null,this.duckSchema=null},t.default=i},function(e,t,n){function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(2),s=n(7),a=n(18),l=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];o(this,e),this.hot=t,this.data=n,this.dataType="array",this.colToProp=function(){},this.propToCol=function(){}}return i(e,[{key:"getData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.data;return e&&(t=this.getByRange({row:0,col:0},{row:Math.max(this.countRows()-1,0),col:Math.max(this.countColumns()-1,0)},!0)),t}},{key:"setData",value:function(e){this.data=e}},{key:"getAtColumn",value:function(e){var t=this,n=[];return(0,s.arrayEach)(this.data,function(o){var i=t.colToProp(e);o="string"==typeof i?(0,r.getProperty)(o,i):o[i],n.push(o)}),n}},{key:"getAtRow",value:function(e){return this.data[e]}},{key:"getAtCell",value:function(e,t){var n=null,o=this.hot.runHooks("modifyRowData",e),i=isNaN(o)?o:this.data[e];if(i){var s=this.colToProp(t);n="string"==typeof s?(0,r.getProperty)(i,s):"function"==typeof s?s(this.data.slice(e,e+1)[0]):i[s]}return n}},{key:"getByRange",value:function(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=Math.min(e.row,t.row),r=Math.min(e.col,t.col),s=Math.max(e.row,t.row),l=Math.max(e.col,t.col),u=[];return(0,a.rangeEach)(i,s,function(e){var t=n.getAtRow(e),i=void 0;"array"===n.dataType?i=t.slice(r,l+1):"object"===n.dataType&&(i=o?[]:{},(0,a.rangeEach)(r,l,function(e){var r=n.colToProp(e);o?i.push(t[r]):i[r]=t[r]})),u.push(i)}),u}},{key:"countRows",value:function(){return Array.isArray(this.data)?this.data.length:0}},{key:"countColumns",value:function(){var e=0;return Array.isArray(this.data)&&("array"===this.dataType?e=this.data[0].length:"object"===this.dataType&&(e=Object.keys(this.data[0]).length)),e}},{key:"destroy",value:function(){this.data=null,this.hot=null}}]),e}();t.default=l},function(e,t,n){function o(e,t,n){function o(e){n.setSelectedHeaders(!1,!1,!1);var o="function"==typeof t.settings.enterMoves?t.settings.enterMoves(event):t.settings.enterMoves;e?n.transformStart(-o.row,-o.col):n.transformStart(o.row,o.col,!0)}function l(e){e?(n.selectedHeader.cols&&n.setSelectedHeaders(n.selectedHeader.rows,!1,!1),n.transformEnd(-1,0)):(n.setSelectedHeaders(!1,!1,!1),n.transformStart(-1,0))}function d(e){e?n.transformEnd(1,0):(n.setSelectedHeaders(!1,!1,!1),n.transformStart(1,0))}function h(e){e?n.transformEnd(0,1):(n.setSelectedHeaders(!1,!1,!1),n.transformStart(0,1))}function f(e){e?(n.selectedHeader.rows&&n.setSelectedHeaders(!1,n.selectedHeader.cols,!1),n.transformEnd(0,-1)):(n.setSelectedHeaders(!1,!1,!1),n.transformStart(0,-1))}function p(a){var u,p;if(e.isListening()&&(e.runHooks("beforeKeyDown",a),!w&&!(0,s.isImmediatePropagationStopped)(a)&&(t.lastKeyCode=a.keyCode,n.isSelected()))){if(u=(a.ctrlKey||a.metaKey)&&!a.altKey,m&&!m.isWaiting()&&!((0,r.isMetaKey)(a.keyCode)||(0,r.isCtrlKey)(a.keyCode)||u||v.isEditorOpened()))return void v.openEditor("",a);switch(p=a.shiftKey?n.setRangeEnd:n.setRangeStart,a.keyCode){case r.KEY_CODES.A:!v.isEditorOpened()&&u&&(n.selectAll(),a.preventDefault(),(0,s.stopPropagation)(a));break;case r.KEY_CODES.ARROW_UP:v.isEditorOpened()&&!m.isWaiting()&&v.closeEditorAndSaveChanges(u),l(a.shiftKey),a.preventDefault(),(0,s.stopPropagation)(a);break;case r.KEY_CODES.ARROW_DOWN:v.isEditorOpened()&&!m.isWaiting()&&v.closeEditorAndSaveChanges(u),d(a.shiftKey),a.preventDefault(),(0,s.stopPropagation)(a);break;case r.KEY_CODES.ARROW_RIGHT:v.isEditorOpened()&&!m.isWaiting()&&v.closeEditorAndSaveChanges(u),h(a.shiftKey),a.preventDefault(),(0,s.stopPropagation)(a);break;case r.KEY_CODES.ARROW_LEFT:v.isEditorOpened()&&!m.isWaiting()&&v.closeEditorAndSaveChanges(u),f(a.shiftKey),a.preventDefault(),(0,s.stopPropagation)(a);break;case r.KEY_CODES.TAB:n.setSelectedHeaders(!1,!1,!1);var g="function"==typeof t.settings.tabMoves?t.settings.tabMoves(a):t.settings.tabMoves;a.shiftKey?n.transformStart(-g.row,-g.col):n.transformStart(g.row,g.col,!0),a.preventDefault(),(0,s.stopPropagation)(a);break;case r.KEY_CODES.BACKSPACE:case r.KEY_CODES.DELETE:n.empty(a),v.prepareEditor(),a.preventDefault();break;case r.KEY_CODES.F2:v.openEditor(null,a),m&&m.enableFullEditMode(),a.preventDefault();break;case r.KEY_CODES.ENTER:v.isEditorOpened()?(m&&m.state!==c.EditorState.WAITING&&v.closeEditorAndSaveChanges(u),o(a.shiftKey)):e.getSettings().enterBeginsEditing?(v.openEditor(null,a),m&&m.enableFullEditMode()):o(a.shiftKey),a.preventDefault(),(0,s.stopImmediatePropagation)(a);break;case r.KEY_CODES.ESCAPE:v.isEditorOpened()&&v.closeEditorAndRestoreOriginalValue(u),a.preventDefault();break;case r.KEY_CODES.HOME:n.setSelectedHeaders(!1,!1,!1),p(a.ctrlKey||a.metaKey?new i.CellCoords(0,t.selRange.from.col):new i.CellCoords(t.selRange.from.row,0)),a.preventDefault(),(0,s.stopPropagation)(a);break;case r.KEY_CODES.END:n.setSelectedHeaders(!1,!1,!1),p(a.ctrlKey||a.metaKey?new i.CellCoords(e.countRows()-1,t.selRange.from.col):new i.CellCoords(t.selRange.from.row,e.countCols()-1)),a.preventDefault(),(0,s.stopPropagation)(a);break;case r.KEY_CODES.PAGE_UP:n.setSelectedHeaders(!1,!1,!1),n.transformStart(-e.countVisibleRows(),0),a.preventDefault(),(0,s.stopPropagation)(a);break;case r.KEY_CODES.PAGE_DOWN:n.setSelectedHeaders(!1,!1,!1),n.transformStart(e.countVisibleRows(),0),a.preventDefault(),(0,s.stopPropagation)(a)}}}var g,m,v=this,w=!1;g=new u.default(e),this.destroyEditor=function(e){this.closeEditor(e)},this.getActiveEditor=function(){return m},this.prepareEditor=function(){var n,o,i,r,s,l,u;if(m&&m.isWaiting())return void this.closeEditor(!1,!1,function(e){e&&v.prepareEditor()});n=t.selRange.highlight.row,o=t.selRange.highlight.col,i=e.colToProp(o),r=e.getCell(n,o),s=e.getSourceDataAtCell(e.runHooks("modifyRow",n),o),l=e.getCellMeta(n,o),u=e.getCellEditor(l),u?(m=(0,a.getEditorInstance)(u,e),m.prepare(n,o,i,r,s,l)):m=void 0},this.isEditorOpened=function(){return m&&m.isOpened()},this.openEditor=function(e,t){m&&!m.cellProperties.readOnly?m.beginEditing(e,t):m&&m.cellProperties.readOnly&&t&&t.keyCode===r.KEY_CODES.ENTER&&o()},this.closeEditor=function(e,t,n){m?m.finishEditing(e,t,n):n&&n(!1)},this.closeEditorAndSaveChanges=function(e){return this.closeEditor(!1,e)},this.closeEditorAndRestoreOriginalValue=function(e){return this.closeEditor(!0,e)},function(){function t(e,t,n){"TD"==n.nodeName&&(v.openEditor(),m&&m.enableFullEditMode())}e.addHook("afterDocumentKeyDown",p),g.addEventListener(document.documentElement,"keydown",function(t){w||e.runHooks("afterDocumentKeyDown",t)}),e.view.wt.update("onCellDblClick",t),e.addHook("afterDestroy",function(){w=!0})}()}t.__esModule=!0;var i=n(30),r=n(13),s=n(10),a=n(8),l=n(6),u=function(e){return e&&e.__esModule?e:{default:e}}(l),c=n(31);t.default=o},function(e,t,n){function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":s(t))&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=n(31),u=function(e){return e&&e.__esModule?e:{default:e}}(l),c=n(0),d=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),a(t,[{key:"beginEditing",value:function(e,t){if(void 0===t){var n=this.TD.querySelector('input[type="checkbox"]');(0,c.hasClass)(n,"htBadValue")||n.click()}}},{key:"finishEditing",value:function(){}},{key:"init",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"focus",value:function(){}}]),t}(u.default);t.default=d},function(e,t,n){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":s(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=function e(t,n,o){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var r=Object.getPrototypeOf(t);return null===r?void 0:e(r,n,o)}if("value"in i)return i.value;var s=i.get;if(void 0!==s)return s.call(o)},c=n(40),d=o(c),h=n(352),f=o(h);n(353);var p=n(0),g=n(2),m=n(6),v=o(m),w=n(13),y=n(10),C=n(42),b=o(C),S=function(e){function t(e){i(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.defaultDateFormat="DD/MM/YYYY",n.isCellEdited=!1,n.parentDestroyed=!1,n}return a(t,e),l(t,[{key:"init",value:function(){var e=this;if("function"!=typeof d.default)throw new Error("You need to include moment.js to your project.");if("function"!=typeof f.default)throw new Error("You need to include Pikaday to your project.");u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"init",this).call(this),this.instance.addHook("afterDestroy",function(){e.parentDestroyed=!0,e.destroyElements()})}},{key:"createElements",value:function(){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"createElements",this).call(this),this.datePicker=document.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,(0,p.addClass)(this.datePicker,"htDatepickerHolder"),document.body.appendChild(this.datePicker),this.$datePicker=new f.default(this.getDatePickerConfig()),new v.default(this).addEventListener(this.datePicker,"mousedown",function(e){return(0,y.stopPropagation)(e)}),this.hideDatepicker()}},{key:"destroyElements",value:function(){this.$datePicker.destroy()}},{key:"prepare",value:function(e,n,o,i,r,s){this._opened=!1,u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"prepare",this).call(this,e,n,o,i,r,s)}},{key:"open",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"open",this).call(this),this.showDatepicker(e)}},{key:"close",value:function(){var e=this;this._opened=!1,this.instance._registerTimeout(setTimeout(function(){e.instance.selection.refreshBorders()},0)),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"close",this).call(this)}},{key:"finishEditing",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e){var o=this.originalValue;void 0!==o&&this.setValue(o)}this.hideDatepicker(),u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"finishEditing",this).call(this,e,n)}},{key:"showDatepicker",value:function(e){this.$datePicker.config(this.getDatePickerConfig());var t=this.TD.getBoundingClientRect(),n=this.cellProperties.dateFormat||this.defaultDateFormat,o=this.$datePicker.config(),i=void 0,r=this.instance.view.isMouseDown(),s=!!e&&(0,w.isMetaKey)(e.keyCode);this.datePickerStyle.top=window.pageYOffset+t.top+(0,p.outerHeight)(this.TD)+"px",this.datePickerStyle.left=window.pageXOffset+t.left+"px",this.$datePicker._onInputFocus=function(){},o.format=n,this.originalValue?(i=this.originalValue,(0,d.default)(i,n,!0).isValid()&&this.$datePicker.setMoment((0,d.default)(i,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),s||r||this.setValue("")):this.cellProperties.defaultDate?(i=this.cellProperties.defaultDate,o.defaultDate=i,(0,d.default)(i,n,!0).isValid()&&this.$datePicker.setMoment((0,d.default)(i,n),!0),s||r||this.setValue("")):this.$datePicker.gotoToday(),this.datePickerStyle.display="block",this.$datePicker.show()}},{key:"hideDatepicker",value:function(){this.datePickerStyle.display="none",this.$datePicker.hide()}},{key:"getDatePickerConfig",value:function(){var e=this,t=this.TEXTAREA,n={};this.cellProperties&&this.cellProperties.datePickerConfig&&(0,g.deepExtend)(n,this.cellProperties.datePickerConfig);var o=n.onSelect,i=n.onClose;return n.field=t,n.trigger=t,n.container=this.datePicker,n.bound=!1,n.format=n.format||this.defaultDateFormat,n.reposition=n.reposition||!1,n.onSelect=function(t){isNaN(t.getTime())||(t=(0,d.default)(t).format(e.cellProperties.dateFormat||e.defaultDateFormat)),e.setValue(t),e.hideDatepicker(),o&&o()},n.onClose=function(){e.parentDestroyed||e.finishEditing(!1),i&&i()},n}}]),t}(b.default);t.default=S},function(e,t,n){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":s(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=function e(t,n,o){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var r=Object.getPrototypeOf(t);return null===r?void 0:e(r,n,o)}if("value"in i)return i.value;var s=i.get;if(void 0!==s)return s.call(o)},c=n(255),d=o(c),h=n(21),f=o(h),p=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),l(t,[{key:"prepare",value:function(e,n,o,i,r,s){u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"prepare",this).call(this,e,n,o,i,r,s),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}]),t}(d.default);f.default.getSingleton().add("beforeValidate",function(e,t,n,o){var i=this.getCellMeta(t,this.propToCol(n));i.editor===p&&void 0===i.strict&&(i.filter=!1,i.strict=!0)}),t.default=p},function(e,t,n){function o(e){return e&&e.__esModule?e:{default:e}}t.__esModule=!0;var i=n(13),r=n(10),s=n(0),a=n(31),l=o(a),u=n(6),c=o(u),d=l.default.prototype.extend(),h={},f=function(){this.controls={},this.controls.leftButton=document.createElement("DIV"),this.controls.leftButton.className="leftButton",this.controls.rightButton=document.createElement("DIV"),this.controls.rightButton.className="rightButton",this.controls.upButton=document.createElement("DIV"),this.controls.upButton.className="upButton",this.controls.downButton=document.createElement("DIV"),this.controls.downButton.className="downButton";for(var e in this.controls)Object.prototype.hasOwnProperty.call(this.controls,e)&&this.positionControls.appendChild(this.controls[e])};d.prototype.valueChanged=function(){return this.initValue!=this.getValue()},d.prototype.init=function(){var e=this;this.eventManager=new c.default(this.instance),this.createElements(),this.bindEvents(),this.instance.addHook("afterDestroy",function(){e.destroy()})},d.prototype.getValue=function(){return this.TEXTAREA.value},d.prototype.setValue=function(e){this.initValue=e,this.TEXTAREA.value=e},d.prototype.createElements=function(){this.editorContainer=document.createElement("DIV"),this.editorContainer.className="htMobileEditorContainer",this.cellPointer=document.createElement("DIV"),this.cellPointer.className="cellPointer",this.moveHandle=document.createElement("DIV"),this.moveHandle.className="moveHandle",this.inputPane=document.createElement("DIV"),this.inputPane.className="inputs",this.positionControls=document.createElement("DIV"),this.positionControls.className="positionControls",this.TEXTAREA=document.createElement("TEXTAREA"),(0,s.addClass)(this.TEXTAREA,"handsontableInput"),this.inputPane.appendChild(this.TEXTAREA),this.editorContainer.appendChild(this.cellPointer),this.editorContainer.appendChild(this.moveHandle),this.editorContainer.appendChild(this.inputPane),this.editorContainer.appendChild(this.positionControls),f.call(this),document.body.appendChild(this.editorContainer)},d.prototype.onBeforeKeyDown=function(e){var t=this,n=t.getActiveEditor();if(e.target===n.TEXTAREA&&!(0,r.isImmediatePropagationStopped)(e))switch(e.keyCode){case i.KEY_CODES.ENTER:n.close(),e.preventDefault();break;case i.KEY_CODES.BACKSPACE:(0,r.stopImmediatePropagation)(e)}},d.prototype.open=function(){this.instance.addHook("beforeKeyDown",this.onBeforeKeyDown),(0,s.addClass)(this.editorContainer,"active"),(0,s.removeClass)(this.cellPointer,"hidden"),this.updateEditorPosition()},d.prototype.focus=function(){this.TEXTAREA.focus(),(0,s.setCaretPosition)(this.TEXTAREA,this.TEXTAREA.value.length)},d.prototype.close=function(){this.TEXTAREA.blur(),this.instance.removeHook("beforeKeyDown",this.onBeforeKeyDown),(0,s.removeClass)(this.editorContainer,"active")},d.prototype.scrollToView=function(){var e=this.instance.getSelectedRange().highlight;this.instance.view.scrollViewport(e)},d.prototype.hideCellPointer=function(){(0,s.hasClass)(this.cellPointer,"hidden")||(0,s.addClass)(this.cellPointer,"hidden")},d.prototype.updateEditorPosition=function(e,t){if(e&&t)e=parseInt(e,10),t=parseInt(t,10),this.editorContainer.style.top=t+"px",this.editorContainer.style.left=e+"px";else{var n=this.instance.getSelected(),o=this.instance.getCell(n[0],n[1]);if(h.cellPointer||(h.cellPointer={height:(0,s.outerHeight)(this.cellPointer),width:(0,s.outerWidth)(this.cellPointer)}),h.editorContainer||(h.editorContainer={width:(0,s.outerWidth)(this.editorContainer)}),void 0!==o){var i=this.instance.view.wt.wtOverlays.leftOverlay.trimmingContainer==window?0:(0,s.getScrollLeft)(this.instance.view.wt.wtOverlays.leftOverlay.holder),r=this.instance.view.wt.wtOverlays.topOverlay.trimmingContainer==window?0:(0,s.getScrollTop)(this.instance.view.wt.wtOverlays.topOverlay.holder),a=(0,s.offset)(o),l=(0,s.outerWidth)(o),u={x:i,y:r};this.editorContainer.style.top=parseInt(a.top+(0,s.outerHeight)(o)-u.y+h.cellPointer.height,10)+"px",this.editorContainer.style.left=parseInt(window.innerWidth/2-h.editorContainer.width/2,10)+"px",a.left+l/2>parseInt(this.editorContainer.style.left,10)+h.editorContainer.width?this.editorContainer.style.left=window.innerWidth-h.editorContainer.width+"px":a.left+l/2<parseInt(this.editorContainer.style.left,10)+20&&(this.editorContainer.style.left="0px"),this.cellPointer.style.left=parseInt(a.left-h.cellPointer.width/2-(0,s.offset)(this.editorContainer).left+l/2-u.x,10)+"px"}}},d.prototype.updateEditorData=function(){var e=this.instance.getSelected(),t=this.instance.getDataAtCell(e[0],e[1]);this.row=e[0],this.col=e[1],this.setValue(t),this.updateEditorPosition()},d.prototype.prepareAndSave=function(){var e;this.valueChanged()&&(e=this.instance.getSettings().trimWhitespace?[[String.prototype.trim.call(this.getValue())]]:[[this.getValue()]],this.saveValue(e))},d.prototype.bindEvents=function(){var e=this;this.eventManager.addEventListener(this.controls.leftButton,"touchend",function(t){e.prepareAndSave(),e.instance.selection.transformStart(0,-1,null,!0),e.updateEditorData(),t.preventDefault()}),this.eventManager.addEventListener(this.controls.rightButton,"touchend",function(t){e.prepareAndSave(),e.instance.selection.transformStart(0,1,null,!0),e.updateEditorData(),t.preventDefault()}),this.eventManager.addEventListener(this.controls.upButton,"touchend",function(t){e.prepareAndSave(),e.instance.selection.transformStart(-1,0,null,!0),e.updateEditorData(),t.preventDefault()}),this.eventManager.addEventListener(this.controls.downButton,"touchend",function(t){e.prepareAndSave(),e.instance.selection.transformStart(1,0,null,!0),e.updateEditorData(),t.preventDefault()}),this.eventManager.addEventListener(this.moveHandle,"touchstart",function(t){if(1==t.touches.length){var n=t.touches[0],o={x:e.editorContainer.offsetLeft,y:e.editorContainer.offsetTop},i={x:n.pageX-o.x,y:n.pageY-o.y};e.eventManager.addEventListener(this,"touchmove",function(t){var n=t.touches[0];e.updateEditorPosition(n.pageX-i.x,n.pageY-i.y),e.hideCellPointer(),t.preventDefault()})}}),this.eventManager.addEventListener(document.body,"touchend",function(t){(0,s.isChildOf)(t.target,e.editorContainer)||(0,s.isChildOf)(t.target,e.instance.rootElement)||e.close()}),this.eventManager.addEventListener(this.instance.view.wt.wtOverlays.leftOverlay.holder,"scroll",function(t){e.instance.view.wt.wtOverlays.leftOverlay.trimmingContainer!=window&&e.hideCellPointer()}),this.eventManager.addEventListener(this.instance.view.wt.wtOverlays.topOverlay.holder,"scroll",function(t){e.instance.view.wt.wtOverlays.topOverlay.trimmingContainer!=window&&e.hideCellPointer()})},d.prototype.destroy=function(){this.eventManager.clear(),this.editorContainer.parentNode.removeChild(this.editorContainer)},t.default=d},function(e,t,n){function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":s(t))&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=function e(t,n,o){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var r=Object.getPrototypeOf(t);return null===r?void 0:e(r,n,o)}if("value"in i)return i.value;var s=i.get;if(void 0!==s)return s.call(o)},c=n(49),d=o(c),h=n(42),f=o(h),p=function(e){function t(){return i(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),l(t,[{key:"beginEditing",value:function(e){if(void 0===e&&this.originalValue){void 0!==this.cellProperties.language&&d.default.culture(this.cellProperties.language);var n=d.default.cultureData().delimiters.decimal;e=(""+this.originalValue).replace(".",n)}u(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"beginEditing",this).call(this,e)}}]),t}(f.default);t.default=p},function(e,t,n){function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":s(t))&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=function e(t,n,o){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var r=Object.getPrototypeOf(t);return null===r?void 0:e(r,n,o)}if("value"in i)return i.value;var s=i.get;if(void 0!==s)return s.call(o)},u=n(0),c=n(42),d=function(e){return e&&e.__esModule?e:{default:e}}(c),h=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),a(t,[{key:"createElements",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"createElements",this).call(this),this.TEXTAREA=document.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,(0,u.empty)(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}]),t}(d.default);t.default=h},function(e,t,n){t.__esModule=!0;var o="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return void 0===e?"undefined":s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":s(e)},i=n(0),r=n(10),a=n(13),l=n(31),u=function(e){return e&&e.__esModule?e:{default:e}}(l),c=u.default.prototype.extend();c.prototype.init=function(){this.select=document.createElement("SELECT"),(0,i.addClass)(this.select,"htSelectEditor"),this.select.style.display="none",this.instance.rootElement.appendChild(this.select),this.registerHooks()},c.prototype.registerHooks=function(){var e=this;this.instance.addHook("afterScrollHorizontally",function(){return e.refreshDimensions()}),this.instance.addHook("afterScrollVertically",function(){return e.refreshDimensions()}),this.instance.addHook("afterColumnResize",function(){return e.refreshDimensions()}),this.instance.addHook("afterRowResize",function(){return e.refreshDimensions()})},c.prototype.prepare=function(){u.default.prototype.prepare.apply(this,arguments);var e,t=this.cellProperties.selectOptions;e="function"==typeof t?this.prepareOptions(t(this.row,this.col,this.prop)):this.prepareOptions(t),(0,i.empty)(this.select);for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n)){var o=document.createElement("OPTION");o.value=n,(0,i.fastInnerHTML)(o,e[n]),this.select.appendChild(o)}},c.prototype.prepareOptions=function(e){var t={};if(Array.isArray(e))for(var n=0,i=e.length;n<i;n++)t[e[n]]=e[n];else"object"==(void 0===e?"undefined":o(e))&&(t=e);return t},c.prototype.getValue=function(){return this.select.value},c.prototype.setValue=function(e){this.select.value=e};var d=function(e){var t=this,n=t.getActiveEditor();switch(e.keyCode){case a.KEY_CODES.ARROW_UP:var o=n.select.selectedIndex-1;o>=0&&(n.select[o].selected=!0),(0,r.stopImmediatePropagation)(e),e.preventDefault();break;case a.KEY_CODES.ARROW_DOWN:var i=n.select.selectedIndex+1;i<=n.select.length-1&&(n.select[i].selected=!0),(0,r.stopImmediatePropagation)(e),e.preventDefault()}};c.prototype.open=function(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.instance.addHook("beforeKeyDown",d)},c.prototype.close=function(){this._opened=!1,this.select.style.display="none",this.instance.removeHook("beforeKeyDown",d)},c.prototype.focus=function(){this.select.focus()},c.prototype.refreshValue=function(){var e=this.instance.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()},c.prototype.refreshDimensions=function(){if(this.state===l.EditorState.EDITING){if(this.TD=this.getEditedCell(),!this.TD)return void this.close();var e,t=(0,i.outerWidth)(this.TD)+1,n=(0,i.outerHeight)(this.TD)+1,o=(0,i.offset)(this.TD),r=(0,i.offset)(this.instance.rootElement),s=(0,i.getScrollableElement)(this.TD),a=o.top-r.top-1-(s.scrollTop||0),u=o.left-r.left-1-(s.scrollLeft||0),c=this.checkEditorSection(),d=this.instance.getSettings();d.rowHeaders,d.colHeaders;switch(c){case"top":e=(0,i.getCssTransform)(this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.holder.parentNode);break;case"left":e=(0,i.getCssTransform)(this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.holder.parentNode);break;case"top-left-corner":e=(0,i.getCssTransform)(this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom-left-corner":e=(0,i.getCssTransform)(this.instance.view.wt.wtOverlays.bottomLeftCornerOverlay.clone.wtTable.holder.parentNode);break;case"bottom":e=(0,i.getCssTransform)(this.instance.view.wt.wtOverlays.bottomOverlay.clone.wtTable.holder.parentNode)}0===this.instance.getSelected()[0]&&(a+=1),0===this.instance.getSelected()[1]&&(u+=1);var h=this.select.style;e&&-1!=e?h[e[0]]=e[1]:(0,i.resetCssTransform)(this.select);var f=(0,i.getComputedStyle)(this.TD);parseInt(f.borderTopWidth,10)>0&&(n-=1),parseInt(f.borderLeftWidth,10)>0&&(t-=1),h.height=n+"px",h.minWidth=t+"px",h.top=a+"px",h.left=u+"px",h.margin="0px"}},c.prototype.getEditedCell=function(){var e,t=this.checkEditorSection();switch(t){case"top":e=this.instance.view.wt.wtOverlays.topOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.select.style.zIndex=101;break;case"corner":e=this.instance.view.wt.wtOverlays.topLeftCornerOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.select.style.zIndex=103;break;case"left":e=this.instance.view.wt.wtOverlays.leftOverlay.clone.wtTable.getCell({row:this.row,col:this.col}),this.select.style.zIndex=102;break;default:e=this.instance.getCell(this.row,this.col),this.select.style.zIndex=""}return-1!=e&&-2!=e?e:void 0},t.default=c},function(e,t,n){function o(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t){var n=new d.default(e,t||{});return n.init(),n}n(91),n(108),n(117),n(118),n(102),n(116),n(99),n(100),n(101),n(90),n(113),n(111),n(109),n(114),n(115),n(110),n(112),n(103),n(104),n(105),n(107),n(106),n(88),n(89),n(84),n(87),n(86),n(85),n(64),n(93),n(94),n(96),n(95),n(92),n(98),n(97),n(119),n(122),n(120),n(121),n(124),n(123),n(126),n(125),n(284),n(285),n(286);var s=n(8),a=n(3),l=n(19),u=n(61),c=n(81),d=i(c),h=n(281),f=i(h),p=n(6),g=i(p),m=n(21),v=i(m),w=n(283),y=i(w),C=n(7),b=o(C),S=n(20),T=o(S),E=n(62),R=o(E),O=n(83),_=o(O),k=n(37),M=o(k),D=n(38),H=o(D),x=n(28),A=o(x),P=n(18),N=o(P),L=n(2),W=o(L),j=n(63),F=o(j),I=n(29),V=o(I),B=n(13),Y=o(B),z=n(0),U=o(z),G=n(10),K=o(G),X=n(282),q=o(X),$=n(39),Z=n(82),Q=i(Z);(0,f.default)(r),r.Core=d.default,r.DefaultSettings=Q.default,r.EventManager=g.default,r._getListenersCounter=p.getListenersCounter,r.buildDate="2017-07-29T07:30:59.864Z",r.packageName="handsontable",r.version="0.33.0";r.hooks=v.default.getSingleton(),r.__GhostTable=y.default;var J=[b,T,R,_,M,H,A,N,W,F,V,Y],ee=[U,K];r.helper={},r.dom={},b.arrayEach(J,function(e){b.arrayEach(Object.getOwnPropertyNames(e),function(t){"_"!==t.charAt(0)&&(r.helper[t]=e[t])})}),b.arrayEach(ee,function(e){b.arrayEach(Object.getOwnPropertyNames(e),function(t){"_"!==t.charAt(0)&&(r.dom[t]=e[t])})}),r.cellTypes={},b.arrayEach((0,u.getRegisteredCellTypeNames)(),function(e){r.cellTypes[e]=(0,u.getCellType)(e)}),r.cellTypes.registerCellType=u.registerCellType,r.cellTypes.getCellType=u.getCellType,r.editors={},b.arrayEach((0,s.getRegisteredEditorNames)(),function(e){r.editors[V.toUpperCaseFirst(e)+"Editor"]=(0,s.getEditor)(e)}),r.editors.registerEditor=s.registerEditor,r.editors.getEditor=s.getEditor,r.renderers={},b.arrayEach((0,a.getRegisteredRendererNames)(),function(e){var t=(0,a.getRenderer)(e);"base"===e&&(r.renderers.cellDecorator=t),r.renderers[V.toUpperCaseFirst(e)+"Renderer"]=t}),r.renderers.registerRenderer=a.registerRenderer,r.renderers.getRenderer=a.getRenderer,r.validators={},b.arrayEach((0,l.getRegisteredValidatorNames)(),function(e){r.validators[V.toUpperCaseFirst(e)+"Validator"]=(0,l.getValidator)(e)}),r.validators.registerValidator=l.registerValidator,r.validators.getValidator=l.getValidator,r.plugins={},b.arrayEach(Object.getOwnPropertyNames(q),function(e){var t=q[e];"Base"===e?r.plugins[e+"Plugin"]=t:r.plugins[e]=t}),r.plugins.registerPlugin=$.registerPlugin,e.exports=r},function(e,t,n){function o(){function e(e){return null!==e&&!n(e)&&("string"==typeof e||"number"==typeof e)}function t(e){return null!==e&&("object"==(void 0===e?"undefined":i(e))||"function"==typeof e)}function n(e){return e!==e}var o={arrayMap:[],weakMap:new WeakMap};return{get:function(n){return e(n)?o.arrayMap[n]:t(n)?o.weakMap.get(n):void 0},set:function(n,i){if(e(n))o.arrayMap[n]=i;else{if(!t(n))throw new Error("Invalid key type");o.weakMap.set(n,i)}},delete:function(n){e(n)?delete o.arrayMap[n]:t(n)&&o.weakMap.delete(n)}}}t.__esModule=!0;var i="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return void 0===e?"undefined":s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":s(e)};t.default=o},function(e,t,n){function o(e){return e&&e.__esModule?e:{default:e}}function i(){this.boundaries=null,this.callback=null}t.__esModule=!0;var r=n(21),s=o(r),a=n(6),l=o(a);n(39);i.prototype.setBoundaries=function(e){this.boundaries=e},i.prototype.setCallback=function(e){this.callback=e},i.prototype.check=function(e,t){var n=0,o=0;t<this.boundaries.top?o=t-this.boundaries.top:t>this.boundaries.bottom&&(o=t-this.boundaries.bottom),e<this.boundaries.left?n=e-this.boundaries.left:e>this.boundaries.right&&(n=e-this.boundaries.right),this.callback(n,o)};var u,c=function(e){e.dragToScrollListening=!1;var t=e.view.wt.wtTable.holder;u=new i,t!==window&&(u.setBoundaries(t.getBoundingClientRect()),u.setCallback(function(e,n){e<0?t.scrollLeft-=50:e>0&&(t.scrollLeft+=50),n<0?t.scrollTop-=20:n>0&&(t.scrollTop+=20)}),e.dragToScrollListening=!0)};s.default.getSingleton().add("afterInit",function(){var e=this,t=new l.default(this);t.addEventListener(document,"mouseup",function(){e.dragToScrollListening=!1}),t.addEventListener(document,"mousemove",function(t){e.dragToScrollListening&&u.check(t.clientX,t.clientY)})}),s.default.getSingleton().add("afterDestroy",function(){new l.default(this).clear()}),s.default.getSingleton().add("afterOnCellMouseDown",function(){c(this)}),s.default.getSingleton().add("afterOnCellCornerMouseDown",function(){c(this)}),t.default=i},function(e,t,n){function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":s(t))&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}t.__esModule=!0;var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),l=function e(t,n,o){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var r=Object.getPrototypeOf(t);return null===r?void 0:e(r,n,o)}if("value"in i)return i.value;var s=i.get;if(void 0!==s)return s.call(o)},u=n(0),c=n(7),d=n(257),h=function(e){return e&&e.__esModule?e:{default:e}}(d),f=n(39),p=n(37),g=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.scrollbars=[],n.clones=[],n.lockedCollection=!1,n.freezeOverlays=!1,n}return r(t,e),a(t,[{key:"isEnabled",value:function(){return(0,p.isTouchSupported)()}},{key:"enablePlugin",value:function(){var e=this;this.enabled||(this.addHook("afterRender",function(){return e.onAfterRender()}),this.registerEvents(),l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"enablePlugin",this).call(this))}},{key:"updatePlugin",value:function(){this.lockedCollection=!1,l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updatePlugin",this).call(this)}},{key:"disablePlugin",value:function(){l(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disablePlugin",this).call(this)}},{key:"registerEvents",value:function(){var e=this;this.addHook("beforeTouchScroll",function(){return e.onBeforeTouchScroll()}),this.addHook("afterMomentumScroll",function(){return e.onAfterMomentumScroll()})}},{key:"onAfterRender",value:function(){if(!this.lockedCollection){var e=this.hot.view.wt.wtOverlays,t=e.topOverlay,n=e.bottomOverlay,o=e.leftOverlay,i=e.topLeftCornerOverlay,r=e.bottomLeftCornerOverlay;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),n.clone&&this.scrollbars.push(n),this.scrollbars.push(o),i&&this.scrollbars.push(i),r&&r.clone&&this.scrollbars.push(r),this.clones.length=0,t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),o.needFullRender&&this.clones.push(o.clone.wtTable.holder.parentNode),i&&this.clones.push(i.clone.wtTable.holder.parentNode),r&&r.clone&&this.clones.push(r.clone.wtTable.holder.parentNode)}}},{key:"onBeforeTouchScroll",value:function(){this.freezeOverlays=!0,(0,c.arrayEach)(this.clones,function(e){(0,u.addClass)(e,"hide-tween")})}},{key:"onAfterMomentumScroll",value:function(){var e=this;this.freezeOverlays=!1,(0,c.arrayEach)(this.clones,function(e){(0,u.removeClass)(e,"hide-tween"),(0,u.addClass)(e,"show-tween")}),setTimeout(function(){(0,c.arrayEach)(e.clones,function(e){(0,u.removeClass)(e,"show-tween")})},400),(0,c.arrayEach)(this.scrollbars,function(e){e.refresh(),e.resetFixedPosition()}),this.hot.view.wt.wtOverlays.syncScrollWithMaster()}}]),t}(h.default);(0,f.registerPlugin)("touchScroll",g),t.default=g},function(e,t,n){function o(e){var t=this;this.instance=e,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,e.addHook("afterChange",function(e,n){e&&"UndoRedo.undo"!==n&&"UndoRedo.redo"!==n&&t.done(new o.ChangeAction(e))}),e.addHook("afterCreateRow",function(e,n,i){if("UndoRedo.undo"!==i&&"UndoRedo.undo"!==i&&"auto"!==i){var r=new o.CreateRowAction(e,n);t.done(r)}}),e.addHook("beforeRemoveRow",function(e,n,i,r){if("UndoRedo.undo"!==r&&"UndoRedo.redo"!==r&&"auto"!==r){var s=t.instance.getSourceDataArray();e=(s.length+e)%s.length;var a=(0,f.deepClone)(s.slice(e,e+n));t.done(new o.RemoveRowAction(e,a))}}),e.addHook("afterCreateCol",function(e,n,i){"UndoRedo.undo"!==i&&"UndoRedo.redo"!==i&&"auto"!==i&&t.done(new o.CreateColumnAction(e,n))}),e.addHook("beforeRemoveCol",function(n,i,r,s){if("UndoRedo.undo"!==s&&"UndoRedo.redo"!==s&&"auto"!==s){var a=t.instance.getSourceDataArray();n=(t.instance.countCols()+n)%t.instance.countCols();var l=[],u=[],c=[];(0,h.rangeEach)(a.length-1,function(t){var o=[],r=a[t];(0,h.rangeEach)(n,n+(i-1),function(t){o.push(r[e.runHooks("modifyCol",t)])}),l.push(o)}),(0,h.rangeEach)(i-1,function(t){c.push(e.runHooks("modifyCol",n+t))}),Array.isArray(e.getSettings().colHeaders)&&(0,h.rangeEach)(i-1,function(t){u.push(e.getSettings().colHeaders[e.runHooks("modifyCol",n+t)]||null)});var d=t.instance.getPlugin("manualColumnMove"),f=d.isEnabled()?d.columnsMapper.__arrayMap:[],p=new o.RemoveColumnAction(n,c,l,u,f);t.done(p)}}),e.addHook("beforeCellAlignment",function(e,n,i,r){var s=new o.CellAlignmentAction(e,n,i,r);t.done(s)}),e.addHook("beforeFilter",function(e){t.done(new o.FiltersAction(e))}),e.addHook("beforeRowMove",function(e,n){!1!==e&&t.done(new o.RowMoveAction(e,n))})}function i(){var e=this;void 0===e.getSettings().undo||e.getSettings().undo?e.undoRedo||(e.undoRedo=new o(e),a(e),e.addHook("beforeKeyDown",r),e.addHook("afterChange",s)):e.undoRedo&&(delete e.undoRedo,l(e),e.removeHook("beforeKeyDown",r),e.removeHook("afterChange",s))}function r(e){var t=this;(e.ctrlKey||e.metaKey)&&!e.altKey&&(89===e.keyCode||e.shiftKey&&90===e.keyCode?(t.undoRedo.redo(),(0,p.stopImmediatePropagation)(e)):90===e.keyCode&&(t.undoRedo.undo(),(0,p.stopImmediatePropagation)(e)))}function s(e,t){var n=this;if("loadData"===t)return n.undoRedo.clear()}function a(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function l(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}var u=n(21),c=function(e){return e&&e.__esModule?e:{default:e}}(u),d=n(7),h=n(18),f=n(2),p=n(10),g=n(30);o.prototype.done=function(e){this.ignoreNewActions||(this.doneActions.push(e),this.undoneActions.length=0)},o.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.pop(),t=(0,f.deepClone)(e),n=this.instance;if(!1===n.runHooks("beforeUndo",t))return;this.ignoreNewActions=!0;var o=this;e.undo(this.instance,function(){o.ignoreNewActions=!1,o.undoneActions.push(e)}),n.runHooks("afterUndo",t)}},o.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.pop(),t=(0,f.deepClone)(e),n=this.instance;if(!1===n.runHooks("beforeRedo",t))return;this.ignoreNewActions=!0;var o=this;e.redo(this.instance,function(){o.ignoreNewActions=!1,o.doneActions.push(e)}),n.runHooks("afterRedo",t)}},o.prototype.isUndoAvailable=function(){return this.doneActions.length>0},o.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},o.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},o.Action=function(){},o.Action.prototype.undo=function(){},o.Action.prototype.redo=function(){},o.ChangeAction=function(e){this.changes=e,this.actionType="change"},(0,f.inherit)(o.ChangeAction,o.Action),o.ChangeAction.prototype.undo=function(e,t){for(var n=(0,f.deepClone)(this.changes),o=e.countEmptyRows(!0),i=e.countEmptyCols(!0),r=0,s=n.length;r<s;r++)n[r].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtRowProp(n,null,null,"UndoRedo.undo");for(var a=0,l=n.length;a<l;a++)e.getSettings().minSpareRows&&n[a][0]+1+e.getSettings().minSpareRows===e.countRows()&&o==e.getSettings().minSpareRows&&(e.alter("remove_row",parseInt(n[a][0]+1,10),e.getSettings().minSpareRows),e.undoRedo.doneActions.pop()),e.getSettings().minSpareCols&&n[a][1]+1+e.getSettings().minSpareCols===e.countCols()&&i==e.getSettings().minSpareCols&&(e.alter("remove_col",parseInt(n[a][1]+1,10),e.getSettings().minSpareCols),e.undoRedo.doneActions.pop())},o.ChangeAction.prototype.redo=function(e,t){for(var n=(0,f.deepClone)(this.changes),o=0,i=n.length;o<i;o++)n[o].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtRowProp(n,null,null,"UndoRedo.redo")},o.CreateRowAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_row"},(0,f.inherit)(o.CreateRowAction,o.Action),o.CreateRowAction.prototype.undo=function(e,t){var n=e.countRows(),o=e.getSettings().minSpareRows;this.index>=n&&this.index-o<n&&(this.index-=o),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")},o.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row",this.index,this.amount,"UndoRedo.redo")},o.RemoveRowAction=function(e,t){this.index=e,this.data=t,this.actionType="remove_row"},(0,f.inherit)(o.RemoveRowAction,o.Action),o.RemoveRowAction.prototype.undo=function(e,t){e.alter("insert_row",this.index,this.data.length,"UndoRedo.undo"),e.addHookOnce("afterRender",t),e.populateFromArray(this.index,0,this.data,void 0,void 0,"UndoRedo.undo")},o.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")},o.CreateColumnAction=function(e,t){this.index=e,this.amount=t,this.actionType="insert_col"},(0,f.inherit)(o.CreateColumnAction,o.Action),o.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")},o.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col",this.index,this.amount,"UndoRedo.redo")},o.RemoveColumnAction=function(e,t,n,o,i){this.index=e,this.indexes=t,this.data=n,this.amount=this.data[0].length,this.headers=o,this.columnPositions=i.slice(0),this.actionType="remove_col"},(0,f.inherit)(o.RemoveColumnAction,o.Action),o.RemoveColumnAction.prototype.undo=function(e,t){var n=this,o=void 0,i=this.indexes.slice(0).sort(),r=function(e,t,o){return o[n.indexes.indexOf(i[t])]},s=[];(0,h.rangeEach)(this.data.length-1,function(e){s[e]=(0,d.arrayMap)(n.data[e],r)});var a=[];a=(0,d.arrayMap)(this.headers,r);var l=[];e.runHooks("beforeCreateCol",this.indexes[0],this.indexes[this.indexes.length-1],"UndoRedo.undo"),(0,h.rangeEach)(this.data.length-1,function(t){o=e.getSourceDataAtRow(t),(0,h.rangeEach)(i.length-1,function(e){o.splice(i[e],0,s[t][e]),l.push([t,i[e],null,s[t][e]])})}),e.getPlugin("formulas")&&e.getPlugin("formulas").onAfterSetDataAtCell(l),void 0!==this.headers&&(0,h.rangeEach)(a.length-1,function(t){e.getSettings().colHeaders.splice(i[t],0,a[t])}),e.getPlugin("manualColumnMove")&&(e.getPlugin("manualColumnMove").columnsMapper.__arrayMap=this.columnPositions),e.addHookOnce("afterRender",t),e.runHooks("afterCreateCol",this.indexes[0],this.indexes[this.indexes.length-1],"UndoRedo.undo"),e.getPlugin("formulas")&&e.getPlugin("formulas").recalculateFull(),e.render()},o.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")},o.CellAlignmentAction=function(e,t,n,o){this.stateBefore=e,this.range=t,this.type=n,this.alignment=o},o.CellAlignmentAction.prototype.undo=function(e,t){if(e.getPlugin("contextMenu").isEnabled()){for(var n=this.range.from.row;n<=this.range.to.row;n++)for(var o=this.range.from.col;o<=this.range.to.col;o++)e.setCellMeta(n,o,"className",this.stateBefore[n][o]||" htLeft");e.addHookOnce("afterRender",t),e.render()}},o.CellAlignmentAction.prototype.redo=function(e,t){e.getPlugin("contextMenu").isEnabled()&&(e.selectCell(this.range.from.row,this.range.from.col,this.range.to.row,this.range.to.col),e.getPlugin("contextMenu").executeCommand("alignment:"+this.alignment.replace("ht","").toLowerCase()),e.addHookOnce("afterRender",t),e.render())},o.FiltersAction=function(e){this.conditionsStack=e,this.actionType="filter"},(0,f.inherit)(o.FiltersAction,o.Action),o.FiltersAction.prototype.undo=function(e,t){var n=e.getPlugin("filters");e.addHookOnce("afterRender",t),n.conditionCollection.importAllConditions(this.conditionsStack.slice(0,this.conditionsStack.length-1)),n.filter()},o.FiltersAction.prototype.redo=function(e,t){var n=e.getPlugin("filters");e.addHookOnce("afterRender",t),n.conditionCollection.importAllConditions(this.conditionsStack),n.filter()},o.RowMoveAction=function(e,t){this.rows=e.slice(),this.target=t},(0,f.inherit)(o.RowMoveAction,o.Action),o.RowMoveAction.prototype.undo=function(e,t){var n=e.getPlugin("manualRowMove");e.addHookOnce("afterRender",t);for(var o=this.rows[0]<this.target?-1*this.rows.length:0,i=this.rows[0]>this.target?this.rows[0]+this.rows.length:this.rows[0],r=[],s=this.rows.length+o,a=o;a<s;a++)r.push(this.target+a);n.moveRows(r.slice(),i),e.render(),e.selection.setRangeStartOnly(new g.CellCoords(this.rows[0],0)),e.selection.setRangeEnd(new g.CellCoords(this.rows[this.rows.length-1],e.countCols()-1))},o.RowMoveAction.prototype.redo=function(e,t){var n=e.getPlugin("manualRowMove");e.addHookOnce("afterRender",t),n.moveRows(this.rows.slice(),this.target),e.render();var o=this.rows[0]<this.target?this.target-this.rows.length:this.target;e.selection.setRangeStartOnly(new g.CellCoords(o,0)),e.selection.setRangeEnd(new g.CellCoords(o+this.rows.length-1,e.countCols()-1))};var m=c.default.getSingleton();m.add("afterInit",i),m.add("afterUpdateSettings",i),m.register("beforeUndo"),m.register("afterUndo"),m.register("beforeRedo"),m.register("afterRedo")},function(e,t,n){function o(e,t,n,o,r,s,a){a.className&&(t.className?t.className=t.className+" "+a.className:t.className=a.className),a.readOnly&&(0,i.addClass)(t,a.readOnlyCellClassName),!1===a.valid&&a.invalidCellClassName?(0,i.addClass)(t,a.invalidCellClassName):(0,i.removeClass)(t,a.invalidCellClassName),!1===a.wordWrap&&a.noWordWrapClassName&&(0,i.addClass)(t,a.noWordWrapClassName),!s&&a.placeholder&&(0,i.addClass)(t,a.placeholderCellClassName)}t.__esModule=!0;var i=n(0);t.default=o},function(e,t,n){function o(e,t,n,o,r,d,h){var f=(u.cloneNode(!0),c.cloneNode(!0));if(h.allowHtml?(0,l.getRenderer)("html").apply(this,arguments):(0,l.getRenderer)("text").apply(this,arguments),t.appendChild(f),(0,i.addClass)(t,"htAutocomplete"),t.firstChild||t.appendChild(document.createTextNode(String.fromCharCode(160))),!e.acArrowListener){var p=new s.default(e);e.acArrowListener=function(r){(0,i.hasClass)(r.target,"htAutocompleteArrow")&&e.view.wt.getSetting("onCellDblClick",null,new a.CellCoords(n,o),t)},p.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",function(){p.destroy()})}}t.__esModule=!0;var i=n(0),r=n(6),s=function(e){return e&&e.__esModule?e:{default:e}}(r),a=n(30),l=n(3),u=document.createElement("DIV");u.className="htAutocompleteWrapper";var c=document.createElement("DIV");c.className="htAutocompleteArrow",c.appendChild(document.createTextNode(String.fromCharCode(9660)));t.default=o},function(e,t,n){function o(e,t,n,o,a,l,u){function c(e){var t=(0,m.partial)(g.isKey,e.keyCode);t("SPACE|ENTER|DELETE|BACKSPACE")&&!(0,v.isImmediatePropagationStopped)(e)&&p(function(){(0,v.stopImmediatePropagation)(e),e.preventDefault()}),t("SPACE|ENTER")&&f(),t("DELETE|BACKSPACE")&&f(!0)}function f(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=e.getSelectedRange();if(n){for(var o=n.getTopLeftCorner(),i=n.getBottomRightCorner(),r=[],s=o.row;s<=i.row;s+=1)for(var a=o.col;a<=i.col;a+=1){var l=e.getCellMeta(s,a);if("checkbox"!==l.type)return;if(!0!==l.readOnly){void 0===l.checkedTemplate&&(l.checkedTemplate=!0),void 0===l.uncheckedTemplate&&(l.uncheckedTemplate=!1);var u=e.getDataAtCell(s,a);!1===t?u===l.checkedTemplate?r.push([s,a,l.uncheckedTemplate]):-1!==[l.uncheckedTemplate,null,void 0].indexOf(u)&&r.push([s,a,l.checkedTemplate]):r.push([s,a,l.uncheckedTemplate])}}r.length>0&&e.setDataAtCell(r)}}function p(t){var n=e.getSelectedRange();if(n)for(var o=n.getTopLeftCorner(),i=n.getBottomRightCorner(),r=o.row;r<=i.row;r++)for(var s=o.col;s<=i.col;s++){var a=e.getCellMeta(r,s);if("checkbox"!==a.type)return;var l=e.getCell(r,s);if(null==l)t(r,s,a);else{var u=l.querySelectorAll("input[type=checkbox]");u.length>0&&!a.readOnly&&t(u)}}}(0,w.getRenderer)("base").apply(this,arguments);var C=(i(e),r()),S=u.label,T=!1;if(void 0===u.checkedTemplate&&(u.checkedTemplate=!0),void 0===u.uncheckedTemplate&&(u.uncheckedTemplate=!1),(0,d.empty)(t),l===u.checkedTemplate||(0,h.equalsIgnoreCase)(l,u.checkedTemplate)?C.checked=!0:l===u.uncheckedTemplate||(0,h.equalsIgnoreCase)(l,u.uncheckedTemplate)?C.checked=!1:null===l?(0,d.addClass)(C,"noValue"):(C.style.display="none",(0,d.addClass)(C,b),T=!0),C.setAttribute("data-row",n),C.setAttribute("data-col",o),!T&&S){var E="";S.value?E="function"==typeof S.value?S.value.call(this,n,o,a,l):S.value:S.property&&(E=e.getDataAtRowProp(n,S.property));var R=s(E);"before"===S.position?R.appendChild(C):R.insertBefore(C,R.firstChild),C=R}t.appendChild(C),T&&t.appendChild(document.createTextNode("#bad-value#")),y.has(e)||(y.set(e,!0),e.addHook("beforeKeyDown",c))}function i(e){var t=C.get(e);return t||(t=new p.default(e),t.addEventListener(e.rootElement,"click",function(t){return l(t,e)}),t.addEventListener(e.rootElement,"mouseup",function(t){return a(t,e)}),t.addEventListener(e.rootElement,"change",function(t){return u(t,e)}),C.set(e,t)),t}function r(){var e=document.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("autocomplete","off"),e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function s(e){var t=document.createElement("label");return t.className="htCheckboxRendererLabel",t.appendChild(document.createTextNode(e)),t.cloneNode(!0)}function a(e,t){c(e.target)&&setTimeout(t.listen,10)}function l(e,t){if(!c(e.target))return!1;var n=parseInt(e.target.getAttribute("data-row"),10),o=parseInt(e.target.getAttribute("data-col"),10);t.getCellMeta(n,o).readOnly&&e.preventDefault()}function u(e,t){if(!c(e.target))return!1;var n=parseInt(e.target.getAttribute("data-row"),10),o=parseInt(e.target.getAttribute("data-col"),10),i=t.getCellMeta(n,o);if(!i.readOnly){var r=null;r=e.target.checked?void 0===i.uncheckedTemplate||i.checkedTemplate:void 0!==i.uncheckedTemplate&&i.uncheckedTemplate,t.setDataAtCell(n,o,r)}}function c(e){return"INPUT"===e.tagName&&"checkbox"===e.getAttribute("type")}t.__esModule=!0;var d=n(0),h=n(29),f=n(6),p=function(e){return e&&e.__esModule?e:{default:e}}(f),g=n(13),m=n(38),v=n(10),w=n(3),y=new WeakMap,C=new WeakMap,b="htBadValue";t.default=o},function(e,t,n){function o(e,t,n,o,s,a,l){(0,r.getRenderer)("base").apply(this,arguments),null!==a&&void 0!==a||(a=""),(0,i.fastInnerHTML)(t,a)}t.__esModule=!0;var i=n(0),r=n(3);t.default=o},function(e,t,n){function o(e,t,n,o,i,l,u){if((0,a.isNumeric)(l)){void 0!==u.language&&r.default.culture(u.language),l=(0,r.default)(l).format(u.format||"0");var c=u.className||"",d=c.length?c.split(" "):[];d.indexOf("htLeft")<0&&d.indexOf("htCenter")<0&&d.indexOf("htRight")<0&&d.indexOf("htJustify")<0&&d.push("htRight"),d.indexOf("htNumeric")<0&&d.push("htNumeric"),u.className=d.join(" ")}(0,s.getRenderer)("text")(e,t,n,o,i,l,u)}t.__esModule=!0;var i=n(49),r=function(e){return e&&e.__esModule?e:{default:e}}(i),s=n(3),a=n(18);t.default=o},function(e,t,n){function o(e,t,n,o,a,l,u){(0,r.getRenderer)("text").apply(this,arguments),l=t.innerHTML;var c=u.hashLength||l.length,d=u.hashSymbol||"*",h="";(0,s.rangeEach)(c-1,function(){h+=d}),(0,i.fastInnerHTML)(t,h)}t.__esModule=!0;var i=n(0),r=n(3),s=n(18);t.default=o},function(e,t,n){function o(e,t,n,o,a,l,u){(0,s.getRenderer)("base").apply(this,arguments),!l&&u.placeholder&&(l=u.placeholder);var c=(0,r.stringify)(l);if(e.getSettings().trimWhitespace||(c=c.replace(/ /g,String.fromCharCode(160))),u.rendererTemplate){(0,i.empty)(t);var d=document.createElement("TEMPLATE");d.setAttribute("bind","{{}}"),d.innerHTML=u.rendererTemplate,HTMLTemplateElement.decorate(d),d.model=e.getSourceDataAtRow(n),t.appendChild(d)}else(0,i.fastInnerText)(t,c)}t.__esModule=!0;var i=n(0),r=n(28),s=n(3);t.default=o},function(e,t,n){function o(e){return e&&e.__esModule?e:{default:e}}function i(e){var t=this,n=this;this.eventManager=new u.default(e),this.instance=e,this.settings=e.getSettings(),this.selectionMouseDown=!1;var o=e.rootElement.getAttribute("style");o&&e.rootElement.setAttribute("data-originalstyle",o),(0,s.addClass)(e.rootElement,"handsontable");var i=document.createElement("TABLE");(0,s.addClass)(i,"htCore"),e.getSettings().tableClassName&&(0,s.addClass)(i,e.getSettings().tableClassName),this.THEAD=document.createElement("THEAD"),i.appendChild(this.THEAD),this.TBODY=document.createElement("TBODY"),i.appendChild(this.TBODY),e.table=i,e.container.insertBefore(i,e.container.firstChild),this.eventManager.addEventListener(e.rootElement,"mousedown",function(e){this.selectionMouseDown=!0,n.isTextSelectionAllowed(e.target)||(l(),e.preventDefault(),window.focus())}),this.eventManager.addEventListener(e.rootElement,"mouseup",function(e){this.selectionMouseDown=!1}),this.eventManager.addEventListener(e.rootElement,"mousemove",function(e){this.selectionMouseDown&&!n.isTextSelectionAllowed(e.target)&&(l(),e.preventDefault())}),this.eventManager.addEventListener(document.documentElement,"keyup",function(t){e.selection.isInProgress()&&!t.shiftKey&&e.selection.finish()});var r;this.isMouseDown=function(){return r},this.eventManager.addEventListener(document.documentElement,"mouseup",function(t){e.selection.isInProgress()&&1===t.which&&e.selection.finish(),r=!1,!(0,s.isOutsideInput)(document.activeElement)&&e.selection.isSelected()||e.unlisten()}),this.eventManager.addEventListener(document.documentElement,"mousedown",function(t){var o=t.target,i=t.target,a=t.x||t.clientX,l=t.y||t.clientY;if(!r&&e.rootElement){if(i===e.view.wt.wtTable.holder){var u=(0,s.getScrollbarWidth)();if(document.elementFromPoint(a+u,l)!==e.view.wt.wtTable.holder||document.elementFromPoint(a,l+u)!==e.view.wt.wtTable.holder)return}else for(;i!==document.documentElement;){if(null===i){if(t.isTargetWebComponent)break;return}if(i===e.rootElement)return;i=i.parentNode}("function"==typeof n.settings.outsideClickDeselects?n.settings.outsideClickDeselects(o):n.settings.outsideClickDeselects)?e.deselectCell():e.destroyEditor()}}),this.eventManager.addEventListener(i,"selectstart",function(e){n.settings.fragmentSelection||(0,s.isInput)(e.target)||e.preventDefault()});var l=function(){window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&window.getSelection().removeAllRanges():document.selection&&document.selection.empty()},f=[new d.Selection({className:"current",border:{width:2,color:"#5292F7",cornerVisible:function(){return n.settings.fillHandle&&!n.isCellEdited()&&!e.selection.isMultiple()},multipleSelectionHandlesVisible:function(){return!n.isCellEdited()&&!e.selection.isMultiple()}}}),new d.Selection({className:"area",border:{width:1,color:"#89AFF9",cornerVisible:function(){return n.settings.fillHandle&&!n.isCellEdited()&&e.selection.isMultiple()},multipleSelectionHandlesVisible:function(){return!n.isCellEdited()&&e.selection.isMultiple()}}}),new d.Selection({className:"highlight",highlightHeaderClassName:n.settings.currentHeaderClassName,highlightRowClassName:n.settings.currentRowClassName,highlightColumnClassName:n.settings.currentColClassName}),new d.Selection({className:"fill",border:{width:1,color:"red"}})];f.current=f[0],f.area=f[1],f.highlight=f[2],f.fill=f[3];var p={debug:function(){return n.settings.debug},externalRowCalculator:this.instance.getPlugin("autoRowSize")&&this.instance.getPlugin("autoRowSize").isEnabled(),table:i,preventOverflow:function(){return t.settings.preventOverflow},stretchH:function(){return n.settings.stretchH},data:e.getDataAtCell,totalRows:function(){return e.countRows()},totalColumns:function(){return e.countCols()},fixedColumnsLeft:function(){return n.settings.fixedColumnsLeft},fixedRowsTop:function(){return n.settings.fixedRowsTop},fixedRowsBottom:function(){return n.settings.fixedRowsBottom},minSpareRows:function(){return n.settings.minSpareRows},renderAllRows:n.settings.renderAllRows,rowHeaders:function(){var t=[];return e.hasRowHeaders()&&t.push(function(e,t){n.appendRowHeader(e,t)}),e.runHooks("afterGetRowHeaderRenderers",t),t},columnHeaders:function(){var t=[];return e.hasColHeaders()&&t.push(function(e,t){n.appendColHeader(e,t)}),e.runHooks("afterGetColumnHeaderRenderers",t),t},columnWidth:e.getColWidth,rowHeight:e.getRowHeight,cellRenderer:function(e,t,o){var i=n.instance.getCellMeta(e,t),r=n.instance.colToProp(t),s=n.instance.getDataAtRowProp(e,r);n.instance.hasHook("beforeValueRender")&&(s=n.instance.runHooks("beforeValueRender",s)),n.instance.runHooks("beforeRenderer",o,e,t,r,s,i),n.instance.getCellRenderer(i)(n.instance,o,e,t,r,s,i),n.instance.runHooks("afterRenderer",o,e,t,r,s,i)},selections:f,hideBorderOnMouseDownOver:function(){return n.settings.fragmentSelection},onCellMouseDown:function(t,o,i,s){var a={row:!1,column:!1,cells:!1};if(e.listen(),n.activeWt=s,r=!0,e.runHooks("beforeOnCellMouseDown",t,o,i,a),!(0,c.isImmediatePropagationStopped)(t)){var l=e.getSelectedRange(),u=e.selection,h=u.selectedHeader;if(t.shiftKey&&l)o.row>=0&&o.col>=0&&!a.cells?(u.setSelectedHeaders(!1,!1),u.setRangeEnd(o)):(h.cols||h.rows)&&o.row>=0&&o.col>=0&&!a.cells?(u.setSelectedHeaders(!1,!1),u.setRangeEnd(new d.CellCoords(o.row,o.col))):h.cols&&o.row<0&&!a.column?u.setRangeEnd(new d.CellCoords(l.to.row,o.col)):h.rows&&o.col<0&&!a.row?u.setRangeEnd(new d.CellCoords(o.row,l.to.col)):(!h.cols&&!h.rows&&o.col<0||h.cols&&o.col<0)&&!a.row?(u.setSelectedHeaders(!0,!1),u.setRangeStartOnly(new d.CellCoords(l.from.row,0)),u.setRangeEnd(new d.CellCoords(o.row,e.countCols()-1))):(!h.cols&&!h.rows&&o.row<0||h.rows&&o.row<0)&&!a.column&&(u.setSelectedHeaders(!1,!0),u.setRangeStartOnly(new d.CellCoords(0,l.from.col)),u.setRangeEnd(new d.CellCoords(e.countRows()-1,o.col)));else{var f=!0;if(l){var p=l.from,g=l.to,m=!u.inInSelection(o);if(o.row<0&&h.cols){var v=Math.min(p.col,g.col),w=Math.max(p.col,g.col);f=o.col<v||o.col>w}else if(o.col<0&&h.rows){var y=Math.min(p.row,g.row),C=Math.max(p.row,g.row);f=o.row<y||o.row>C}else f=m}var b=(0,c.isRightClick)(t),S=(0,c.isLeftClick)(t)||"touchstart"===t.type;o.row<0&&o.col>=0&&!a.column?(u.setSelectedHeaders(!1,!0),(S||b&&f)&&(u.setRangeStartOnly(new d.CellCoords(0,o.col)),u.setRangeEnd(new d.CellCoords(Math.max(e.countRows()-1,0),o.col),!1))):o.col<0&&o.row>=0&&!a.row?(u.setSelectedHeaders(!0,!1),(S||b&&f)&&(u.setRangeStartOnly(new d.CellCoords(o.row,0)),u.setRangeEnd(new d.CellCoords(o.row,Math.max(e.countCols()-1,0)),!1))):o.col>=0&&o.row>=0&&!a.cells?(S||b&&f)&&(u.setSelectedHeaders(!1,!1),u.setRangeStart(o)):o.col<0&&o.row<0&&(o.row=0,o.col=0,u.setSelectedHeaders(!1,!1,!0),u.setRangeStart(o))}e.runHooks("afterOnCellMouseDown",t,o,i),n.activeWt=n.wt}},onCellMouseOut:function(t,o,i,r){n.activeWt=r,e.runHooks("beforeOnCellMouseOut",t,o,i),(0,c.isImmediatePropagationStopped)(t)||(e.runHooks("afterOnCellMouseOut",t,o,i),n.activeWt=n.wt)},onCellMouseOver:function(t,o,i,s){var a={row:!1,column:!1,cell:!1};n.activeWt=s,e.runHooks("beforeOnCellMouseOver",t,o,i,a),(0,c.isImmediatePropagationStopped)(t)||(0===t.button&&r&&(o.row>=0&&o.col,e.selection.selectedHeader.cols&&!a.column?e.selection.setRangeEnd(new d.CellCoords(e.countRows()-1,o.col),!1):e.selection.selectedHeader.rows&&!a.row?e.selection.setRangeEnd(new d.CellCoords(o.row,e.countCols()-1),!1):a.cell||e.selection.setRangeEnd(o)),e.runHooks("afterOnCellMouseOver",t,o,i),n.activeWt=n.wt)},onCellMouseUp:function(t,o,i,r){n.activeWt=r,e.runHooks("beforeOnCellMouseUp",t,o,i),e.runHooks("afterOnCellMouseUp",t,o,i),n.activeWt=n.wt},onCellCornerMouseDown:function(t){t.preventDefault(),e.runHooks("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:function(t){t.preventDefault(),e.runHooks("afterOnCellCornerDblClick",t)},beforeDraw:function(e,t){n.beforeRender(e,t)},onDraw:function(e){n.onDraw(e)},onScrollVertically:function(){e.runHooks("afterScrollVertically")},onScrollHorizontally:function(){e.runHooks("afterScrollHorizontally")},onBeforeDrawBorders:function(t,n){e.runHooks("beforeDrawBorders",t,n)},onBeforeTouchScroll:function(){e.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){e.runHooks("afterMomentumScroll")},onBeforeStretchingColumnWidth:function(t,n){return e.runHooks("beforeStretchingColumnWidth",t,n)},onModifyRowHeaderWidth:function(t){return e.runHooks("modifyRowHeaderWidth",t)},viewportRowCalculatorOverride:function(t){var o=e.countRows(),i=n.settings.viewportRowRenderingOffset;if("auto"===i&&n.settings.fixedRowsTop&&(i=10),"number"==typeof i&&(t.startRow=Math.max(t.startRow-i,0),t.endRow=Math.min(t.endRow+i,o-1)),"auto"===i){var r=t.startRow+t.endRow-t.startRow,s=Math.ceil(r/o*12);t.startRow=Math.max(t.startRow-s,0),t.endRow=Math.min(t.endRow+s,o-1)}e.runHooks("afterViewportRowCalculatorOverride",t)},viewportColumnCalculatorOverride:function(t){var o=e.countCols(),i=n.settings.viewportColumnRenderingOffset;if("auto"===i&&n.settings.fixedColumnsLeft&&(i=10),"number"==typeof i&&(t.startColumn=Math.max(t.startColumn-i,0),t.endColumn=Math.min(t.endColumn+i,o-1)),"auto"===i){var r=t.startColumn+t.endColumn-t.startColumn,s=Math.ceil(r/o*12);t.startRow=Math.max(t.startColumn-s,0),t.endColumn=Math.min(t.endColumn+s,o-1)}e.runHooks("afterViewportColumnCalculatorOverride",t)},rowHeaderWidth:function(){return n.settings.rowHeaderWidth},columnHeaderHeight:function(){var t=e.runHooks("modifyColumnHeaderHeight");return n.settings.columnHeaderHeight||t}};e.runHooks("beforeInitWalkontable",p),this.wt=new h.default(p),this.activeWt=this.wt,(0,a.isChrome)()||(0,a.isSafari)()||this.eventManager.addEventListener(e.rootElement,"wheel",function(e){e.preventDefault();var t=parseInt((0,s.getComputedStyle)(document.body)["font-size"],10),o=n.wt.wtOverlays.scrollableElement,i=e.wheelDeltaY||e.deltaY,r=e.wheelDeltaX||e.deltaX;switch(e.deltaMode){case 0:o.scrollLeft+=r,o.scrollTop+=i;break;case 1:o.scrollLeft+=r*t,o.scrollTop+=i*t}}),this.eventManager.addEventListener(n.wt.wtTable.spreader,"mousedown",function(e){e.target===n.wt.wtTable.spreader&&3===e.which&&(0,c.stopPropagation)(e)}),this.eventManager.addEventListener(n.wt.wtTable.spreader,"contextmenu",function(e){e.target===n.wt.wtTable.spreader&&3===e.which&&(0,c.stopPropagation)(e)}),this.eventManager.addEventListener(document.documentElement,"click",function(){n.settings.observeDOMVisibility&&n.wt.drawInterrupted&&(n.instance.forceFullRender=!0,n.render())})}t.__esModule=!0;var r=function(){function e(e,t){var n=[],o=!0,i=!1,r=void 0;try{for(var s,a=e[Symbol.iterator]();!(o=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);o=!0);}catch(e){i=!0,r=e}finally{try{!o&&a.return&&a.return()}finally{if(i)throw r}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=n(0),a=n(20),l=n(6),u=o(l),c=n(10),d=n(30),h=o(d);i.prototype.isTextSelectionAllowed=function(e){if((0,s.isInput)(e))return!0;var t=(0,s.isChildOf)(e,this.instance.view.wt.wtTable.spreader);return!(!0!==this.settings.fragmentSelection||!t)||(!("cell"!==this.settings.fragmentSelection||!this.isSelectedOnlyCell()||!t)||!(this.settings.fragmentSelection||!this.isCellEdited()||!this.isSelectedOnlyCell()))},i.prototype.isSelectedOnlyCell=function(){var e=this.instance.getSelected()||[],t=r(e,4),n=t[0],o=t[1],i=t[2],s=t[3];return void 0!==n&&n===i&&o===s},i.prototype.isCellEdited=function(){var e=this.instance.getActiveEditor();return e&&e.isOpened()},i.prototype.beforeRender=function(e,t){e&&this.instance.runHooks("beforeRender",this.instance.forceFullRender,t)},i.prototype.onDraw=function(e){e&&this.instance.runHooks("afterRender",this.instance.forceFullRender)},i.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender),this.instance.forceFullRender=!1,this.instance.renderCall=!1},i.prototype.getCellAtCoords=function(e,t){var n=this.wt.getCell(e,t);return n<0?null:n},i.prototype.scrollViewport=function(e){this.wt.scrollViewport(e)},i.prototype.appendRowHeader=function(e,t){if(t.firstChild){var n=t.firstChild;if(!(0,s.hasClass)(n,"relative"))return(0,s.empty)(t),void this.appendRowHeader(e,t);this.updateCellHeader(n.querySelector(".rowHeader"),e,this.instance.getRowHeader)}else{var o=document.createElement("div"),i=document.createElement("span");o.className="relative",i.className="rowHeader",this.updateCellHeader(i,e,this.instance.getRowHeader),o.appendChild(i),t.appendChild(o)}this.instance.runHooks("afterGetRowHeader",e,t)},i.prototype.appendColHeader=function(e,t){if(t.firstChild){var n=t.firstChild;(0,s.hasClass)(n,"relative")?this.updateCellHeader(n.querySelector(".colHeader"),e,this.instance.getColHeader):((0,s.empty)(t),this.appendColHeader(e,t))}else{var o=document.createElement("div"),i=document.createElement("span");o.className="relative",i.className="colHeader",this.updateCellHeader(i,e,this.instance.getColHeader),o.appendChild(i),t.appendChild(o)}this.instance.runHooks("afterGetColHeader",e,t)},i.prototype.updateCellHeader=function(e,t,n){var o=t,i=this.wt.wtOverlays.getParentOverlay(e)||this.wt;e.parentNode&&((0,s.hasClass)(e,"colHeader")?o=i.wtTable.columnFilter.sourceToRendered(t):(0,s.hasClass)(e,"rowHeader")&&(o=i.wtTable.rowFilter.sourceToRendered(t))),o>-1?(0,s.fastInnerHTML)(e,n(t)):((0,s.fastInnerText)(e,String.fromCharCode(160)),(0,s.addClass)(e,"cornerHeader"))},i.prototype.maximumVisibleElementWidth=function(e){var t=this.wt.wtViewport.getWorkspaceWidth(),n=t-e;return n>0?n:0},i.prototype.maximumVisibleElementHeight=function(e){var t=this.wt.wtViewport.getWorkspaceHeight(),n=t-e;return n>0?n:0},i.prototype.mainViewIsActive=function(){return this.wt===this.activeWt},i.prototype.destroy=function(){this.wt.destroy(),this.eventManager.destroy()},t.default=i},function(e,t,n){function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){return"string"==typeof e&&/fps$/.test(e)&&(e=1e3/parseInt(e.replace("fps","")||0,10)),e}t.__esModule=!0;var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();t.parseDelay=i;var s=n(37),a=function(){function e(t,n){var r=this;o(this,e),this.timer=null,this.func=t,this.delay=i(n),this.stopped=!0,this._then=null,this._callback=function(){return r.__callback()}}return r(e,null,[{key:"create",value:function(t,n){return new e(t,n)}}]),r(e,[{key:"start",value:function(){return this.stopped&&(this._then=Date.now(),this.stopped=!1,this.timer=(0,s.requestAnimationFrame)(this._callback)),this}},{key:"stop",value:function(){return this.stopped||(this.stopped=!0,(0,s.cancelAnimationFrame)(this.timer),this.timer=null),this}},{key:"__callback",value:function(){if(this.timer=(0,s.requestAnimationFrame)(this._callback),this.delay){var e=Date.now(),t=e-this._then;t>this.delay&&(this._then=e-t%this.delay,this.func())}else this.func()}}]),e}();t.default=a},function(e,t,n){function o(e,t){if(null==e&&(e=""),this.allowEmpty&&""===e)return void t(!0);this.strict&&this.source?"function"==typeof this.source?this.source(e,i(e,t)):i(e,t)(this.source):t(!0)}function i(e,t){var n=e;return function(e){for(var o=!1,i=0,r=e.length;i<r;i++)if(n===e[i]){o=!0;break}t(o)}}t.__esModule=!0,t.default=o},function(e,t,n){function o(e,t){var n=!0,o=(0,l.getEditorInstance)("date",this.instance);null==e&&(e="");var r=(0,s.default)(new Date(e)).isValid()||(0,s.default)(e,o.defaultDateFormat).isValid(),a=(0,s.default)(e,this.dateFormat||o.defaultDateFormat,!0).isValid();if(this.allowEmpty&&""===e&&(r=!0,a=!0),r||(n=!1),!r&&a&&(n=!0),r&&!a)if(!0===this.correctFormat){var u=i(e,this.dateFormat),c=this.instance.runHooks("unmodifyRow",this.row),d=this.instance.runHooks("unmodifyCol",this.col);this.instance.setDataAtCell(c,d,u,"dateValidator"),n=!0}else n=!1;t(n)}function i(e,t){var n=(0,s.default)((0,a.getNormalizedDate)(e)),o=(0,s.default)(e,t),i=e.search(/[A-z]/g)>-1,r=void 0;return r=n.isValid()&&n.format("x")===o.format("x")||!o.isValid()||i?n:o,r.format(t)}t.__esModule=!0,t.default=o,t.correctFormat=i;var r=n(40),s=function(e){return e&&e.__esModule?e:{default:e}}(r),a=n(83),l=n(8)},function(e,t,n){function o(e,t){null==e&&(e=""),t(this.allowEmpty&&""===e?!0:""===e?!1:/^-?\d*(\.|,)?\d*$/.test(e))}t.__esModule=!0,t.default=o},function(e,t,n){function o(e,t){var n=!0,o=this.timeFormat||"h:mm:ss a";null===e&&(e=""),e=/^\d{3,}$/.test(e)?parseInt(e,10):e;var i=/^\d{1,2}$/.test(e);i&&(e+=":00");var a=(0,r.default)(e,s,!0).isValid()?(0,r.default)(e):(0,r.default)(e,o),l=a.isValid(),u=(0,r.default)(e,o,!0).isValid()&&!i;if(this.allowEmpty&&""===e&&(l=!0,u=!0),l||(n=!1),!l&&u&&(n=!0),l&&!u)if(!0===this.correctFormat){var c=a.format(o),d=this.instance.runHooks("unmodifyRow",this.row),h=this.instance.runHooks("unmodifyCol",this.col);this.instance.setDataAtCell(d,h,c,"timeValidator"),n=!0}else n=!1;t(n)}t.__esModule=!0,t.default=o;var i=n(40),r=function(e){return e&&e.__esModule?e:{default:e}}(i),s=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"]},function(e,t,n){var o=n(36),i=n(59),r=n(17);e.exports=[].copyWithin||function(e,t){var n=o(this),s=r(n.length),a=i(e,s),l=i(t,s),u=arguments.length>2?arguments[2]:void 0,c=Math.min((void 0===u?s:i(u,s))-l,s-a),d=1;for(l<a&&a<l+c&&(d=-1,l+=c-1,a+=c-1);c-- >0;)l in n?n[a]=n[l]:delete n[a],a+=d,l+=d;return n}},function(e,t,n){var o=n(36),i=n(59),r=n(17);e.exports=function(e){for(var t=o(this),n=r(t.length),s=arguments.length,a=i(s>1?arguments[1]:void 0,n),l=s>2?arguments[2]:void 0,u=void 0===l?n:i(l,n);u>a;)t[a++]=e;return t}},function(e,t,n){var o=n(9),i=n(266),r=n(4)("species");e.exports=function(e){var t;return i(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!i(t.prototype)||(t=void 0),o(t)&&null===(t=t[r])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){var o=n(334);e.exports=function(e,t){return new(o(e))(t)}},function(e,t,n){var o=n(34),i=n(57),r=n(46);e.exports=function(e){var t=o(e),n=i.f;if(n)for(var s,a=n(e),l=r.f,u=0;a.length>u;)l.call(e,s=a[u++])&&t.push(s);return t}},function(e,t,n){var o=n(11);e.exports=function(){var e=o(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t,n){var o=n(9),i=n(275).set;e.exports=function(e,t,n){var r,s=t.constructor;return s!==n&&"function"==typeof s&&(r=s.prototype)!==n.prototype&&o(r)&&i&&i(e,r),e}},function(e,t){e.exports=function(e,t,n){var o=void 0===n;switch(t.length){case 0:return o?e():e.call(n);case 1:return o?e(t[0]):e.call(n,t[0]);case 2:return o?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return o?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return o?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var o=n(73),i=n(35),r=n(47),s={};n(26)(s,n(4)("iterator"),function(){return this}),e.exports=function(e,t,n){e.prototype=o(s,{next:i(1,n)}),r(e,t+" Iterator")}},function(e,t,n){var o=n(34),i=n(16);e.exports=function(e,t){for(var n,r=i(e),s=o(r),a=s.length,l=0;a>l;)if(r[n=s[l++]]===t)return n}},function(e,t,n){var o=n(5),i=n(79).set,r=o.MutationObserver||o.WebKitMutationObserver,s=o.process,a=o.Promise,l="process"==n(33)(s);e.exports=function(){var e,t,n,u=function(){var o,i;for(l&&(o=s.domain)&&o.exit();e;){i=e.fn,e=e.next;try{i()}catch(o){throw e?n():t=void 0,o}}t=void 0,o&&o.enter()};if(l)n=function(){s.nextTick(u)};else if(r){var c=!0,d=document.createTextNode("");new r(u).observe(d,{characterData:!0}),n=function(){d.data=c=!c}}else if(a&&a.resolve){var h=a.resolve();n=function(){h.then(u)}}else n=function(){i.call(o,u)};return function(o){var i={fn:o,next:void 0};t&&(t.next=i),e||(e=i,n()),t=i}}},function(e,t,n){var o=n(12),i=n(11),r=n(34);e.exports=n(14)?Object.defineProperties:function(e,t){i(e);for(var n,s=r(t),a=s.length,l=0;a>l;)o.f(e,n=s[l++],t[n]);return e}},function(e,t,n){var o=n(16),i=n(75).f,r={}.toString,a="object"==("undefined"==typeof window?"undefined":s(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],l=function(e){try{return i(e)}catch(e){return a.slice()}};e.exports.f=function(e){return a&&"[object Window]"==r.call(e)?l(e):i(o(e))}},function(e,t,n){var o=n(15),i=n(36),r=n(76)("IE_PROTO"),s=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),o(e,r)?e[r]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?s:null}},function(e,t,n){var o=n(75),i=n(57),r=n(11),s=n(5).Reflect;e.exports=s&&s.ownKeys||function(e){var t=o.f(r(e)),n=i.f;return n?t.concat(n(e)):t}},function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},function(e,t,n){var o=n(11),i=n(66),r=n(4)("species");e.exports=function(e,t){var n,s=o(e).constructor;return void 0===s||void 0==(n=o(s)[r])?t:i(n)}},function(e,t,n){var o=n(60),i=n(24);e.exports=function(e){return function(t,n){var r,s,a=String(i(t)),l=o(n),u=a.length;return l<0||l>=u?e?"":void 0:(r=a.charCodeAt(l),r<55296||r>56319||l+1===u||(s=a.charCodeAt(l+1))<56320||s>57343?e?a.charAt(l):r:e?a.slice(l,l+2):s-56320+(r-55296<<10)+65536)}}},function(e,t,n){var o=n(5),i=n(43),r=n(56),s=n(279),a=n(12).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=r?{}:o.Symbol||{});"_"==e.charAt(0)||e in t||a(t,e,{value:s.f(e)})}},function(e,t,n){function o(e){return n(i(e))}function i(e){var t=r[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var r={"./af":127,"./af.js":127,"./ar":134,"./ar-dz":128,"./ar-dz.js":128,"./ar-kw":129,"./ar-kw.js":129,"./ar-ly":130,"./ar-ly.js":130,"./ar-ma":131,"./ar-ma.js":131,"./ar-sa":132,"./ar-sa.js":132,"./ar-tn":133,"./ar-tn.js":133,"./ar.js":134,"./az":135,"./az.js":135,"./be":136,"./be.js":136,"./bg":137,"./bg.js":137,"./bn":138,"./bn.js":138,"./bo":139,"./bo.js":139,"./br":140,"./br.js":140,"./bs":141,"./bs.js":141,"./ca":142,"./ca.js":142,"./cs":143,"./cs.js":143,"./cv":144,"./cv.js":144,"./cy":145,"./cy.js":145,"./da":146,"./da.js":146,"./de":149,"./de-at":147,"./de-at.js":147,"./de-ch":148,"./de-ch.js":148,"./de.js":149,"./dv":150,"./dv.js":150,"./el":151,"./el.js":151,"./en-au":152,"./en-au.js":152,"./en-ca":153,"./en-ca.js":153,"./en-gb":154,"./en-gb.js":154,"./en-ie":155,"./en-ie.js":155,"./en-nz":156,"./en-nz.js":156,"./eo":157,"./eo.js":157,"./es":159,"./es-do":158,"./es-do.js":158,"./es.js":159,"./et":160,"./et.js":160,"./eu":161,"./eu.js":161,"./fa":162,"./fa.js":162,"./fi":163,"./fi.js":163,"./fo":164,"./fo.js":164,"./fr":167,"./fr-ca":165,"./fr-ca.js":165,"./fr-ch":166,"./fr-ch.js":166,"./fr.js":167,"./fy":168,"./fy.js":168,"./gd":169,"./gd.js":169,"./gl":170,"./gl.js":170,"./gom-latn":171,"./gom-latn.js":171,"./he":172,"./he.js":172,"./hi":173,"./hi.js":173,"./hr":174,"./hr.js":174,"./hu":175,"./hu.js":175,"./hy-am":176,"./hy-am.js":176,"./id":177,"./id.js":177,"./is":178,"./is.js":178,"./it":179,"./it.js":179,"./ja":180,"./ja.js":180,"./jv":181,"./jv.js":181,"./ka":182,"./ka.js":182,"./kk":183,"./kk.js":183,"./km":184,"./km.js":184,"./kn":185,"./kn.js":185,"./ko":186,"./ko.js":186,"./ky":187,"./ky.js":187,"./lb":188,"./lb.js":188,"./lo":189,"./lo.js":189,"./lt":190,"./lt.js":190,"./lv":191,"./lv.js":191,"./me":192,"./me.js":192,"./mi":193,"./mi.js":193,"./mk":194,"./mk.js":194,"./ml":195,"./ml.js":195,"./mr":196,"./mr.js":196,"./ms":198,"./ms-my":197,"./ms-my.js":197,"./ms.js":198,"./my":199,"./my.js":199,"./nb":200,"./nb.js":200,"./ne":201,"./ne.js":201,"./nl":203,"./nl-be":202,"./nl-be.js":202,"./nl.js":203,"./nn":204,"./nn.js":204,"./pa-in":205,"./pa-in.js":205,"./pl":206,"./pl.js":206,"./pt":208,"./pt-br":207,"./pt-br.js":207,"./pt.js":208,"./ro":209,"./ro.js":209,"./ru":210,"./ru.js":210,"./sd":211,"./sd.js":211,"./se":212,"./se.js":212,"./si":213,"./si.js":213,"./sk":214,"./sk.js":214,"./sl":215,"./sl.js":215,"./sq":216,"./sq.js":216,"./sr":218,"./sr-cyrl":217,"./sr-cyrl.js":217,"./sr.js":218,"./ss":219,"./ss.js":219,"./sv":220,"./sv.js":220,"./sw":221,"./sw.js":221,"./ta":222,"./ta.js":222,"./te":223,"./te.js":223,"./tet":224,"./tet.js":224,"./th":225,"./th.js":225,"./tl-ph":226,"./tl-ph.js":226,"./tlh":227,"./tlh.js":227,"./tr":228,"./tr.js":228,"./tzl":229,"./tzl.js":229,"./tzm":231,"./tzm-latn":230,"./tzm-latn.js":230,"./tzm.js":231,"./uk":232,"./uk.js":232,"./ur":233,"./ur.js":233,"./uz":235,"./uz-latn":234,"./uz-latn.js":234,"./uz.js":235,"./vi":236,"./vi.js":236,"./x-pseudo":237,"./x-pseudo.js":237,"./yo":238,"./yo.js":238,"./zh-cn":239,"./zh-cn.js":239,"./zh-hk":240,"./zh-hk.js":240,"./zh-tw":241,"./zh-tw.js":241};o.keys=function(){return Object.keys(r)},o.resolve=i,e.exports=o,o.id=351},function(e,t,n){/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/dbushell/Pikaday
 */
!function(t,o){var i;try{i=n(40)}catch(e){}e.exports=o(i)}(0,function(e){var t="function"==typeof e,n=!!window.addEventListener,o=window.document,i=window.setTimeout,r=function(e,t,o,i){n?e.addEventListener(t,o,!!i):e.attachEvent("on"+t,o)},a=function(e,t,o,i){n?e.removeEventListener(t,o,!!i):e.detachEvent("on"+t,o)},l=function(e,t,n){var i;o.createEvent?(i=o.createEvent("HTMLEvents"),i.initEvent(t,!0,!1),i=C(i,n),e.dispatchEvent(i)):o.createEventObject&&(i=o.createEventObject(),i=C(i,n),e.fireEvent("on"+t,i))},u=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},c=function(e,t){return-1!==(" "+e.className+" ").indexOf(" "+t+" ")},d=function(e,t){c(e,t)||(e.className=""===e.className?t:e.className+" "+t)},h=function(e,t){e.className=u((" "+e.className+" ").replace(" "+t+" "," "))},f=function(e){return/Array/.test(Object.prototype.toString.call(e))},p=function(e){return/Date/.test(Object.prototype.toString.call(e))&&!isNaN(e.getTime())},g=function(e){var t=e.getDay();return 0===t||6===t},m=function(e){return e%4==0&&e%100!=0||e%400==0},v=function(e,t){return[31,m(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},w=function(e){p(e)&&e.setHours(0,0,0,0)},y=function(e,t){return e.getTime()===t.getTime()},C=function e(t,n,o){var i,r;for(i in n)r=void 0!==t[i],r&&"object"===s(n[i])&&null!==n[i]&&void 0===n[i].nodeName?p(n[i])?o&&(t[i]=new Date(n[i].getTime())):f(n[i])?o&&(t[i]=n[i].slice(0)):t[i]=e({},n[i],o):!o&&r||(t[i]=n[i]);return t},b=function(e){return e.month<0&&(e.year-=Math.ceil(Math.abs(e.month)/12),e.month+=12),e.month>11&&(e.year+=Math.floor(Math.abs(e.month)/12),e.month-=12),e},S={field:null,bound:void 0,position:"bottom left",reposition:!0,format:"YYYY-MM-DD",defaultDate:null,setDefaultDate:!1,firstDay:0,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,onSelect:null,onOpen:null,onClose:null,onDraw:null},T=function(e,t,n){for(t+=e.firstDay;t>=7;)t-=7;return n?e.i18n.weekdaysShort[t]:e.i18n.weekdays[t]},E=function(e){var t=[],n="false";if(e.isEmpty){if(!e.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';t.push("is-outside-current-month")}return e.isDisabled&&t.push("is-disabled"),e.isToday&&t.push("is-today"),e.isSelected&&(t.push("is-selected"),n="true"),e.isInRange&&t.push("is-inrange"),e.isStartRange&&t.push("is-startrange"),e.isEndRange&&t.push("is-endrange"),'<td data-day="'+e.day+'" class="'+t.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+e.year+'" data-pika-month="'+e.month+'" data-pika-day="'+e.day+'">'+e.day+"</button></td>"},R=function(e,t,n){var o=new Date(n,0,1);return'<td class="pika-week">'+Math.ceil(((new Date(n,t,e)-o)/864e5+o.getDay()+1)/7)+"</td>"},O=function(e,t){return"<tr>"+(t?e.reverse():e).join("")+"</tr>"},_=function(e){return"<tbody>"+e.join("")+"</tbody>"},k=function(e){var t,n=[];for(e.showWeekNumber&&n.push("<th></th>"),t=0;t<7;t++)n.push('<th scope="col"><abbr title="'+T(e,t)+'">'+T(e,t,!0)+"</abbr></th>");return"<thead><tr>"+(e.isRTL?n.reverse():n).join("")+"</tr></thead>"},M=function(e,t,n,o,i,r){var s,a,l,u,c,d=e._o,h=n===d.minYear,p=n===d.maxYear,g='<div id="'+r+'" class="pika-title" role="heading" aria-live="assertive">',m=!0,v=!0;for(l=[],s=0;s<12;s++)l.push('<option value="'+(n===i?s-t:12+s-t)+'"'+(s===o?' selected="selected"':"")+(h&&s<d.minMonth||p&&s>d.maxMonth?'disabled="disabled"':"")+">"+d.i18n.months[s]+"</option>");for(u='<div class="pika-label">'+d.i18n.months[o]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",f(d.yearRange)?(s=d.yearRange[0],a=d.yearRange[1]+1):(s=n-d.yearRange,a=1+n+d.yearRange),l=[];s<a&&s<=d.maxYear;s++)s>=d.minYear&&l.push('<option value="'+s+'"'+(s===n?' selected="selected"':"")+">"+s+"</option>");return c='<div class="pika-label">'+n+d.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",d.showMonthAfterYear?g+=c+u:g+=u+c,h&&(0===o||d.minMonth>=o)&&(m=!1),p&&(11===o||d.maxMonth<=o)&&(v=!1),0===t&&(g+='<button class="pika-prev'+(m?"":" is-disabled")+'" type="button">'+d.i18n.previousMonth+"</button>"),t===e._o.numberOfMonths-1&&(g+='<button class="pika-next'+(v?"":" is-disabled")+'" type="button">'+d.i18n.nextMonth+"</button>"),g+="</div>"},D=function(e,t,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+k(e)+_(t)+"</table>"},H=function(s){var a=this,l=a.config(s);a._onMouseDown=function(e){if(a._v){e=e||window.event;var t=e.target||e.srcElement;if(t)if(c(t,"is-disabled")||(!c(t,"pika-button")||c(t,"is-empty")||c(t.parentNode,"is-disabled")?c(t,"pika-prev")?a.prevMonth():c(t,"pika-next")&&a.nextMonth():(a.setDate(new Date(t.getAttribute("data-pika-year"),t.getAttribute("data-pika-month"),t.getAttribute("data-pika-day"))),l.bound&&i(function(){a.hide(),l.field&&l.field.blur()},100))),c(t,"pika-select"))a._c=!0;else{if(!e.preventDefault)return e.returnValue=!1,!1;e.preventDefault()}}},a._onChange=function(e){e=e||window.event;var t=e.target||e.srcElement;t&&(c(t,"pika-select-month")?a.gotoMonth(t.value):c(t,"pika-select-year")&&a.gotoYear(t.value))},a._onKeyChange=function(e){if(e=e||window.event,a.isVisible())switch(e.keyCode){case 13:case 27:l.field.blur();break;case 37:e.preventDefault(),a.adjustDate("subtract",1);break;case 38:a.adjustDate("subtract",7);break;case 39:a.adjustDate("add",1);break;case 40:a.adjustDate("add",7)}},a._onInputChange=function(n){var o;n.firedBy!==a&&(t?(o=e(l.field.value,l.format,l.formatStrict),o=o&&o.isValid()?o.toDate():null):o=new Date(Date.parse(l.field.value)),p(o)&&a.setDate(o),a._v||a.show())},a._onInputFocus=function(){a.show()},a._onInputClick=function(){a.show()},a._onInputBlur=function(){var e=o.activeElement;do{if(c(e,"pika-single"))return}while(e=e.parentNode);a._c||(a._b=i(function(){a.hide()},50)),a._c=!1},a._onClick=function(e){e=e||window.event;var t=e.target||e.srcElement,o=t;if(t){!n&&c(t,"pika-select")&&(t.onchange||(t.setAttribute("onchange","return;"),r(t,"change",a._onChange)));do{if(c(o,"pika-single")||o===l.trigger)return}while(o=o.parentNode);a._v&&t!==l.trigger&&o!==l.trigger&&a.hide()}},a.el=o.createElement("div"),a.el.className="pika-single"+(l.isRTL?" is-rtl":"")+(l.theme?" "+l.theme:""),r(a.el,"mousedown",a._onMouseDown,!0),r(a.el,"touchend",a._onMouseDown,!0),r(a.el,"change",a._onChange),r(o,"keydown",a._onKeyChange),l.field&&(l.container?l.container.appendChild(a.el):l.bound?o.body.appendChild(a.el):l.field.parentNode.insertBefore(a.el,l.field.nextSibling),r(l.field,"change",a._onInputChange),l.defaultDate||(t&&l.field.value?l.defaultDate=e(l.field.value,l.format).toDate():l.defaultDate=new Date(Date.parse(l.field.value)),l.setDefaultDate=!0));var u=l.defaultDate;p(u)?l.setDefaultDate?a.setDate(u,!0):a.gotoDate(u):a.gotoDate(new Date),l.bound?(this.hide(),a.el.className+=" is-bound",r(l.trigger,"click",a._onInputClick),r(l.trigger,"focus",a._onInputFocus),r(l.trigger,"blur",a._onInputBlur)):this.show()};return H.prototype={config:function(e){this._o||(this._o=C({},S,!0));var t=C(this._o,e,!0);t.isRTL=!!t.isRTL,t.field=t.field&&t.field.nodeName?t.field:null,t.theme="string"==typeof t.theme&&t.theme?t.theme:null,t.bound=!!(void 0!==t.bound?t.field&&t.bound:t.field),t.trigger=t.trigger&&t.trigger.nodeName?t.trigger:t.field,t.disableWeekends=!!t.disableWeekends,t.disableDayFn="function"==typeof t.disableDayFn?t.disableDayFn:null;var n=parseInt(t.numberOfMonths,10)||1;if(t.numberOfMonths=n>4?4:n,p(t.minDate)||(t.minDate=!1),p(t.maxDate)||(t.maxDate=!1),t.minDate&&t.maxDate&&t.maxDate<t.minDate&&(t.maxDate=t.minDate=!1),t.minDate&&this.setMinDate(t.minDate),t.maxDate&&this.setMaxDate(t.maxDate),f(t.yearRange)){var o=(new Date).getFullYear()-10;t.yearRange[0]=parseInt(t.yearRange[0],10)||o,t.yearRange[1]=parseInt(t.yearRange[1],10)||o}else t.yearRange=Math.abs(parseInt(t.yearRange,10))||S.yearRange,t.yearRange>100&&(t.yearRange=100);return t},toString:function(n){return p(this._d)?t?e(this._d).format(n||this._o.format):this._d.toDateString():""},getMoment:function(){return t?e(this._d):null},setMoment:function(n,o){t&&e.isMoment(n)&&this.setDate(n.toDate(),o)},getDate:function(){return p(this._d)?new Date(this._d.getTime()):new Date},setDate:function(e,t){if(!e)return this._d=null,this._o.field&&(this._o.field.value="",l(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof e&&(e=new Date(Date.parse(e))),p(e)){var n=this._o.minDate,o=this._o.maxDate;p(n)&&e<n?e=n:p(o)&&e>o&&(e=o),this._d=new Date(e.getTime()),w(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),l(this._o.field,"change",{firedBy:this})),t||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())}},gotoDate:function(e){var t=!0;if(p(e)){if(this.calendars){var n=new Date(this.calendars[0].year,this.calendars[0].month,1),o=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=e.getTime();o.setMonth(o.getMonth()+1),o.setDate(o.getDate()-1),t=i<n.getTime()||o.getTime()<i}t&&(this.calendars=[{month:e.getMonth(),year:e.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(n,o){var i,r=this.getDate(),s=24*parseInt(o)*60*60*1e3;"add"===n?i=new Date(r.valueOf()+s):"subtract"===n&&(i=new Date(r.valueOf()-s)),t&&("add"===n?i=e(r).add(o,"days").toDate():"subtract"===n&&(i=e(r).subtract(o,"days").toDate())),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=b(this.calendars[0]);for(var e=1;e<this._o.numberOfMonths;e++)this.calendars[e]=b({month:this.calendars[0].month+e,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(e){isNaN(e)||(this.calendars[0].month=parseInt(e,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(e){isNaN(e)||(this.calendars[0].year=parseInt(e,10),this.adjustCalendars())},setMinDate:function(e){e instanceof Date?(w(e),this._o.minDate=e,this._o.minYear=e.getFullYear(),this._o.minMonth=e.getMonth()):(this._o.minDate=S.minDate,this._o.minYear=S.minYear,this._o.minMonth=S.minMonth,this._o.startRange=S.startRange),this.draw()},setMaxDate:function(e){e instanceof Date?(w(e),this._o.maxDate=e,this._o.maxYear=e.getFullYear(),this._o.maxMonth=e.getMonth()):(this._o.maxDate=S.maxDate,this._o.maxYear=S.maxYear,this._o.maxMonth=S.maxMonth,this._o.endRange=S.endRange),this.draw()},setStartRange:function(e){this._o.startRange=e},setEndRange:function(e){this._o.endRange=e},draw:function(e){if(this._v||e){var t,n=this._o,o=n.minYear,r=n.maxYear,s=n.minMonth,a=n.maxMonth,l="";this._y<=o&&(this._y=o,!isNaN(s)&&this._m<s&&(this._m=s)),this._y>=r&&(this._y=r,!isNaN(a)&&this._m>a&&(this._m=a)),t="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2);for(var u=0;u<n.numberOfMonths;u++)l+='<div class="pika-lendar">'+M(this,u,this.calendars[u].year,this.calendars[u].month,this.calendars[0].year,t)+this.render(this.calendars[u].year,this.calendars[u].month,t)+"</div>";this.el.innerHTML=l,n.bound&&"hidden"!==n.field.type&&i(function(){n.trigger.focus()},1),"function"==typeof this._o.onDraw&&this._o.onDraw(this),n.bound&&n.field.setAttribute("aria-label","Use the arrow keys to pick a date")}},adjustPosition:function(){var e,t,n,i,r,s,a,l,u,c;if(!this._o.container){if(this.el.style.position="absolute",e=this._o.trigger,t=e,n=this.el.offsetWidth,i=this.el.offsetHeight,r=window.innerWidth||o.documentElement.clientWidth,s=window.innerHeight||o.documentElement.clientHeight,a=window.pageYOffset||o.body.scrollTop||o.documentElement.scrollTop,"function"==typeof e.getBoundingClientRect)c=e.getBoundingClientRect(),l=c.left+window.pageXOffset,u=c.bottom+window.pageYOffset;else for(l=t.offsetLeft,u=t.offsetTop+t.offsetHeight;t=t.offsetParent;)l+=t.offsetLeft,u+=t.offsetTop;(this._o.reposition&&l+n>r||this._o.position.indexOf("right")>-1&&l-n+e.offsetWidth>0)&&(l=l-n+e.offsetWidth),(this._o.reposition&&u+i>s+a||this._o.position.indexOf("top")>-1&&u-i-e.offsetHeight>0)&&(u=u-i-e.offsetHeight),this.el.style.left=l+"px",this.el.style.top=u+"px"}},render:function(e,t,n){var o=this._o,i=new Date,r=v(e,t),s=new Date(e,t,1).getDay(),a=[],l=[];w(i),o.firstDay>0&&(s-=o.firstDay)<0&&(s+=7);for(var u=0===t?11:t-1,c=11===t?0:t+1,d=0===t?e-1:e,h=11===t?e+1:e,f=v(d,u),m=r+s,C=m;C>7;)C-=7;m+=7-C;for(var b=0,S=0;b<m;b++){var T=new Date(e,t,b-s+1),_=!!p(this._d)&&y(T,this._d),k=y(T,i),M=b<s||b>=r+s,H=b-s+1,x=t,A=e,P=o.startRange&&y(o.startRange,T),N=o.endRange&&y(o.endRange,T),L=o.startRange&&o.endRange&&o.startRange<T&&T<o.endRange,W=o.minDate&&T<o.minDate||o.maxDate&&T>o.maxDate||o.disableWeekends&&g(T)||o.disableDayFn&&o.disableDayFn(T);M&&(b<s?(H=f+H,x=u,A=d):(H-=r,x=c,A=h));var j={day:H,month:x,year:A,isSelected:_,isToday:k,isDisabled:W,isEmpty:M,isStartRange:P,isEndRange:N,isInRange:L,showDaysInNextAndPreviousMonths:o.showDaysInNextAndPreviousMonths};l.push(E(j)),7==++S&&(o.showWeekNumber&&l.unshift(R(b-s,t,e)),a.push(O(l,o.isRTL)),l=[],S=0)}return D(o,a,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(h(this.el,"is-hidden"),this._v=!0,this.draw(),this._o.bound&&(r(o,"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){var e=this._v;!1!==e&&(this._o.bound&&a(o,"click",this._onClick),this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto",d(this.el,"is-hidden"),this._v=!1,void 0!==e&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){this.hide(),a(this.el,"mousedown",this._onMouseDown,!0),a(this.el,"touchend",this._onMouseDown,!0),a(this.el,"change",this._onChange),this._o.field&&(a(this._o.field,"change",this._onInputChange),this._o.bound&&(a(this._o.trigger,"click",this._onInputClick),a(this._o.trigger,"focus",this._onInputFocus),a(this._o.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}},H})},function(e,t){},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}}])})}).call(t,n(5),n(6)(e))},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(c===setTimeout)return setTimeout(e,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(e,0);try{return c(e,0)}catch(t){try{return c.call(null,e,0)}catch(t){return c.call(this,e,0)}}}function r(e){if(d===clearTimeout)return clearTimeout(e);if((d===o||!d)&&clearTimeout)return d=clearTimeout,clearTimeout(e);try{return d(e)}catch(t){try{return d.call(null,e)}catch(t){return d.call(this,e)}}}function s(){g&&f&&(g=!1,f.length?p=f.concat(p):m=-1,p.length&&a())}function a(){if(!g){var e=i(s);g=!0;for(var t=p.length;t;){for(f=p,p=[];++m<t;)f&&f[m].run();m=-1,t=p.length}f=null,g=!1,r(e)}}function l(e,t){this.fun=e,this.array=t}function u(){}var c,d,h=e.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(e){c=n}try{d="function"==typeof clearTimeout?clearTimeout:o}catch(e){d=o}}();var f,p=[],g=!1,m=-1;h.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];p.push(new l(e,t)),1!==p.length||g||i(a)},l.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=u,h.addListener=u,h.once=u,h.off=u,h.removeListener=u,h.removeAllListeners=u,h.emit=u,h.prependListener=u,h.prependOnceListener=u,h.listeners=function(e){return[]},h.binding=function(e){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(e){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}}]);